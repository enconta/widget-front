{"ast":null,"code":"import _classCallCheck from \"/Users/usuario-rtd/Desktop/widget-front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/usuario-rtd/Desktop/widget-front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/usuario-rtd/Desktop/widget-front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/usuario-rtd/Desktop/widget-front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/usuario-rtd/Desktop/widget-front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/Users/usuario-rtd/Desktop/widget-front/src/components/app/views/dashboard/bankStatements/index.js\";\n// Required libraries\nimport React, { Component } from 'react';\nimport { browserHistory } from 'react-router';\nimport moment from 'moment';\nimport AppSignal from 'appsignal'; // Custom components\n\nimport AppStorage from 'api/appStorage';\nimport Modal from 'shared/modal';\nimport API from 'api';\nvar WARNINGS_ASSETS = '/img/';\nvar LATE_REMINDER_WARNING_DAYS = 5;\nvar LATE_REMINDER_ALERT_DAYS = 11;\nvar CURRENT_DAY_OF_MONTH = Number(moment().format('D'));\nvar NOTICES = [{\n  title: '¡Envíanos tu resumen de movimientos!',\n  text: \"Recuerda que, para que trabajemos tu contabilidad en tiempo y forma, \\n      debes subir tu resumen de movimientos correspondiente al mes en curso dentro \\n      de los primeros 5 d\\xEDas de cada mes.\",\n  img: 'meter_status_ok.png',\n  status: 'ok'\n}, {\n  title: '¡Te estás atrasando!',\n  text: \"Recuerda que tu resumen de movimientos es clave para que en Enconta podamos \\n      trabajar en tu contabilidad. Env\\xEDalo lo m\\xE1s pronto posible y evita atrasos.\",\n  img: 'meter_status_attention.png',\n  status: 'attention'\n}, {\n  title: '¡Envíanos tu resumen de movimientos!',\n  text: \"Seguimos sin recibir tu resumen de movimientos. Recuerda que al mandar la informaci\\xF3n \\n    los primeros 5 d\\xEDas del mes contar\\xE1s con tu declaraci\\xF3n en tiempo y forma. \\n    As\\xED podr\\xE1s continuar teniendo un buen historial ante el SAT y evitar multas.\",\n  img: 'meter_status_danger.png',\n  status: 'danger'\n}]; // Return true if some notification includes the words resumen and movimientos\n\nvar showNotice = function showNotice(notifications) {\n  return !!notifications.filter(function (notification) {\n    return notification.message.toLowerCase().includes('resumen de movimientos');\n  }).length;\n};\n\nvar BankStatements =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(BankStatements, _Component);\n\n  function BankStatements() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, BankStatements);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(BankStatements)).call.apply(_getPrototypeOf2, [this].concat(args)));\n    _this.state = {\n      showNotice: false,\n      accountingPeriods: []\n    };\n\n    _this.getNotifications = function () {\n      var notifications = AppStorage.getNotifications() || [];\n      var noticeLevel = 0;\n\n      if (showNotice(notifications)) {\n        if (CURRENT_DAY_OF_MONTH > LATE_REMINDER_WARNING_DAYS) noticeLevel++;\n        if (CURRENT_DAY_OF_MONTH > LATE_REMINDER_ALERT_DAYS) noticeLevel++;\n        return {\n          noticeLevel: noticeLevel,\n          showNotice: true\n        };\n      }\n\n      return {\n        noticeLevel: noticeLevel,\n        showNotice: false\n      };\n    };\n\n    return _this;\n  }\n\n  _createClass(BankStatements, [{\n    key: \"componentDidMount\",\n    // Get list from api\n    value: function componentDidMount() {\n      this.getAccountingPeriodsList();\n    } // Decide if render notice and at which level\n\n  }, {\n    key: \"toggleModal\",\n    // Handle modal open/close\n    value: function toggleModal() {\n      this.setState({\n        showNotice: !this.state.showNotice\n      });\n    } // get list of account periods\n\n  }, {\n    key: \"getAccountingPeriodsList\",\n    value: function getAccountingPeriodsList() {\n      var _this2 = this;\n\n      API.AccountingPeriods.List().then(function (_ref) {\n        var accountingPeriods = _ref.accounting_periods,\n            pagination = _ref.pagination;\n\n        _this2.setState({\n          accountingPeriods: accountingPeriods,\n          pagination: pagination\n        });\n      }).catch(function (error) {\n        AppSignal.sendError(error);\n      });\n    } // Go to new document page\n\n  }, {\n    key: \"onSubmit\",\n    value: function onSubmit() {\n      var accountingPeriods = this.state.accountingPeriods;\n      browserHistory.push(\"/mi-contabilidad/\".concat(Number(accountingPeriods[0].id), \"/ver\"));\n    } // Render single notice\n\n  }, {\n    key: \"renderNotice\",\n    value: function renderNotice(level) {\n      var _NOTICES$level = NOTICES[level],\n          img = _NOTICES$level.img,\n          title = _NOTICES$level.title,\n          status = _NOTICES$level.status,\n          text = _NOTICES$level.text;\n      return React.createElement(\"div\", {\n        className: \"bankStatementMeter\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 102\n        },\n        __self: this\n      }, React.createElement(\"img\", {\n        src: \"\".concat(WARNINGS_ASSETS).concat(img),\n        alt: text,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 103\n        },\n        __self: this\n      }), React.createElement(\"p\", {\n        className: \"title \".concat(status),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 104\n        },\n        __self: this\n      }, title), React.createElement(\"p\", {\n        className: \"text\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 105\n        },\n        __self: this\n      }, text));\n    } // Main render\n\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this$getNotification = this.getNotifications(),\n          noticeLevel = _this$getNotification.noticeLevel,\n          showNotice = _this$getNotification.showNotice;\n\n      return React.createElement(Modal, {\n        isActive: showNotice && !this.state.showNotice,\n        toggleModal: this.toggleModal.bind(this),\n        onSubmit: this.onSubmit.bind(this),\n        title: \"Sube tu resumen de movimientos\",\n        primaryButton: \"Subir Archivos\",\n        primaryIcon: \"upload\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 114\n        },\n        __self: this\n      }, this.renderNotice(noticeLevel));\n    }\n  }]);\n\n  return BankStatements;\n}(Component);\n\nexport default BankStatements;","map":{"version":3,"sources":["/Users/usuario-rtd/Desktop/widget-front/src/components/app/views/dashboard/bankStatements/index.js"],"names":["React","Component","browserHistory","moment","AppSignal","AppStorage","Modal","API","WARNINGS_ASSETS","LATE_REMINDER_WARNING_DAYS","LATE_REMINDER_ALERT_DAYS","CURRENT_DAY_OF_MONTH","Number","format","NOTICES","title","text","img","status","showNotice","notifications","filter","notification","message","toLowerCase","includes","length","BankStatements","state","accountingPeriods","getNotifications","noticeLevel","getAccountingPeriodsList","setState","AccountingPeriods","List","then","accounting_periods","pagination","catch","error","sendError","push","id","level","toggleModal","bind","onSubmit","renderNotice"],"mappings":"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","sourcesContent":["// Required libraries\nimport React, { Component } from 'react'\nimport { browserHistory } from 'react-router'\nimport moment from 'moment'\nimport AppSignal from 'appsignal'\n\n// Custom components\nimport AppStorage from 'api/appStorage'\nimport Modal from 'shared/modal'\nimport API from 'api'\n\nconst WARNINGS_ASSETS = '/img/'\nconst LATE_REMINDER_WARNING_DAYS = 5\nconst LATE_REMINDER_ALERT_DAYS = 11\nconst CURRENT_DAY_OF_MONTH = Number(moment().format('D'))\n\nconst NOTICES = [\n  {\n    title: '¡Envíanos tu resumen de movimientos!',\n    text: `Recuerda que, para que trabajemos tu contabilidad en tiempo y forma, \n      debes subir tu resumen de movimientos correspondiente al mes en curso dentro \n      de los primeros 5 días de cada mes.`,\n    img: 'meter_status_ok.png',\n    status: 'ok'\n  },\n  {\n    title: '¡Te estás atrasando!',\n    text: `Recuerda que tu resumen de movimientos es clave para que en Enconta podamos \n      trabajar en tu contabilidad. Envíalo lo más pronto posible y evita atrasos.`,\n    img: 'meter_status_attention.png',\n    status: 'attention'\n  },\n  {\n    title: '¡Envíanos tu resumen de movimientos!',\n    text: `Seguimos sin recibir tu resumen de movimientos. Recuerda que al mandar la información \n    los primeros 5 días del mes contarás con tu declaración en tiempo y forma. \n    Así podrás continuar teniendo un buen historial ante el SAT y evitar multas.`,\n    img: 'meter_status_danger.png',\n    status: 'danger'\n  }\n]\n\n// Return true if some notification includes the words resumen and movimientos\nconst showNotice = notifications =>\n  !!notifications.filter(notification =>\n    notification.message.toLowerCase().includes('resumen de movimientos')\n  ).length\n\nclass BankStatements extends Component {\n  state = {\n    showNotice: false,\n    accountingPeriods: []\n  }\n\n  // Get list from api\n  componentDidMount () {\n    this.getAccountingPeriodsList()\n  }\n  // Decide if render notice and at which level\n  getNotifications = () => {\n    const notifications = AppStorage.getNotifications() || []\n\n    let noticeLevel = 0\n\n    if (showNotice(notifications)) {\n      if (CURRENT_DAY_OF_MONTH > LATE_REMINDER_WARNING_DAYS) noticeLevel++\n      if (CURRENT_DAY_OF_MONTH > LATE_REMINDER_ALERT_DAYS) noticeLevel++\n      return { noticeLevel, showNotice: true }\n    }\n\n    return { noticeLevel, showNotice: false }\n  }\n\n  // Handle modal open/close\n  toggleModal () {\n    this.setState({ showNotice: !this.state.showNotice })\n  }\n\n  // get list of account periods\n  getAccountingPeriodsList () {\n    API.AccountingPeriods.List()\n      .then(({ accounting_periods: accountingPeriods, pagination }) => {\n        this.setState({ accountingPeriods, pagination })\n      })\n      .catch(error => {\n        AppSignal.sendError(error)\n      })\n  }\n\n  // Go to new document page\n  onSubmit () {\n    const { accountingPeriods } = this.state\n    browserHistory.push(\n      `/mi-contabilidad/${Number(accountingPeriods[0].id)}/ver`\n    )\n  }\n\n  // Render single notice\n  renderNotice (level) {\n    const { img, title, status, text } = NOTICES[level]\n    return (\n      <div className='bankStatementMeter'>\n        <img src={`${WARNINGS_ASSETS}${img}`} alt={text} />\n        <p className={`title ${status}`}>{title}</p>\n        <p className='text'>{text}</p>\n      </div>\n    )\n  }\n\n  // Main render\n  render () {\n    const { noticeLevel, showNotice } = this.getNotifications()\n    return (\n      <Modal\n        isActive={showNotice && !this.state.showNotice}\n        toggleModal={this.toggleModal.bind(this)}\n        onSubmit={this.onSubmit.bind(this)}\n        title='Sube tu resumen de movimientos'\n        primaryButton='Subir Archivos'\n        primaryIcon='upload'\n      >\n        {this.renderNotice(noticeLevel)}\n      </Modal>\n    )\n  }\n}\n\nexport default BankStatements\n"]},"metadata":{},"sourceType":"module"}