{"ast":null,"code":"import _toConsumableArray from \"/Users/usuario-rtd/Desktop/widget-front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _classCallCheck from \"/Users/usuario-rtd/Desktop/widget-front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/usuario-rtd/Desktop/widget-front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/usuario-rtd/Desktop/widget-front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/usuario-rtd/Desktop/widget-front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/usuario-rtd/Desktop/widget-front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _assertThisInitialized from \"/Users/usuario-rtd/Desktop/widget-front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";\nvar _jsxFileName = \"/Users/usuario-rtd/Desktop/widget-front/src/components/app/views/reports/rubros/chart/index.js\";\n// Libraries\nimport React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport { select, arc, pie, scaleOrdinal } from 'd3'; // Keys\n\nvar AMOUNT_KEY = 'amount';\nvar pieProperties = {\n  innerRadius: 2,\n  outerPadding: 0,\n  labelOuterPadding: 60,\n  spaceBetweenSlices: 0.01,\n  sort: null,\n  textColor: 'white',\n  textAnchor: 'middle',\n  baseline: 'middle',\n  fontSize: '1rem',\n  fontFamily: 'Rubik',\n  pointerEvents: 'none',\n  cursor: 'default',\n  webkitUserSelect: 'none',\n  mozUserSelect: 'none',\n  msUserSelect: 'none',\n  userSelect: 'none'\n};\n\nvar Chart =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(Chart, _Component);\n\n  function Chart(props) {\n    var _this;\n\n    _classCallCheck(this, Chart);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(Chart).call(this, props));\n    _this.data = {};\n    _this.state = Object.assign({}, _this.data);\n    _this.renderChart = _this.renderChart.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    return _this;\n  } // Render chart on component mount\n\n\n  _createClass(Chart, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this.renderChart();\n    } // Re-render chart when component get updates\n\n  }, {\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate() {\n      this.renderChart();\n    } // Get container width\n\n  }, {\n    key: \"getParentWidth\",\n    value: function getParentWidth() {\n      var chartSize = 300;\n      var node2 = typeof this.node === 'undefined' ? null : this.node;\n      if (node2 !== null) chartSize = node2.parentNode.clientWidth;\n      return chartSize;\n    } // Handle chart rendering\n\n  }, {\n    key: \"renderChart\",\n    value: function renderChart() {\n      var chartSize = this.getParentWidth(); // General chart data\n\n      var _this$props = this.props,\n          items = _this$props.items,\n          colors = _this$props.colors;\n      var node = this.node;\n      var radius = Math.min(chartSize, chartSize) / 2;\n      var parsedItems = [].concat(_toConsumableArray(this.props.itemsAboveThreshold(items)), [this.props.itemsBelowThresholdSummarized(items)]).filter(function (i) {\n        return i[AMOUNT_KEY] !== 0;\n      }); // Clean SVG before rendering a new one\n\n      var cleanSvg = select(node) // eslint-disable-line\n      .selectAll('*').remove(); // Color palette\n\n      var color = scaleOrdinal().range(colors);\n      var pieArcs = arc().outerRadius(radius - pieProperties.outerPadding).innerRadius(pieProperties.innerRadius).padAngle(pieProperties.spaceBetweenSlices);\n      var labelArc = arc().outerRadius(radius - pieProperties.labelOuterPadding).innerRadius(radius - pieProperties.labelOuterPadding);\n      var drawPie = pie().sort(pieProperties.sort).value(function (d) {\n        return d[AMOUNT_KEY];\n      });\n      var svg = select(node).append('g').attr('transform', \"translate(\".concat(chartSize / 2, \",\").concat(chartSize / 2, \")\"));\n      var g = svg.selectAll('.arc').data(drawPie(parsedItems)).enter().append('g').attr('class', 'arc');\n      g.append('path').attr('d', pieArcs).style('fill', function (d, i) {\n        return color(i);\n      });\n      g.append('text').attr('transform', function (d) {\n        return \"translate(\".concat(labelArc.centroid(d), \")\");\n      }).style('fill', pieProperties.textColor).style('text-anchor', pieProperties.textAnchor).style('alignment-baseline', pieProperties.baseline).style('font-size', pieProperties.fontSize).style('font-family', pieProperties.fontFamily).style('font-family', pieProperties.fontFamily).style('pointer-events', pieProperties.pointerEvents).style('cursor', pieProperties.cursor).style('-webkit-user-select', pieProperties.webkitUserSelect).style('-moz-user-select', pieProperties.mozUserSelect).style('-ms-user-select', pieProperties.msUserSelect).style('user-select', pieProperties.userSelect).text(function (d) {\n        return \"\".concat(d.data.percentage.toFixed(2), \" %\");\n      });\n    } // Main render\n\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var chartSize = this.getParentWidth();\n      return React.createElement(\"svg\", {\n        ref: function ref(node) {\n          return _this2.node = node;\n        } // eslint-disable-line\n        ,\n        viewBox: \"0 0 \".concat(chartSize, \" \").concat(chartSize),\n        width: chartSize,\n        height: chartSize,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 126\n        },\n        __self: this\n      });\n    }\n  }]);\n\n  return Chart;\n}(Component);\n\nChart.propTypes = {\n  items: PropTypes.array,\n  colors: PropTypes.array,\n  itemsAboveThreshold: PropTypes.func,\n  itemsBelowThresholdSummarized: PropTypes.func\n};\nexport default Chart;","map":{"version":3,"sources":["/Users/usuario-rtd/Desktop/widget-front/src/components/app/views/reports/rubros/chart/index.js"],"names":["React","Component","PropTypes","select","arc","pie","scaleOrdinal","AMOUNT_KEY","pieProperties","innerRadius","outerPadding","labelOuterPadding","spaceBetweenSlices","sort","textColor","textAnchor","baseline","fontSize","fontFamily","pointerEvents","cursor","webkitUserSelect","mozUserSelect","msUserSelect","userSelect","Chart","props","data","state","Object","assign","renderChart","bind","chartSize","node2","node","parentNode","clientWidth","getParentWidth","items","colors","radius","Math","min","parsedItems","itemsAboveThreshold","itemsBelowThresholdSummarized","filter","i","cleanSvg","selectAll","remove","color","range","pieArcs","outerRadius","padAngle","labelArc","drawPie","value","d","svg","append","attr","g","enter","style","centroid","text","percentage","toFixed","propTypes","array","func"],"mappings":"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","sourcesContent":["// Libraries\nimport React, { Component } from 'react'\nimport PropTypes from 'prop-types'\nimport { select, arc, pie, scaleOrdinal } from 'd3'\n\n// Keys\nconst AMOUNT_KEY = 'amount'\n\nconst pieProperties = {\n  innerRadius: 2,\n  outerPadding: 0,\n  labelOuterPadding: 60,\n  spaceBetweenSlices: 0.01,\n  sort: null,\n  textColor: 'white',\n  textAnchor: 'middle',\n  baseline: 'middle',\n  fontSize: '1rem',\n  fontFamily: 'Rubik',\n  pointerEvents: 'none',\n  cursor: 'default',\n  webkitUserSelect: 'none',\n  mozUserSelect: 'none',\n  msUserSelect: 'none',\n  userSelect: 'none'\n}\n\nclass Chart extends Component {\n  constructor (props) {\n    super(props)\n    this.data = {}\n    this.state = Object.assign({}, this.data)\n    this.renderChart = this.renderChart.bind(this)\n  }\n\n  // Render chart on component mount\n  componentDidMount () {\n    this.renderChart()\n  }\n\n  // Re-render chart when component get updates\n  componentDidUpdate () {\n    this.renderChart()\n  }\n\n  // Get container width\n  getParentWidth () {\n    let chartSize = 300\n    let node2 = typeof this.node === 'undefined' ? null : this.node\n    if (node2 !== null) chartSize = node2.parentNode.clientWidth\n    return chartSize\n  }\n\n  // Handle chart rendering\n  renderChart () {\n    let chartSize = this.getParentWidth()\n\n    // General chart data\n    const { items, colors } = this.props\n    const node = this.node\n    const radius = Math.min(chartSize, chartSize) / 2\n    const parsedItems = [\n      ...this.props.itemsAboveThreshold(items),\n      this.props.itemsBelowThresholdSummarized(items)\n    ].filter(i => i[AMOUNT_KEY] !== 0)\n\n    // Clean SVG before rendering a new one\n    let cleanSvg = select(node) // eslint-disable-line\n      .selectAll('*')\n      .remove()\n\n    // Color palette\n    let color = scaleOrdinal().range(colors)\n\n    let pieArcs = arc()\n      .outerRadius(radius - pieProperties.outerPadding)\n      .innerRadius(pieProperties.innerRadius)\n      .padAngle(pieProperties.spaceBetweenSlices)\n\n    let labelArc = arc()\n      .outerRadius(radius - pieProperties.labelOuterPadding)\n      .innerRadius(radius - pieProperties.labelOuterPadding)\n\n    let drawPie = pie()\n      .sort(pieProperties.sort)\n      .value(d => d[AMOUNT_KEY])\n\n    let svg = select(node)\n      .append('g')\n      .attr('transform', `translate(${chartSize / 2},${chartSize / 2})`)\n\n    let g = svg\n      .selectAll('.arc')\n      .data(drawPie(parsedItems))\n      .enter()\n      .append('g')\n      .attr('class', 'arc')\n\n    g\n      .append('path')\n      .attr('d', pieArcs)\n      .style('fill', (d, i) => color(i))\n\n    g\n      .append('text')\n      .attr('transform', d => `translate(${labelArc.centroid(d)})`)\n      .style('fill', pieProperties.textColor)\n      .style('text-anchor', pieProperties.textAnchor)\n      .style('alignment-baseline', pieProperties.baseline)\n      .style('font-size', pieProperties.fontSize)\n      .style('font-family', pieProperties.fontFamily)\n      .style('font-family', pieProperties.fontFamily)\n      .style('pointer-events', pieProperties.pointerEvents)\n      .style('cursor', pieProperties.cursor)\n      .style('-webkit-user-select', pieProperties.webkitUserSelect)\n      .style('-moz-user-select', pieProperties.mozUserSelect)\n      .style('-ms-user-select', pieProperties.msUserSelect)\n      .style('user-select', pieProperties.userSelect)\n      .text(d => `${d.data.percentage.toFixed(2)} %`)\n  }\n\n  // Main render\n  render () {\n    let chartSize = this.getParentWidth()\n    return (\n      <svg\n        ref={node => (this.node = node)} // eslint-disable-line\n        viewBox={`0 0 ${chartSize} ${chartSize}`}\n        width={chartSize}\n        height={chartSize}\n      />\n    )\n  }\n}\n\nChart.propTypes = {\n  items: PropTypes.array,\n  colors: PropTypes.array,\n  itemsAboveThreshold: PropTypes.func,\n  itemsBelowThresholdSummarized: PropTypes.func\n}\n\nexport default Chart\n"]},"metadata":{},"sourceType":"module"}