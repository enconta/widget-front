{"ast":null,"code":"import _regeneratorRuntime from \"/Users/usuario-rtd/Desktop/widget-front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/usuario-rtd/Desktop/widget-front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _objectSpread from \"/Users/usuario-rtd/Desktop/widget-front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread\";\nimport _classCallCheck from \"/Users/usuario-rtd/Desktop/widget-front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/usuario-rtd/Desktop/widget-front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/usuario-rtd/Desktop/widget-front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/usuario-rtd/Desktop/widget-front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/usuario-rtd/Desktop/widget-front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _assertThisInitialized from \"/Users/usuario-rtd/Desktop/widget-front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";\nvar _jsxFileName = \"/Users/usuario-rtd/Desktop/widget-front/src/components/diagnostic/fiscalDiagnostic.js\";\nimport React, { Component, Fragment } from 'react';\nimport DocumentTitle from 'react-document-title';\nimport NotificationsContainer from 'shared/notifications';\nimport Button from 'shared/button';\nimport { handleInputs, toggleShowHidePassword, formatFile, handleURL } from 'utils';\nimport Logo from 'shared/logo';\nimport SelectField from 'shared/selectField';\nimport { FISCAL_DIAGNOSTIC } from 'shared/catalogs';\nimport DropZoneFile from 'shared/credentials/components/DropzoneFile';\nimport TextField from 'shared/textField';\nimport { handleSelectField, uploadFiel, uploadCiec } from './utils';\nimport MenuOptions from './utils/menuOptions';\nimport SessionStore from 'stores/session';\nimport NotificationsActions from 'actions/notifications';\nimport SatCredentialsActions from 'actions/satCredentials';\nimport RegisterActions from 'actions/register';\nvar requiredFields = new Set();\nvar user = 'Usuario';\nvar password = 'Contraseña';\n\nvar getCurrentState = function getCurrentState() {\n  return {\n    user: SessionStore.getCurrentEntity()\n  };\n};\n\nvar FiscalDiagnostic =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(FiscalDiagnostic, _Component);\n\n  function FiscalDiagnostic() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, FiscalDiagnostic);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(FiscalDiagnostic)).call.apply(_getPrototypeOf2, [this].concat(args)));\n    _this.state = _objectSpread({\n      credentials: '',\n      fielPassword: '',\n      ciecPassword: '',\n      hidden: true,\n      fiel: {\n        attachedKeyFile: '',\n        originalKeyFilename: '',\n        contentKeyType: '',\n        attachedCerFile: '',\n        originalCerFilename: '',\n        contentCerType: ''\n      },\n      requestInProgress: false\n    }, getCurrentState());\n\n    _this.componentWillUnmount = function () {\n      SessionStore.removeChangeListener(_this._onChange);\n    };\n\n    _this._onChange = function () {\n      _this.setState(getCurrentState());\n    };\n\n    _this.setFielCer =\n    /*#__PURE__*/\n    function () {\n      var _ref = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee(fileUpload) {\n        var _ref2, file64, name, contentType;\n\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.prev = 0;\n                _context.next = 3;\n                return formatFile(fileUpload);\n\n              case 3:\n                _ref2 = _context.sent;\n                file64 = _ref2.file64;\n                name = _ref2.name;\n                contentType = _ref2.contentType;\n\n                _this.setState({\n                  fiel: _objectSpread({}, _this.state.fiel, {\n                    attachedCerFile: file64,\n                    originalCerFilename: name,\n                    contentCerType: contentType\n                  })\n                });\n\n                _context.next = 13;\n                break;\n\n              case 10:\n                _context.prev = 10;\n                _context.t0 = _context[\"catch\"](0);\n                NotificationsActions.error(_context.t0);\n\n              case 13:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, null, [[0, 10]]);\n      }));\n\n      return function (_x) {\n        return _ref.apply(this, arguments);\n      };\n    }();\n\n    _this.setFielKey =\n    /*#__PURE__*/\n    function () {\n      var _ref3 = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee2(fileUpload) {\n        var _ref4, file64, name, contentType;\n\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                _context2.prev = 0;\n                _context2.next = 3;\n                return formatFile(fileUpload);\n\n              case 3:\n                _ref4 = _context2.sent;\n                file64 = _ref4.file64;\n                name = _ref4.name;\n                contentType = _ref4.contentType;\n\n                _this.setState({\n                  fiel: _objectSpread({}, _this.state.fiel, {\n                    attachedKeyFile: file64,\n                    originalKeyFilename: name,\n                    contentKeyType: contentType\n                  })\n                });\n\n                _context2.next = 13;\n                break;\n\n              case 10:\n                _context2.prev = 10;\n                _context2.t0 = _context2[\"catch\"](0);\n                NotificationsActions.error(_context2.t0);\n\n              case 13:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, null, [[0, 10]]);\n      }));\n\n      return function (_x2) {\n        return _ref3.apply(this, arguments);\n      };\n    }();\n\n    _this.credentialsSuccessfulMessage = function (credentials) {\n      NotificationsActions.success(\"\".concat(credentials.toUpperCase(), \" guardada correctamente\"));\n\n      _this.setState({\n        requestInProgress: false\n      });\n\n      handleURL('/diagnostico/en-proceso');\n    };\n\n    _this.uploadCredentials = function (e) {\n      e.preventDefault();\n      var _this$state = _this.state,\n          credentials = _this$state.credentials,\n          user = _this$state.user;\n\n      if (credentials === 'fiel') {\n        SatCredentialsActions.updateSatCredentials(uploadFiel(_this.state)).then(function () {\n          _this.credentialsSuccessfulMessage(credentials);\n\n          RegisterActions.updateSteps(user.user_id);\n        }).catch(function (error) {\n          NotificationsActions.error(error);\n        });\n      } else {\n        SatCredentialsActions.updateSatCredentials(uploadCiec(_this.state)).then(function () {\n          _this.credentialsSuccessfulMessage(credentials);\n\n          RegisterActions.updateSteps(user.user_id);\n        }).catch(function (error) {\n          NotificationsActions.error(error);\n        });\n      }\n    };\n\n    _this.renderFiel = function () {\n      var _this$state2 = _this.state,\n          fielPassword = _this$state2.fielPassword,\n          hidden = _this$state2.hidden,\n          fiel = _this$state2.fiel;\n      return React.createElement(Fragment, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 134\n        },\n        __self: this\n      }, React.createElement(\"p\", {\n        className: \"register__form-text\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 135\n        },\n        __self: this\n      }, \"Sube los archivos de tu FIEL\"), React.createElement(\"div\", {\n        className: \"register__form-container\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 136\n        },\n        __self: this\n      }, React.createElement(DropZoneFile, {\n        accept: \".cer\",\n        addFileMessage: \"Arrastra tu .cer aqu\\xED o da clic para adjuntarlo\",\n        className: \"dropzone-no-margin\",\n        onDrop: _this.setFielCer,\n        file: fiel.originalCerFilename,\n        icon: \"mdi-cloud-check\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 137\n        },\n        __self: this\n      }), React.createElement(DropZoneFile, {\n        accept: \".key\",\n        addFileMessage: \"Arrastra tu .key aqu\\xED o da clic para adjuntarlo\",\n        className: \"dropzone-no-margin\",\n        onDrop: _this.setFielKey,\n        file: fiel.originalKeyFilename,\n        icon: \"mdi-cloud-check\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 145\n        },\n        __self: this\n      })), React.createElement(\"p\", {\n        className: \"register__form-fiscal register__form-text\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 154\n        },\n        __self: this\n      }, \"Ingresa la contrase\\xF1a de tu FIEL\"), React.createElement(TextField, {\n        placeholder: password,\n        floatLabel: password,\n        value: fielPassword,\n        onChange: handleInputs(_assertThisInitialized(_assertThisInitialized(_this)), 'fielPassword'),\n        type: hidden ? 'password' : 'text',\n        hideAndShowPassword: true,\n        onChangeType: function onChangeType() {\n          return toggleShowHidePassword(_assertThisInitialized(_assertThisInitialized(_this)), 'hidden');\n        },\n        ref: function ref(r) {\n          return requiredFields.add(r);\n        },\n        required: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 158\n        },\n        __self: this\n      }));\n    };\n\n    return _this;\n  }\n\n  _createClass(FiscalDiagnostic, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      SessionStore.addChangeListener(this._onChange);\n    }\n  }, {\n    key: \"renderCiec\",\n    value: function renderCiec() {\n      var _this2 = this;\n\n      var _this$state3 = this.state,\n          ciecPassword = _this$state3.ciecPassword,\n          hidden = _this$state3.hidden;\n      var rfc = this.props.params.rfc;\n      return React.createElement(Fragment, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 177\n        },\n        __self: this\n      }, React.createElement(\"p\", {\n        className: \"register__form-text\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 178\n        },\n        __self: this\n      }, \"Configura tu ciec\"), React.createElement(\"div\", {\n        className: \"register__form-container register__form-container-one-column\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 179\n        },\n        __self: this\n      }, React.createElement(TextField, {\n        placeholder: user,\n        floatLabel: user,\n        value: rfc,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 180\n        },\n        __self: this\n      }), React.createElement(TextField, {\n        placeholder: password,\n        floatLabel: password,\n        value: ciecPassword,\n        onChange: handleInputs(this, 'ciecPassword'),\n        type: hidden ? 'password' : 'text',\n        hideAndShowPassword: true,\n        onChangeType: function onChangeType() {\n          return toggleShowHidePassword(_this2, 'hidden');\n        },\n        ref: function ref(r) {\n          return requiredFields.add(r);\n        },\n        required: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 182\n        },\n        __self: this\n      })));\n    }\n  }, {\n    key: \"renderForm\",\n    value: function renderForm() {\n      var _this$state4 = this.state,\n          credentials = _this$state4.credentials,\n          fiel = _this$state4.fiel,\n          fielPassword = _this$state4.fielPassword,\n          ciecPassword = _this$state4.ciecPassword,\n          user = _this$state4.user;\n      var disabledButton = fiel.attachedCerFile.length > 0 && fiel.attachedKeyFile.length > 0 && fielPassword || ciecPassword;\n      return React.createElement(Fragment, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 208\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"register--left-side\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 209\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"register--left-side-container\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 210\n        },\n        __self: this\n      }, React.createElement(Logo, {\n        logoSize: \"normal\",\n        textColour: \"white\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 211\n        },\n        __self: this\n      }), React.createElement(\"p\", {\n        className: \"register--left-side__title\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 212\n        },\n        __self: this\n      }, React.createElement(\"i\", {\n        className: \"mdi mdi-greater-than register--left-side-icon\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 213\n        },\n        __self: this\n      }), \"Configuraci\\xF3n FIEL o CIEC\"), React.createElement(\"p\", {\n        className: \"register--left-side__subtitle\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 216\n        },\n        __self: this\n      }, \"Sube tu FIEL o el usuario de tu CIEC\"), React.createElement(\"p\", {\n        className: \"register--left-side__main-option\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 219\n        },\n        __self: this\n      }, \"Diagn\\xF3stico\"))), React.createElement(\"div\", {\n        className: \"register--full-height\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 223\n        },\n        __self: this\n      }, React.createElement(MenuOptions, {\n        email: user.email,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 224\n        },\n        __self: this\n      }), React.createElement(\"form\", {\n        className: \"register__form register__form-fiscal-diagnostic\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 225\n        },\n        __self: this\n      }, React.createElement(\"p\", {\n        className: \"register__form-title\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 226\n        },\n        __self: this\n      }, \"Diagn\\xF3stico\", ' ', React.createElement(\"span\", {\n        className: \"register__form-title--highlight\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 228\n        },\n        __self: this\n      }, \"fiscal\")), React.createElement(\"p\", {\n        className: \"register__form-text\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 231\n        },\n        __self: this\n      }, \"Para poder realizar un an\\xE1lisis de tu situaci\\xF3n fiscal es necesario que ingreses tu\", ' ', React.createElement(\"span\", {\n        className: \"register__form-text--highlight\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 234\n        },\n        __self: this\n      }, \"FIEL\"), \" \\xF3\", ' ', React.createElement(\"span\", {\n        className: \"register__form-text--highlight\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 235\n        },\n        __self: this\n      }, \"CIEC\")), React.createElement(\"div\", {\n        className: \"register__form-fiscal\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 238\n        },\n        __self: this\n      }, React.createElement(SelectField, {\n        placeholder: \"Selecciona que deseas configurar\",\n        floatLabel: true,\n        options: FISCAL_DIAGNOSTIC,\n        value: credentials,\n        onChange: handleSelectField(this),\n        ref: function ref(r) {\n          return requiredFields.add(r);\n        },\n        required: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 239\n        },\n        __self: this\n      })), credentials === 'fiel' ? this.renderFiel() : credentials === 'ciec' && this.renderCiec(), React.createElement(\"div\", {\n        className: \"register__form-container register__form-container-button\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 254\n        },\n        __self: this\n      }, React.createElement(Button, {\n        buttonStyle: \"border-white\",\n        className: \"register__form-button\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 255\n        },\n        __self: this\n      }, \"\\xBFNo los tienes?\"), React.createElement(Button, {\n        buttonStyle: \"round\",\n        type: \"submit\",\n        className: \"register__form-button\",\n        disabled: !disabledButton,\n        onClick: this.uploadCredentials,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 262\n        },\n        __self: this\n      }, \"Siguiente\")))));\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      return React.createElement(DocumentTitle, {\n        title: 'Diagnóstico - Enconta',\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 280\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"register\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 281\n        },\n        __self: this\n      }, this.renderForm(), React.createElement(\"div\", {\n        className: \"notification-container notification-centered\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 283\n        },\n        __self: this\n      }, React.createElement(NotificationsContainer, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 284\n        },\n        __self: this\n      }))));\n    }\n  }]);\n\n  return FiscalDiagnostic;\n}(Component);\n\nexport default FiscalDiagnostic;","map":{"version":3,"sources":["/Users/usuario-rtd/Desktop/widget-front/src/components/diagnostic/fiscalDiagnostic.js"],"names":["React","Component","Fragment","DocumentTitle","NotificationsContainer","Button","handleInputs","toggleShowHidePassword","formatFile","handleURL","Logo","SelectField","FISCAL_DIAGNOSTIC","DropZoneFile","TextField","handleSelectField","uploadFiel","uploadCiec","MenuOptions","SessionStore","NotificationsActions","SatCredentialsActions","RegisterActions","requiredFields","Set","user","password","getCurrentState","getCurrentEntity","FiscalDiagnostic","state","credentials","fielPassword","ciecPassword","hidden","fiel","attachedKeyFile","originalKeyFilename","contentKeyType","attachedCerFile","originalCerFilename","contentCerType","requestInProgress","componentWillUnmount","removeChangeListener","_onChange","setState","setFielCer","fileUpload","file64","name","contentType","error","setFielKey","credentialsSuccessfulMessage","success","toUpperCase","uploadCredentials","e","preventDefault","updateSatCredentials","then","updateSteps","user_id","catch","renderFiel","r","add","addChangeListener","rfc","props","params","disabledButton","length","email","renderCiec","renderForm"],"mappings":"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","sourcesContent":["import React, { Component, Fragment } from 'react'\nimport DocumentTitle from 'react-document-title'\n\nimport NotificationsContainer from 'shared/notifications'\nimport Button from 'shared/button'\nimport {\n  handleInputs,\n  toggleShowHidePassword,\n  formatFile,\n  handleURL\n} from 'utils'\nimport Logo from 'shared/logo'\nimport SelectField from 'shared/selectField'\nimport { FISCAL_DIAGNOSTIC } from 'shared/catalogs'\nimport DropZoneFile from 'shared/credentials/components/DropzoneFile'\nimport TextField from 'shared/textField'\nimport { handleSelectField, uploadFiel, uploadCiec } from './utils'\nimport MenuOptions from './utils/menuOptions'\n\nimport SessionStore from 'stores/session'\n\nimport NotificationsActions from 'actions/notifications'\nimport SatCredentialsActions from 'actions/satCredentials'\nimport RegisterActions from 'actions/register'\n\nconst requiredFields = new Set()\nconst user = 'Usuario'\nconst password = 'Contraseña'\n\nconst getCurrentState = () => {\n  return {\n    user: SessionStore.getCurrentEntity()\n  }\n}\nclass FiscalDiagnostic extends Component {\n  state = {\n    credentials: '',\n    fielPassword: '',\n    ciecPassword: '',\n    hidden: true,\n    fiel: {\n      attachedKeyFile: '',\n      originalKeyFilename: '',\n      contentKeyType: '',\n      attachedCerFile: '',\n      originalCerFilename: '',\n      contentCerType: ''\n    },\n    requestInProgress: false,\n    ...getCurrentState()\n  }\n\n  componentDidMount () {\n    SessionStore.addChangeListener(this._onChange)\n  }\n\n  componentWillUnmount = () => {\n    SessionStore.removeChangeListener(this._onChange)\n  }\n\n  _onChange = () => {\n    this.setState(getCurrentState())\n  }\n\n  setFielCer = async fileUpload => {\n    try {\n      const { file64, name, contentType } = await formatFile(fileUpload)\n      this.setState({\n        fiel: {\n          ...this.state.fiel,\n          attachedCerFile: file64,\n          originalCerFilename: name,\n          contentCerType: contentType\n        }\n      })\n    } catch (error) {\n      NotificationsActions.error(error)\n    }\n  }\n\n  setFielKey = async fileUpload => {\n    try {\n      const { file64, name, contentType } = await formatFile(fileUpload)\n      this.setState({\n        fiel: {\n          ...this.state.fiel,\n          attachedKeyFile: file64,\n          originalKeyFilename: name,\n          contentKeyType: contentType\n        }\n      })\n    } catch (error) {\n      NotificationsActions.error(error)\n    }\n  }\n\n  credentialsSuccessfulMessage = credentials => {\n    NotificationsActions.success(\n      `${credentials.toUpperCase()} guardada correctamente`\n    )\n    this.setState({ requestInProgress: false })\n    handleURL('/diagnostico/en-proceso')\n  }\n\n  uploadCredentials = e => {\n    e.preventDefault()\n\n    const { credentials, user } = this.state\n\n    if (credentials === 'fiel') {\n      SatCredentialsActions.updateSatCredentials(uploadFiel(this.state))\n        .then(() => {\n          this.credentialsSuccessfulMessage(credentials)\n          RegisterActions.updateSteps(user.user_id)\n        })\n        .catch(error => {\n          NotificationsActions.error(error)\n        })\n    } else {\n      SatCredentialsActions.updateSatCredentials(uploadCiec(this.state))\n        .then(() => {\n          this.credentialsSuccessfulMessage(credentials)\n          RegisterActions.updateSteps(user.user_id)\n        })\n        .catch(error => {\n          NotificationsActions.error(error)\n        })\n    }\n  }\n\n  renderFiel = () => {\n    const { fielPassword, hidden, fiel } = this.state\n    return (\n      <Fragment>\n        <p className='register__form-text'>Sube los archivos de tu FIEL</p>\n        <div className='register__form-container'>\n          <DropZoneFile\n            accept='.cer'\n            addFileMessage='Arrastra tu .cer aquí o da clic para adjuntarlo'\n            className='dropzone-no-margin'\n            onDrop={this.setFielCer}\n            file={fiel.originalCerFilename}\n            icon='mdi-cloud-check'\n          />\n          <DropZoneFile\n            accept='.key'\n            addFileMessage='Arrastra tu .key aquí o da clic para adjuntarlo'\n            className='dropzone-no-margin'\n            onDrop={this.setFielKey}\n            file={fiel.originalKeyFilename}\n            icon='mdi-cloud-check'\n          />\n        </div>\n        <p className='register__form-fiscal register__form-text'>\n          Ingresa la contraseña de tu FIEL\n        </p>\n\n        <TextField\n          placeholder={password}\n          floatLabel={password}\n          value={fielPassword}\n          onChange={handleInputs(this, 'fielPassword')}\n          type={hidden ? 'password' : 'text'}\n          hideAndShowPassword\n          onChangeType={() => toggleShowHidePassword(this, 'hidden')}\n          ref={r => requiredFields.add(r)}\n          required\n        />\n      </Fragment>\n    )\n  }\n\n  renderCiec () {\n    const { ciecPassword, hidden } = this.state\n    const { rfc } = this.props.params\n    return (\n      <Fragment>\n        <p className='register__form-text'>Configura tu ciec</p>\n        <div className='register__form-container register__form-container-one-column'>\n          <TextField placeholder={user} floatLabel={user} value={rfc} />\n\n          <TextField\n            placeholder={password}\n            floatLabel={password}\n            value={ciecPassword}\n            onChange={handleInputs(this, 'ciecPassword')}\n            type={hidden ? 'password' : 'text'}\n            hideAndShowPassword\n            onChangeType={() => toggleShowHidePassword(this, 'hidden')}\n            ref={r => requiredFields.add(r)}\n            required\n          />\n        </div>\n      </Fragment>\n    )\n  }\n\n  renderForm () {\n    const { credentials, fiel, fielPassword, ciecPassword, user } = this.state\n\n    const disabledButton =\n      (fiel.attachedCerFile.length > 0 &&\n        fiel.attachedKeyFile.length > 0 &&\n        fielPassword) ||\n      ciecPassword\n\n    return (\n      <Fragment>\n        <div className='register--left-side'>\n          <div className='register--left-side-container'>\n            <Logo logoSize='normal' textColour='white' />\n            <p className='register--left-side__title'>\n              <i className='mdi mdi-greater-than register--left-side-icon' />\n              Configuración FIEL o CIEC\n            </p>\n            <p className='register--left-side__subtitle'>\n              Sube tu FIEL o el usuario de tu CIEC\n            </p>\n            <p className='register--left-side__main-option'>Diagnóstico</p>\n          </div>\n        </div>\n\n        <div className='register--full-height'>\n          <MenuOptions email={user.email} />\n          <form className='register__form register__form-fiscal-diagnostic'>\n            <p className='register__form-title'>\n              Diagnóstico{' '}\n              <span className='register__form-title--highlight'>fiscal</span>\n            </p>\n\n            <p className='register__form-text'>\n              Para poder realizar un análisis de tu situación fiscal es\n              necesario que ingreses tu{' '}\n              <span className='register__form-text--highlight'>FIEL</span> ó{' '}\n              <span className='register__form-text--highlight'>CIEC</span>\n            </p>\n\n            <div className='register__form-fiscal'>\n              <SelectField\n                placeholder='Selecciona que deseas configurar'\n                floatLabel\n                options={FISCAL_DIAGNOSTIC}\n                value={credentials}\n                onChange={handleSelectField(this)}\n                ref={r => requiredFields.add(r)}\n                required\n              />\n            </div>\n\n            {credentials === 'fiel'\n              ? this.renderFiel()\n              : credentials === 'ciec' && this.renderCiec()}\n\n            <div className='register__form-container register__form-container-button'>\n              <Button\n                buttonStyle='border-white'\n                className='register__form-button'\n              >\n                ¿No los tienes?\n              </Button>\n\n              <Button\n                buttonStyle='round'\n                type='submit'\n                className='register__form-button'\n                disabled={!disabledButton}\n                onClick={this.uploadCredentials}\n              >\n                Siguiente\n              </Button>\n            </div>\n          </form>\n        </div>\n      </Fragment>\n    )\n  }\n\n  render () {\n    return (\n      <DocumentTitle title={'Diagnóstico - Enconta'}>\n        <div className='register'>\n          {this.renderForm()}\n          <div className='notification-container notification-centered'>\n            <NotificationsContainer />\n          </div>\n        </div>\n      </DocumentTitle>\n    )\n  }\n}\n\nexport default FiscalDiagnostic\n"]},"metadata":{},"sourceType":"module"}