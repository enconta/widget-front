{"ast":null,"code":"import _classCallCheck from \"/Users/usuario-rtd/Desktop/widget-front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/usuario-rtd/Desktop/widget-front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/usuario-rtd/Desktop/widget-front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/usuario-rtd/Desktop/widget-front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/usuario-rtd/Desktop/widget-front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _assertThisInitialized from \"/Users/usuario-rtd/Desktop/widget-front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";\nvar _jsxFileName = \"/Users/usuario-rtd/Desktop/widget-front/src/components/app/shared/satCredentials/ciec.js\";\nimport React, { Component } from 'react';\nimport classNames from 'classnames';\nimport clipboard from 'clipboard-polyfill';\nimport NotificationsActions from 'actions/notifications';\nimport SatCredentialsActions from 'actions/satCredentials';\nimport SessionStore from 'stores/session';\nimport SatCredentialsStore from 'stores/satCredentials';\nimport TextField from 'shared/textField';\nimport Button from 'shared/button';\n\nfunction getCurrentState() {\n  var currentEntity = SessionStore.getCurrentEntity();\n  var credentials = SatCredentialsStore.getCredentials();\n  var user = SessionStore.getUser();\n  return {\n    currentEntity: currentEntity,\n    credentials: credentials,\n    user: user\n  };\n}\n\nvar Ciec =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(Ciec, _Component);\n\n  function Ciec() {\n    var _this;\n\n    _classCallCheck(this, Ciec);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(Ciec).call(this));\n    _this.data = {\n      requestInProgress: false,\n      ciec: '',\n      isValid: true\n    };\n    _this.state = Object.assign({}, _this.data, getCurrentState());\n    _this._onChange = _this._onChange.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    return _this;\n  }\n\n  _createClass(Ciec, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      // Adds listener, when the Store changes, trigger the _onChange callback func\n      SatCredentialsStore.addChangeListener(this._onChange);\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      // Removes the listener to avoid memory leaks\n      SatCredentialsStore.removeChangeListener(this._onChange);\n    }\n  }, {\n    key: \"_onChange\",\n    value: function _onChange() {\n      // When the store changes, the state goes to it and pulls the updated data\n      // then sets it so the component rerenders\n      var state = getCurrentState();\n      this.setState(state);\n    } // Persist password to state\n\n  }, {\n    key: \"onChangeCiecPassword\",\n    value: function onChangeCiecPassword(e) {\n      this.setState({\n        ciec: e.target.value\n      });\n    } // Upload files to the server\n\n  }, {\n    key: \"uploadCiec\",\n    value: function uploadCiec(e) {\n      var _this2 = this;\n\n      e.preventDefault();\n\n      if (this.state.ciec.length > 0 && !this.state.requestInProgress) {\n        this.setState({\n          requestInProgress: true\n        }, function () {\n          SatCredentialsActions.updateSatCredentials({\n            taxable_entity: {\n              sat_password: _this2.state.ciec\n            }\n          }).then(function () {\n            NotificationsActions.success('Contraseña CIEC guardada correctamente');\n\n            _this2.setState({\n              requestInProgress: false\n            });\n\n            SatCredentialsActions.getSatCredentials();\n          }).catch(function (error) {\n            NotificationsActions.error(error);\n\n            _this2.setState({\n              requestInProgress: false\n            });\n          });\n        });\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this3 = this;\n\n      var user = this.state.user;\n      return React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 85\n        },\n        __self: this\n      }, React.createElement(\"h5\", {\n        className: \"subtitle is-6 is-marginless\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 86\n        },\n        __self: this\n      }, \"CIEC\"), React.createElement(\"div\", {\n        className: \"columns\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 87\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"column is-half-desktop\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 88\n        },\n        __self: this\n      }, React.createElement(TextField, {\n        label: \"Contrase\\xF1a CIEC\",\n        type: \"password\",\n        placeholder: \"Contrase\\xF1a CIEC\",\n        value: this.state.ciec,\n        onChange: this.onChangeCiecPassword.bind(this),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 89\n        },\n        __self: this\n      }), user.role !== 'sales' && React.createElement(\"a\", {\n        onClick: function onClick() {\n          clipboard.writeText(_this3.state.credentials.ciec).then(NotificationsActions.success('Contraseña copiada al portapapeles'));\n        },\n        className: classNames({\n          'is-hidden': !this.state.credentials.ciec\n        }),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 97\n        },\n        __self: this\n      }, \"Copiar contrase\\xF1a almacenada\"))), React.createElement(Button, {\n        className: \"align-right\",\n        buttonStyle: \"primary\",\n        icon: \"content-save\",\n        loading: this.state.requestInProgress,\n        onClick: this.uploadCiec.bind(this),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 116\n        },\n        __self: this\n      }, \"Guardar CIEC\"));\n    }\n  }]);\n\n  return Ciec;\n}(Component);\n\nexport default Ciec;","map":{"version":3,"sources":["/Users/usuario-rtd/Desktop/widget-front/src/components/app/shared/satCredentials/ciec.js"],"names":["React","Component","classNames","clipboard","NotificationsActions","SatCredentialsActions","SessionStore","SatCredentialsStore","TextField","Button","getCurrentState","currentEntity","getCurrentEntity","credentials","getCredentials","user","getUser","Ciec","data","requestInProgress","ciec","isValid","state","Object","assign","_onChange","bind","addChangeListener","removeChangeListener","setState","e","target","value","preventDefault","length","updateSatCredentials","taxable_entity","sat_password","then","success","getSatCredentials","catch","error","onChangeCiecPassword","role","writeText","uploadCiec"],"mappings":"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","sourcesContent":["import React, { Component } from 'react'\nimport classNames from 'classnames'\nimport clipboard from 'clipboard-polyfill'\n\nimport NotificationsActions from 'actions/notifications'\nimport SatCredentialsActions from 'actions/satCredentials'\nimport SessionStore from 'stores/session'\nimport SatCredentialsStore from 'stores/satCredentials'\nimport TextField from 'shared/textField'\nimport Button from 'shared/button'\n\nfunction getCurrentState () {\n  let currentEntity = SessionStore.getCurrentEntity()\n  let credentials = SatCredentialsStore.getCredentials()\n  const user = SessionStore.getUser()\n  return {\n    currentEntity,\n    credentials,\n    user\n  }\n}\n\nclass Ciec extends Component {\n  constructor () {\n    super()\n    this.data = {\n      requestInProgress: false,\n      ciec: '',\n      isValid: true\n    }\n    this.state = Object.assign({}, this.data, getCurrentState())\n    this._onChange = this._onChange.bind(this)\n  }\n\n  componentDidMount () {\n    // Adds listener, when the Store changes, trigger the _onChange callback func\n    SatCredentialsStore.addChangeListener(this._onChange)\n  }\n\n  componentWillUnmount () {\n    // Removes the listener to avoid memory leaks\n    SatCredentialsStore.removeChangeListener(this._onChange)\n  }\n\n  _onChange () {\n    // When the store changes, the state goes to it and pulls the updated data\n    // then sets it so the component rerenders\n    let state = getCurrentState()\n    this.setState(state)\n  }\n\n  // Persist password to state\n  onChangeCiecPassword (e) {\n    this.setState({ ciec: e.target.value })\n  }\n\n  // Upload files to the server\n  uploadCiec (e) {\n    e.preventDefault()\n    if (this.state.ciec.length > 0 && !this.state.requestInProgress) {\n      this.setState({ requestInProgress: true }, () => {\n        SatCredentialsActions.updateSatCredentials({\n          taxable_entity: {\n            sat_password: this.state.ciec\n          }\n        })\n          .then(() => {\n            NotificationsActions.success(\n              'Contraseña CIEC guardada correctamente'\n            )\n            this.setState({ requestInProgress: false })\n            SatCredentialsActions.getSatCredentials()\n          })\n          .catch(error => {\n            NotificationsActions.error(error)\n            this.setState({ requestInProgress: false })\n          })\n      })\n    }\n  }\n\n  render () {\n    const { user } = this.state\n    return (\n      <div>\n        <h5 className='subtitle is-6 is-marginless'>CIEC</h5>\n        <div className='columns'>\n          <div className='column is-half-desktop'>\n            <TextField\n              label='Contraseña CIEC'\n              type='password'\n              placeholder='Contraseña CIEC'\n              value={this.state.ciec}\n              onChange={this.onChangeCiecPassword.bind(this)}\n            />\n            {user.role !== 'sales' && (\n              <a\n                onClick={() => {\n                  clipboard\n                    .writeText(this.state.credentials.ciec)\n                    .then(\n                      NotificationsActions.success(\n                        'Contraseña copiada al portapapeles'\n                      )\n                    )\n                }}\n                className={classNames({\n                  'is-hidden': !this.state.credentials.ciec\n                })}\n              >\n                Copiar contraseña almacenada\n              </a>\n            )}\n          </div>\n        </div>\n        <Button\n          className='align-right'\n          buttonStyle='primary'\n          icon='content-save'\n          loading={this.state.requestInProgress}\n          onClick={this.uploadCiec.bind(this)}\n        >\n          Guardar CIEC\n        </Button>\n      </div>\n    )\n  }\n}\n\nexport default Ciec\n"]},"metadata":{},"sourceType":"module"}