{"ast":null,"code":"import _defineProperty from \"/Users/usuario-rtd/Desktop/widget-front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _classCallCheck from \"/Users/usuario-rtd/Desktop/widget-front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/usuario-rtd/Desktop/widget-front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/usuario-rtd/Desktop/widget-front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/usuario-rtd/Desktop/widget-front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/usuario-rtd/Desktop/widget-front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/Users/usuario-rtd/Desktop/widget-front/src/components/app/views/newInvoice/complementos/index.js\";\n// Imports\nimport React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport update from 'immutability-helper';\nimport uuid from 'uuid'; // Components\n\nimport Button from 'shared/button';\nimport Modal from 'shared/modal';\nimport SelectField from 'shared/selectField'; // Invoice add-ons\n\nimport Ine from './ine';\nimport LocalTaxes from './localTaxes';\nimport ForeignTrade from './foreignTrade';\nvar addOns = [{\n  title: 'INE - Instituto Nacional Electoral',\n  component: Ine,\n  totals: false,\n  category: 'ine'\n}, {\n  title: 'Otros Derechos e Impuestos',\n  component: LocalTaxes,\n  totals: true,\n  category: 'local_tax'\n}, {\n  title: 'Comercio Exterior',\n  component: ForeignTrade,\n  totals: false,\n  category: 'foreign_trade'\n}];\nvar ADD_ONS_KEY = 'addOns';\n\nvar AddOns =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(AddOns, _Component);\n\n  function AddOns() {\n    var _this;\n\n    _classCallCheck(this, AddOns);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(AddOns).call(this));\n    _this.data = _defineProperty({\n      create: addOns[0].title,\n      showModal: false\n    }, ADD_ONS_KEY, []);\n    _this.state = Object.assign({}, _this.data);\n    return _this;\n  } // Updates an input's value when it changes\n\n\n  _createClass(AddOns, [{\n    key: \"onChange\",\n    value: function onChange(field, e) {\n      this.setState(_defineProperty({}, field, e.target.value));\n    } // Handle changes to state\n\n  }, {\n    key: \"toggleCreateAddon\",\n    value: function toggleCreateAddon() {\n      this.setState({\n        showModal: !this.state.showModal\n      });\n    } // Handle creation of a new add-on\n\n  }, {\n    key: \"addAddOn\",\n    value: function addAddOn() {\n      var _this2 = this,\n          _this$setState2;\n\n      var currentAddOns = this.state[ADD_ONS_KEY];\n      var newAddOn = Object.assign({}, {\n        uuid: uuid()\n      }, addOns.find(function (a) {\n        return a.title === _this2.state.create;\n      }));\n      this.setState((_this$setState2 = {}, _defineProperty(_this$setState2, ADD_ONS_KEY, update(currentAddOns, _defineProperty({}, currentAddOns.length, {\n        $set: newAddOn\n      }))), _defineProperty(_this$setState2, \"showModal\", false), _this$setState2), function () {\n        _this2.props.onSelectAddon(newAddOn.category);\n\n        _this2.setState({\n          create: _this2.availableAddOns()[0].title\n        });\n      });\n    } // Remove add-on\n\n  }, {\n    key: \"deleteAddOn\",\n    value: function deleteAddOn(uuid) {\n      var _this3 = this;\n\n      this.setState(_defineProperty({}, ADD_ONS_KEY, this.state[ADD_ONS_KEY].filter(function (c) {\n        return c.uuid !== uuid;\n      })), function () {\n        _this3.props.onSelectAddon('regular');\n      });\n    } // Get the list of available add ons, depending on the current selection\n\n  }, {\n    key: \"availableAddOns\",\n    value: function availableAddOns() {\n      var _this4 = this;\n\n      return addOns.filter(function (addOn) {\n        return _this4.state[ADD_ONS_KEY].filter(function (a) {\n          return a.category === addOn.category;\n        }).length === 0;\n      });\n    } // Handle changes to invoice totals\n\n  }, {\n    key: \"totalChanged\",\n    value: function totalChanged(totals) {\n      var _this5 = this;\n\n      this.state[ADD_ONS_KEY].filter(function (c) {\n        return c.totals;\n      }).map(function (a) {\n        return _this5.refs[a.uuid].totalChanged(totals);\n      });\n    } // Render single add-ons\n    // TODO: only send totals to components that require it\n\n  }, {\n    key: \"renderAddOn\",\n    value: function renderAddOn(addOn) {\n      var Cell = addOn.component;\n      return React.createElement(Cell, {\n        key: addOn.uuid,\n        ref: addOn.uuid,\n        uuid: addOn.uuid,\n        title: addOn.title,\n        totals: this.props.totals,\n        deleteAddOn: this.deleteAddOn.bind(this),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 118\n        },\n        __self: this\n      });\n    } // Call validations on all add-ons and return true if all validations succeed\n\n  }, {\n    key: \"validateAllAddOns\",\n    value: function validateAllAddOns() {\n      var _this6 = this;\n\n      return this.state[ADD_ONS_KEY].map(function (addOn) {\n        return _this6.refs[addOn.uuid].validateAndExport();\n      }).every(function (e) {\n        return e;\n      });\n    } // Export all add-ons\n\n  }, {\n    key: \"exportAllAddOns\",\n    value: function exportAllAddOns() {\n      var _this7 = this;\n\n      return this.state[ADD_ONS_KEY].map(function (addOn) {\n        return _this7.refs[addOn.uuid].validateAndExport();\n      });\n    } // Render all add-ons\n\n  }, {\n    key: \"renderAddOns\",\n    value: function renderAddOns() {\n      var _this8 = this;\n\n      var addOns = this.state[ADD_ONS_KEY];\n      return addOns.length > 0 ? addOns.map(function (addOn) {\n        return _this8.renderAddOn(addOn);\n      }) : null;\n    } // Render select to create new add-ons\n\n  }, {\n    key: \"renderCreate\",\n    value: function renderCreate() {\n      return React.createElement(Modal, {\n        isActive: this.state.showModal,\n        toggleModal: this.toggleCreateAddon.bind(this),\n        onSubmit: this.addAddOn.bind(this),\n        title: \"Agregar Complemento\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 154\n        },\n        __self: this\n      }, React.createElement(SelectField, {\n        label: \"Tipo de Complemento\",\n        placeholder: \"Selecciona complemento\",\n        options: this.availableAddOns(),\n        value: this.state.create,\n        onChange: this.onChange.bind(this, 'create'),\n        optionsConfig: {\n          id: 'title',\n          label: 'title'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 160\n        },\n        __self: this\n      }));\n    } // Render addons box only if there's at least 1 add-on\n\n  }, {\n    key: \"renderAllAddOns\",\n    value: function renderAllAddOns() {\n      return this.state[ADD_ONS_KEY].length > 0 ? React.createElement(\"div\", {\n        className: \"column is-12\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 175\n        },\n        __self: this\n      }, this.renderAddOns()) : null;\n    } // Renders the add addon button\n\n  }, {\n    key: \"renderCreateButton\",\n    value: function renderCreateButton() {\n      if (this.state[ADD_ONS_KEY].length > 0) return null;\n      if (this.availableAddOns().length === 0) return null;\n      return React.createElement(Button, {\n        buttonStyle: \"link\",\n        icon: \"plus\",\n        onClick: this.toggleCreateAddon.bind(this),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 184\n        },\n        __self: this\n      }, \"Agregar Complemento\");\n    } // Main render\n\n  }, {\n    key: \"render\",\n    value: function render() {\n      return React.createElement(\"div\", {\n        className: \"columns is-multiline\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 197\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"column is-12\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 198\n        },\n        __self: this\n      }, React.createElement(\"h2\", {\n        className: \"subheader-green\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 199\n        },\n        __self: this\n      }, \"Complementos\"), React.createElement(\"p\", {\n        className: \"espacio-small caption\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 200\n        },\n        __self: this\n      }, \"Los complementos son opcionales, presiona el bot\\xF3n Agregar Complemento para iniciar.\")), this.renderAllAddOns(), React.createElement(\"div\", {\n        className: \"column is-12\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 206\n        },\n        __self: this\n      }, this.renderCreate(), this.renderCreateButton()));\n    }\n  }]);\n\n  return AddOns;\n}(Component);\n\nAddOns.propTypes = {\n  onSelectAddon: PropTypes.func,\n  totals: PropTypes.oneOfType([PropTypes.array, PropTypes.object])\n};\nexport default AddOns;","map":{"version":3,"sources":["/Users/usuario-rtd/Desktop/widget-front/src/components/app/views/newInvoice/complementos/index.js"],"names":["React","Component","PropTypes","update","uuid","Button","Modal","SelectField","Ine","LocalTaxes","ForeignTrade","addOns","title","component","totals","category","ADD_ONS_KEY","AddOns","data","create","showModal","state","Object","assign","field","e","setState","target","value","currentAddOns","newAddOn","find","a","length","$set","props","onSelectAddon","availableAddOns","filter","c","addOn","map","refs","totalChanged","Cell","deleteAddOn","bind","validateAndExport","every","renderAddOn","toggleCreateAddon","addAddOn","onChange","id","label","renderAddOns","renderAllAddOns","renderCreate","renderCreateButton","propTypes","func","oneOfType","array","object"],"mappings":"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","sourcesContent":["// Imports\nimport React, { Component } from 'react'\nimport PropTypes from 'prop-types'\nimport update from 'immutability-helper'\nimport uuid from 'uuid'\n\n// Components\nimport Button from 'shared/button'\nimport Modal from 'shared/modal'\nimport SelectField from 'shared/selectField'\n\n// Invoice add-ons\nimport Ine from './ine'\nimport LocalTaxes from './localTaxes'\nimport ForeignTrade from './foreignTrade'\n\nconst addOns = [\n  {\n    title: 'INE - Instituto Nacional Electoral',\n    component: Ine,\n    totals: false,\n    category: 'ine'\n  },\n  {\n    title: 'Otros Derechos e Impuestos',\n    component: LocalTaxes,\n    totals: true,\n    category: 'local_tax'\n  },\n  {\n    title: 'Comercio Exterior',\n    component: ForeignTrade,\n    totals: false,\n    category: 'foreign_trade'\n  }\n]\n\nconst ADD_ONS_KEY = 'addOns'\n\nclass AddOns extends Component {\n  constructor () {\n    super()\n    this.data = {\n      create: addOns[0].title,\n      showModal: false,\n      [ADD_ONS_KEY]: []\n    }\n    this.state = Object.assign({}, this.data)\n  }\n\n  // Updates an input's value when it changes\n  onChange (field, e) {\n    this.setState({ [field]: e.target.value })\n  }\n\n  // Handle changes to state\n  toggleCreateAddon () {\n    this.setState({ showModal: !this.state.showModal })\n  }\n\n  // Handle creation of a new add-on\n  addAddOn () {\n    const currentAddOns = this.state[ADD_ONS_KEY]\n    const newAddOn = Object.assign(\n      {},\n      { uuid: uuid() },\n      addOns.find(a => a.title === this.state.create)\n    )\n    this.setState(\n      {\n        [ADD_ONS_KEY]: update(currentAddOns, {\n          [currentAddOns.length]: { $set: newAddOn }\n        }),\n        showModal: false\n      },\n      () => {\n        this.props.onSelectAddon(newAddOn.category)\n        this.setState({\n          create: this.availableAddOns()[0].title\n        })\n      }\n    )\n  }\n\n  // Remove add-on\n  deleteAddOn (uuid) {\n    this.setState(\n      {\n        [ADD_ONS_KEY]: this.state[ADD_ONS_KEY].filter(c => c.uuid !== uuid)\n      },\n      () => {\n        this.props.onSelectAddon('regular')\n      }\n    )\n  }\n\n  // Get the list of available add ons, depending on the current selection\n  availableAddOns () {\n    return addOns.filter(\n      addOn =>\n        this.state[ADD_ONS_KEY].filter(a => a.category === addOn.category)\n          .length === 0\n    )\n  }\n\n  // Handle changes to invoice totals\n  totalChanged (totals) {\n    this.state[ADD_ONS_KEY].filter(c => c.totals).map(a =>\n      this.refs[a.uuid].totalChanged(totals)\n    )\n  }\n\n  // Render single add-ons\n  // TODO: only send totals to components that require it\n  renderAddOn (addOn) {\n    const Cell = addOn.component\n    return (\n      <Cell\n        key={addOn.uuid}\n        ref={addOn.uuid}\n        uuid={addOn.uuid}\n        title={addOn.title}\n        totals={this.props.totals}\n        deleteAddOn={this.deleteAddOn.bind(this)}\n      />\n    )\n  }\n\n  // Call validations on all add-ons and return true if all validations succeed\n  validateAllAddOns () {\n    return this.state[ADD_ONS_KEY].map(addOn =>\n      this.refs[addOn.uuid].validateAndExport()\n    ).every(e => e)\n  }\n\n  // Export all add-ons\n  exportAllAddOns () {\n    return this.state[ADD_ONS_KEY].map(addOn =>\n      this.refs[addOn.uuid].validateAndExport()\n    )\n  }\n\n  // Render all add-ons\n  renderAddOns () {\n    const addOns = this.state[ADD_ONS_KEY]\n    return addOns.length > 0\n      ? addOns.map(addOn => this.renderAddOn(addOn))\n      : null\n  }\n\n  // Render select to create new add-ons\n  renderCreate () {\n    return (\n      <Modal\n        isActive={this.state.showModal}\n        toggleModal={this.toggleCreateAddon.bind(this)}\n        onSubmit={this.addAddOn.bind(this)}\n        title='Agregar Complemento'\n      >\n        <SelectField\n          label='Tipo de Complemento'\n          placeholder='Selecciona complemento'\n          options={this.availableAddOns()}\n          value={this.state.create}\n          onChange={this.onChange.bind(this, 'create')}\n          optionsConfig={{ id: 'title', label: 'title' }}\n        />\n      </Modal>\n    )\n  }\n\n  // Render addons box only if there's at least 1 add-on\n  renderAllAddOns () {\n    return this.state[ADD_ONS_KEY].length > 0 ? (\n      <div className='column is-12'>{this.renderAddOns()}</div>\n    ) : null\n  }\n\n  // Renders the add addon button\n  renderCreateButton () {\n    if (this.state[ADD_ONS_KEY].length > 0) return null\n    if (this.availableAddOns().length === 0) return null\n    return (\n      <Button\n        buttonStyle='link'\n        icon='plus'\n        onClick={this.toggleCreateAddon.bind(this)}\n      >\n        Agregar Complemento\n      </Button>\n    )\n  }\n\n  // Main render\n  render () {\n    return (\n      <div className='columns is-multiline'>\n        <div className='column is-12'>\n          <h2 className='subheader-green'>Complementos</h2>\n          <p className='espacio-small caption'>\n            Los complementos son opcionales, presiona el botón Agregar\n            Complemento para iniciar.\n          </p>\n        </div>\n        {this.renderAllAddOns()}\n        <div className='column is-12'>\n          {this.renderCreate()}\n          {this.renderCreateButton()}\n        </div>\n      </div>\n    )\n  }\n}\n\nAddOns.propTypes = {\n  onSelectAddon: PropTypes.func,\n  totals: PropTypes.oneOfType([PropTypes.array, PropTypes.object])\n}\n\nexport default AddOns\n"]},"metadata":{},"sourceType":"module"}