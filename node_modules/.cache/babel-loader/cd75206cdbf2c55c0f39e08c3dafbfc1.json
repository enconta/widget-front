{"ast":null,"code":"import _defineProperty from \"/Users/usuario-rtd/Desktop/widget-front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _objectSpread from \"/Users/usuario-rtd/Desktop/widget-front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread\";\nimport _regeneratorRuntime from \"/Users/usuario-rtd/Desktop/widget-front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/usuario-rtd/Desktop/widget-front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"/Users/usuario-rtd/Desktop/widget-front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/usuario-rtd/Desktop/widget-front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/usuario-rtd/Desktop/widget-front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/usuario-rtd/Desktop/widget-front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/usuario-rtd/Desktop/widget-front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/Users/usuario-rtd/Desktop/widget-front/src/components/app/views/viewInvoice/index.js\";\nimport React, { Component, Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport { browserHistory, Link } from 'react-router';\nimport fileDownload from 'react-file-download';\nimport _isNil from 'lodash/isNil';\nimport API from 'api';\nimport AppSignal from 'appsignal';\nimport { prettyDate, getClientsPlan } from 'utils';\nimport AppStorage from 'api/appStorage';\nimport Button from 'shared/button';\nimport Card from 'shared/card';\nimport Loading from 'shared/loading';\nimport { ENCONTA_INVOICE_TYPE, ENCONTA_INVOICE_SUBTYPE } from 'shared/catalogs';\nimport pluralize from 'pluralize';\nimport Details from './details';\nimport Issuer from './issuer';\nimport Recipient from './recipient';\nimport Concepts from './concepts';\nimport PayrollConcepts from './payrollConcepts';\nimport Payments from './payments';\nimport PaymentModal from './payments/paymentModal';\nimport MailerModal from './mailerModal';\nimport PaymentComplement from './paymentComplement';\nimport NotificationsActions from 'actions/notifications';\nimport InvoiceActions from 'actions/invoices';\nimport RestrictionsActions from 'actions/restrictions';\nimport RestrictionsStore from 'stores/restrictions';\nimport Banner from 'shared/banner';\nimport { toggleBanner, toggleBannerModal, modalPlans, toggleUpdatePlanModal, modalUpdatePlan } from './utilsRestrictions';\nvar INVOICE_KEY = 'invoice';\nvar TYPE_KEY = 'type';\nvar SUBTYPE_KEY = 'subtype';\nvar PAC_REFERENCE = 'pac_reference';\nvar INTERVAL = 1000;\nvar windowGlobal = typeof window !== 'undefined' && window;\n\nfunction getCurrentState() {\n  return {\n    remainingPdfDownloads: RestrictionsStore.getRemainingPdfDownload(),\n    remainingSendEmails: RestrictionsStore.getRemainingEmail()\n  };\n}\n\nvar ViewInvoice =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(ViewInvoice, _Component);\n\n  function ViewInvoice(props) {\n    var _objectSpread2;\n\n    var _this;\n\n    _classCallCheck(this, ViewInvoice);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(ViewInvoice).call(this, props));\n    _this.timer = null;\n\n    _this._onChange = function () {\n      _this.setState(getCurrentState());\n    };\n\n    _this.toggleMailModal = function () {\n      _this.setState(function (prevState) {\n        return {\n          mailModalOpen: !prevState.mailModalOpen\n        };\n      });\n    };\n\n    _this.cancelInvoice = function (reemit) {\n      _this.setState({\n        cancelInProgress: true\n      },\n      /*#__PURE__*/\n      _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee() {\n        var invoiceID;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                invoiceID = _this.props.params.id;\n                _context.next = 3;\n                return InvoiceActions.cancelInvoice(invoiceID);\n\n              case 3:\n                NotificationsActions.info('Se ha comenzado el proceso de cancelación, en un momento estará listo', 'infinite');\n\n                _this.askingCancelStatus(reemit);\n\n              case 5:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee);\n      })));\n    };\n\n    _this.askingCancelStatus = function (reemit) {\n      var invoiceID = _this.props.params.id;\n      _this.timer = setTimeout(\n      /*#__PURE__*/\n      _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee2() {\n        var cancelationStatus, inProgress, cancelled;\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                _context2.next = 2;\n                return InvoiceActions.askCancelationStatus(invoiceID);\n\n              case 2:\n                cancelationStatus = _context2.sent;\n                inProgress = cancelationStatus.inProgress, cancelled = cancelationStatus.cancelled;\n                _context2.t0 = inProgress;\n                _context2.next = _context2.t0 === true ? 7 : _context2.t0 === 'failed' ? 9 : 13;\n                break;\n\n              case 7:\n                _this.askingCancelStatus();\n\n                return _context2.abrupt(\"break\", 16);\n\n              case 9:\n                _this.setState({\n                  cancelInProgress: false\n                });\n\n                NotificationsActions.clearAll();\n                NotificationsActions.error('Ocurrió un error al cancelar la factura');\n                return _context2.abrupt(\"break\", 16);\n\n              case 13:\n                NotificationsActions.clearAll();\n\n                if (cancelled) {\n                  NotificationsActions.success('Factura cancelada');\n\n                  if (reemit) {\n                    browserHistory.push(\"/facturas/nueva?invoice=\".concat(invoiceID));\n                  } else {\n                    _this.setState({\n                      cancelInProgress: false\n                    });\n                  }\n                } else {\n                  NotificationsActions.error('Ocurrió un error al cancelar la factura');\n\n                  _this.setState({\n                    cancelInProgress: false\n                  });\n                }\n\n                return _context2.abrupt(\"break\", 16);\n\n              case 16:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2);\n      })), INTERVAL);\n    };\n\n    _this.downloadPDF = function () {\n      RestrictionsActions.downloadPDF();\n    };\n\n    _this.data = _objectSpread((_objectSpread2 = {\n      requestInProgress: false,\n      cancelInProgress: false,\n      paymentModalOpen: false,\n      mailModalOpen: false\n    }, _defineProperty(_objectSpread2, INVOICE_KEY, {}), _defineProperty(_objectSpread2, \"paymentDetails\", []), _defineProperty(_objectSpread2, \"paymentId\", ''), _objectSpread2), getCurrentState(), {\n      showBanner: true,\n      showBannerEmail: true,\n      showBannerModal: false,\n      updatePlanModal: false\n    });\n    _this.state = Object.assign({}, _this.data);\n    return _this;\n  }\n\n  _createClass(ViewInvoice, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this.getInvoice();\n      RestrictionsStore.addChangeListener(this._onChange);\n      RestrictionsActions.getRestrictions().catch(function (error) {\n        NotificationsActions.error(error);\n      });\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      clearTimeout(this.timer);\n      RestrictionsStore.removeChangeListener(this._onChange);\n    }\n  }, {\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate(prevProps) {\n      if (prevProps.params.id !== this.props.params.id) {\n        this.getInvoice();\n      }\n    }\n  }, {\n    key: \"getInvoice\",\n    value: function getInvoice() {\n      var _this2 = this;\n\n      this.setState({\n        requestInProgress: true\n      }, function () {\n        API.Invoice.Show(_this2.props.params.id).then(function (response) {\n          _this2.setState(_defineProperty({\n            requestInProgress: false,\n            paymentDetails: response.invoice.payment_detail\n          }, INVOICE_KEY, response[INVOICE_KEY]));\n        }).catch(function (error) {\n          _this2.setState({\n            requestInProgress: false\n          });\n\n          AppSignal.sendError(error);\n        });\n      });\n    }\n  }, {\n    key: \"togglePaymentModal\",\n    value: function togglePaymentModal() {\n      var paymentId = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';\n      this.setState(function (prevState) {\n        return {\n          paymentModalOpen: !prevState.paymentModalOpen,\n          paymentId: paymentId.toString()\n        };\n      });\n    }\n  }, {\n    key: \"downloadFile\",\n    value: function downloadFile(format) {\n      var _this3 = this;\n\n      var id = this.props.params.id;\n      var apiCall;\n\n      switch (format) {\n        case 'xml':\n          apiCall = API.Invoice.Xml;\n          break;\n\n        case 'pdf':\n          apiCall = API.Invoice.Pdf;\n          break;\n      }\n\n      this.setState({\n        requestInProgress: true\n      }, function () {\n        apiCall(id).then(function (r) {\n          if (typeof r[format] !== 'undefined') {\n            fileDownload(r[format], \"factura-\".concat(r.uuid || 'enconta', \".\").concat(format));\n            NotificationsActions.success('Archivo guardado');\n          }\n\n          _this3.setState({\n            requestInProgress: false\n          });\n        }).catch(function (error) {\n          AppSignal.sendError(error);\n          NotificationsActions.error('El archivo no pudo descargarse');\n\n          _this3.setState({\n            requestInProgress: false\n          });\n        });\n      });\n    }\n  }, {\n    key: \"renderCancelButton\",\n    value: function renderCancelButton() {\n      var _this4 = this;\n\n      var renderCancelButton = null;\n      var version = this.state[INVOICE_KEY].version;\n\n      if (version === '3.2' || version === '3.3') {\n        var disabledButton = this.state[INVOICE_KEY][PAC_REFERENCE] === null || this.state[INVOICE_KEY]['cancelled_at'] !== null;\n        var isInvoice = this.state[INVOICE_KEY][TYPE_KEY] === 0;\n        var isExpensePayroll = this.state[INVOICE_KEY][TYPE_KEY] === 1 && this.state[INVOICE_KEY].payroll;\n        renderCancelButton = React.createElement(React.Fragment, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 219\n          },\n          __self: this\n        }, (isInvoice || isExpensePayroll) && React.createElement(Button, {\n          icon: \"repeat\",\n          buttonStyle: disabledButton ? '' : 'danger',\n          loading: this.state.cancelInProgress,\n          onClick: function onClick() {\n            return _this4.cancelInvoice(true);\n          },\n          disabled: disabledButton,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 221\n          },\n          __self: this\n        }, \"Cancelar Factura y Reemitir\"), React.createElement(Button, {\n          icon: \"cancel\",\n          buttonStyle: disabledButton ? '' : 'danger',\n          loading: this.state.cancelInProgress,\n          onClick: function onClick() {\n            return _this4.cancelInvoice(false);\n          },\n          disabled: disabledButton,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 231\n          },\n          __self: this\n        }, \"Cancelar Factura\"));\n      }\n\n      return renderCancelButton;\n    }\n  }, {\n    key: \"renderActions\",\n    value: function renderActions() {\n      var _this5 = this;\n\n      var _this$state = this.state,\n          remainingSendEmails = _this$state.remainingSendEmails,\n          updatePlanModal = _this$state.updatePlanModal;\n      var noMoreMails = remainingSendEmails === 0;\n      return React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 250\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"columns\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 251\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"column flex-end\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 252\n        },\n        __self: this\n      }, this.renderCancelButton(), React.createElement(Button, {\n        buttonStyle: \"primary\",\n        icon: \"email\",\n        onClick: noMoreMails ? function () {\n          return toggleUpdatePlanModal(_this5, updatePlanModal, 'correos para enviar');\n        } : function () {\n          return _this5.toggleMailModal();\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 254\n        },\n        __self: this\n      }, \"Enviar por Correo\"))));\n    }\n  }, {\n    key: \"getInvoiceType\",\n    value: function getInvoiceType() {\n      var type = '';\n      var subtype = '';\n\n      if (!_isNil(this.state[INVOICE_KEY][TYPE_KEY])) {\n        type = ENCONTA_INVOICE_TYPE[this.state[INVOICE_KEY][TYPE_KEY]].label;\n      }\n\n      if (!_isNil(this.state[INVOICE_KEY][SUBTYPE_KEY])) {\n        var KEY = this.state[INVOICE_KEY][SUBTYPE_KEY];\n        subtype = ENCONTA_INVOICE_SUBTYPE[KEY].label.toLowerCase();\n      }\n\n      return \"\".concat(type, \" \").concat(subtype);\n    }\n  }, {\n    key: \"renderCancelledInvoice\",\n    value: function renderCancelledInvoice() {\n      return this.state[INVOICE_KEY]['cancelled_at'] && this.state[INVOICE_KEY]['cancelled_at'] !== null && React.createElement(\"h2\", {\n        className: \"kinda-notification error\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 293\n        },\n        __self: this\n      }, \"Factura Cancelada el\", ' ', prettyDate(this.state[INVOICE_KEY]['cancelled_at']));\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this6 = this;\n\n      var _this$state2 = this.state,\n          requestInProgress = _this$state2.requestInProgress,\n          remainingPdfDownloads = _this$state2.remainingPdfDownloads,\n          showBanner = _this$state2.showBanner,\n          remainingSendEmails = _this$state2.remainingSendEmails,\n          showBannerEmail = _this$state2.showBannerEmail,\n          showBannerModal = _this$state2.showBannerModal,\n          updatePlanModal = _this$state2.updatePlanModal;\n      var invoice = this.state[INVOICE_KEY];\n      var isValidVersion = invoice.version === '3.3' && invoice[TYPE_KEY] === 0;\n      var isExpensePayroll = invoice[TYPE_KEY] === 1 && invoice.payroll;\n      var isComplementVoucher = invoice.voucher_type === 'p';\n      var entityId = AppStorage.getCurrentEntity().id;\n      var disabledButton = !invoice.digital_tax_stamp;\n\n      if (requestInProgress) {\n        return React.createElement(Loading, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 322\n          },\n          __self: this\n        });\n      }\n\n      pluralize.addPluralRule('queda', 'quedan');\n      var buttonInvoicesText = \"Te \".concat(pluralize('queda', remainingPdfDownloads), \" \").concat(remainingPdfDownloads, \" PDF para descargar.\");\n      var buttonEmailText = \"Te \".concat(pluralize('queda', remainingSendEmails), \" \").concat(remainingSendEmails, \" correos para enviar.\");\n      var _windowGlobal$localSt = windowGlobal.localStorage,\n          sawPdfBanner = _windowGlobal$localSt.sawPdfBanner,\n          showEmailBanner = _windowGlobal$localSt.showEmailBanner;\n      var plan = getClientsPlan();\n      var showPdfCounter = plan === 'free' && sawPdfBanner !== 'seen' && showBanner;\n      var showEmailCounter = plan === 'free' && showEmailBanner !== 'seen' && showBannerEmail;\n      var noMorePDF = remainingPdfDownloads === 0;\n      return React.createElement(Fragment, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 343\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"flex-between\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 344\n        },\n        __self: this\n      }, React.createElement(\"h1\", {\n        className: \"headline\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 345\n        },\n        __self: this\n      }, !isComplementVoucher ? this.getInvoiceType() : 'Complemento de pago'), React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 350\n        },\n        __self: this\n      }, (isValidVersion || isExpensePayroll) && React.createElement(Link, {\n        style: {\n          marginRight: '0.5rem'\n        },\n        to: \"/\".concat(isExpensePayroll ? 'facturas_de_nomina' : 'facturas', \"/nueva?invoice=\").concat(invoice.id),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 352\n        },\n        __self: this\n      }, React.createElement(Button, {\n        buttonStyle: \"white\",\n        icon: \"repeat\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 358\n        },\n        __self: this\n      }, \"Reemitir\")), noMorePDF ? React.createElement(Button, {\n        buttonStyle: \"white\",\n        icon: \"file-pdf\",\n        disabled: disabledButton,\n        onClick: function onClick() {\n          return toggleUpdatePlanModal(_this6, updatePlanModal, 'descargas de PDF');\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 364\n        },\n        __self: this\n      }, \"Descargar PDF\") : React.createElement(\"a\", {\n        style: {\n          marginRight: '0.5rem'\n        },\n        href: \"\".concat(process.env.API_SERVER).concat(process.env.API_PREFIX, \"/pdfs/\").concat(this.props.params.id, \"/\").concat(entityId),\n        download: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 379\n        },\n        __self: this\n      }, React.createElement(Button, {\n        buttonStyle: \"white\",\n        icon: \"file-pdf\",\n        disabled: disabledButton,\n        onClick: function onClick() {\n          return _this6.downloadPDF();\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 384\n        },\n        __self: this\n      }, \"Descargar PDF\")), React.createElement(Button, {\n        buttonStyle: \"white\",\n        icon: \"file-xml\",\n        disabled: !invoice.digital_tax_stamp,\n        onClick: this.downloadFile.bind(this, 'xml'),\n        loading: this.state.requestInProgress,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 395\n        },\n        __self: this\n      }, \"Descargar XML\"))), React.createElement(Card, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 406\n        },\n        __self: this\n      }, this.renderCancelledInvoice(), showPdfCounter && React.createElement(Banner, {\n        color: 'blue',\n        buttonText: 'Mejora tu plan',\n        text: buttonInvoicesText,\n        controlBanner: function controlBanner() {\n          return toggleBanner(_this6, showBanner, 'sawPdfBanner');\n        },\n        bannerAction: function bannerAction() {\n          return toggleBannerModal(_this6, showBannerModal);\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 409\n        },\n        __self: this\n      }), React.createElement(\"div\", {\n        className: \"columns\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 419\n        },\n        __self: this\n      }, React.createElement(Issuer, {\n        invoice: invoice,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 420\n        },\n        __self: this\n      }), React.createElement(Recipient, {\n        invoice: invoice,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 421\n        },\n        __self: this\n      })), React.createElement(\"div\", {\n        className: \"columns\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 423\n        },\n        __self: this\n      }, React.createElement(Details, {\n        invoice: invoice,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 424\n        },\n        __self: this\n      }), !isComplementVoucher && React.createElement(Payments, {\n        invoice: invoice,\n        toggleModal: this.togglePaymentModal.bind(this),\n        getInvoice: this.getInvoice.bind(this),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 426\n        },\n        __self: this\n      })), showEmailCounter && React.createElement(Banner, {\n        color: 'blue',\n        buttonText: 'Mejora tu plan',\n        text: buttonEmailText,\n        controlBanner: function controlBanner() {\n          return toggleBanner(_this6, showBannerEmail, 'showEmailBanner');\n        },\n        bannerAction: function bannerAction() {\n          return toggleBannerModal(_this6, showBannerModal);\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 434\n        },\n        __self: this\n      }), React.createElement(\"div\", {\n        className: \"columns\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 444\n        },\n        __self: this\n      }, !isComplementVoucher ? React.createElement(\"div\", {\n        className: \"is-fullwidth\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 446\n        },\n        __self: this\n      }, invoice.payroll ? React.createElement(PayrollConcepts, {\n        invoice: invoice,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 448\n        },\n        __self: this\n      }) : React.createElement(Concepts, {\n        invoice: invoice,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 450\n        },\n        __self: this\n      })) : React.createElement(PaymentComplement, {\n        paymentDetails: this.state.paymentDetails,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 454\n        },\n        __self: this\n      })), React.createElement(\"br\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 457\n        },\n        __self: this\n      }), React.createElement(\"br\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 458\n        },\n        __self: this\n      }), this.renderActions()), React.createElement(PaymentModal, {\n        isActive: this.state.paymentModalOpen,\n        toggleModal: this.togglePaymentModal.bind(this),\n        invoice: invoice,\n        paymentId: this.state.paymentId,\n        getInvoice: this.getInvoice.bind(this),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 461\n        },\n        __self: this\n      }), React.createElement(MailerModal, {\n        isActive: this.state.mailModalOpen,\n        toggleModal: this.toggleMailModal.bind(this),\n        invoice: invoice,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 468\n        },\n        __self: this\n      }), modalPlans(this), modalUpdatePlan(this));\n    }\n  }]);\n\n  return ViewInvoice;\n}(Component);\n\nViewInvoice.propTypes = {\n  params: PropTypes.shape({\n    id: PropTypes.string\n  })\n};\nexport default ViewInvoice;","map":{"version":3,"sources":["/Users/usuario-rtd/Desktop/widget-front/src/components/app/views/viewInvoice/index.js"],"names":["React","Component","Fragment","PropTypes","browserHistory","Link","fileDownload","_isNil","API","AppSignal","prettyDate","getClientsPlan","AppStorage","Button","Card","Loading","ENCONTA_INVOICE_TYPE","ENCONTA_INVOICE_SUBTYPE","pluralize","Details","Issuer","Recipient","Concepts","PayrollConcepts","Payments","PaymentModal","MailerModal","PaymentComplement","NotificationsActions","InvoiceActions","RestrictionsActions","RestrictionsStore","Banner","toggleBanner","toggleBannerModal","modalPlans","toggleUpdatePlanModal","modalUpdatePlan","INVOICE_KEY","TYPE_KEY","SUBTYPE_KEY","PAC_REFERENCE","INTERVAL","windowGlobal","window","getCurrentState","remainingPdfDownloads","getRemainingPdfDownload","remainingSendEmails","getRemainingEmail","ViewInvoice","props","timer","_onChange","setState","toggleMailModal","prevState","mailModalOpen","cancelInvoice","reemit","cancelInProgress","invoiceID","params","id","info","askingCancelStatus","setTimeout","askCancelationStatus","cancelationStatus","inProgress","cancelled","clearAll","error","success","push","downloadPDF","data","requestInProgress","paymentModalOpen","showBanner","showBannerEmail","showBannerModal","updatePlanModal","state","Object","assign","getInvoice","addChangeListener","getRestrictions","catch","clearTimeout","removeChangeListener","prevProps","Invoice","Show","then","response","paymentDetails","invoice","payment_detail","sendError","paymentId","toString","format","apiCall","Xml","Pdf","r","uuid","renderCancelButton","version","disabledButton","isInvoice","isExpensePayroll","payroll","noMoreMails","type","subtype","label","KEY","toLowerCase","isValidVersion","isComplementVoucher","voucher_type","entityId","getCurrentEntity","digital_tax_stamp","addPluralRule","buttonInvoicesText","buttonEmailText","localStorage","sawPdfBanner","showEmailBanner","plan","showPdfCounter","showEmailCounter","noMorePDF","getInvoiceType","marginRight","process","env","API_SERVER","API_PREFIX","downloadFile","bind","renderCancelledInvoice","togglePaymentModal","renderActions","propTypes","shape","string"],"mappings":"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","sourcesContent":["import React, { Component, Fragment } from 'react'\nimport PropTypes from 'prop-types'\nimport { browserHistory, Link } from 'react-router'\nimport fileDownload from 'react-file-download'\nimport _isNil from 'lodash/isNil'\nimport API from 'api'\nimport AppSignal from 'appsignal'\nimport { prettyDate, getClientsPlan } from 'utils'\nimport AppStorage from 'api/appStorage'\n\nimport Button from 'shared/button'\nimport Card from 'shared/card'\nimport Loading from 'shared/loading'\nimport { ENCONTA_INVOICE_TYPE, ENCONTA_INVOICE_SUBTYPE } from 'shared/catalogs'\nimport pluralize from 'pluralize'\nimport Details from './details'\nimport Issuer from './issuer'\nimport Recipient from './recipient'\nimport Concepts from './concepts'\nimport PayrollConcepts from './payrollConcepts'\nimport Payments from './payments'\nimport PaymentModal from './payments/paymentModal'\nimport MailerModal from './mailerModal'\nimport PaymentComplement from './paymentComplement'\n\nimport NotificationsActions from 'actions/notifications'\nimport InvoiceActions from 'actions/invoices'\n\nimport RestrictionsActions from 'actions/restrictions'\n\nimport RestrictionsStore from 'stores/restrictions'\nimport Banner from 'shared/banner'\nimport {\n  toggleBanner,\n  toggleBannerModal,\n  modalPlans,\n  toggleUpdatePlanModal,\n  modalUpdatePlan\n} from './utilsRestrictions'\n\nconst INVOICE_KEY = 'invoice'\nconst TYPE_KEY = 'type'\nconst SUBTYPE_KEY = 'subtype'\nconst PAC_REFERENCE = 'pac_reference'\nconst INTERVAL = 1000\nconst windowGlobal = typeof window !== 'undefined' && window\nfunction getCurrentState () {\n  return {\n    remainingPdfDownloads: RestrictionsStore.getRemainingPdfDownload(),\n    remainingSendEmails: RestrictionsStore.getRemainingEmail()\n  }\n}\nclass ViewInvoice extends Component {\n  constructor (props) {\n    super(props)\n    this.data = {\n      requestInProgress: false,\n      cancelInProgress: false,\n      paymentModalOpen: false,\n      mailModalOpen: false,\n      [INVOICE_KEY]: {},\n      paymentDetails: [],\n      paymentId: '',\n      ...getCurrentState(),\n      showBanner: true,\n      showBannerEmail: true,\n      showBannerModal: false,\n      updatePlanModal: false\n    }\n    this.state = Object.assign({}, this.data)\n  }\n  timer = null\n\n  componentDidMount () {\n    this.getInvoice()\n    RestrictionsStore.addChangeListener(this._onChange)\n    RestrictionsActions.getRestrictions().catch(error => {\n      NotificationsActions.error(error)\n    })\n  }\n\n  componentWillUnmount () {\n    clearTimeout(this.timer)\n    RestrictionsStore.removeChangeListener(this._onChange)\n  }\n\n  _onChange = () => {\n    this.setState(getCurrentState())\n  }\n\n  componentDidUpdate (prevProps) {\n    if (prevProps.params.id !== this.props.params.id) {\n      this.getInvoice()\n    }\n  }\n\n  getInvoice () {\n    this.setState({ requestInProgress: true }, () => {\n      API.Invoice.Show(this.props.params.id)\n        .then(response => {\n          this.setState({\n            requestInProgress: false,\n            paymentDetails: response.invoice.payment_detail,\n            [INVOICE_KEY]: response[INVOICE_KEY]\n          })\n        })\n        .catch(error => {\n          this.setState({ requestInProgress: false })\n          AppSignal.sendError(error)\n        })\n    })\n  }\n\n  toggleMailModal = () => {\n    this.setState(prevState => ({ mailModalOpen: !prevState.mailModalOpen }))\n  }\n\n  togglePaymentModal (paymentId = '') {\n    this.setState(prevState => ({\n      paymentModalOpen: !prevState.paymentModalOpen,\n      paymentId: paymentId.toString()\n    }))\n  }\n\n  cancelInvoice = reemit => {\n    this.setState({ cancelInProgress: true }, async () => {\n      const { id: invoiceID } = this.props.params\n      await InvoiceActions.cancelInvoice(invoiceID)\n\n      NotificationsActions.info(\n        'Se ha comenzado el proceso de cancelación, en un momento estará listo',\n        'infinite'\n      )\n\n      this.askingCancelStatus(reemit)\n    })\n  }\n\n  askingCancelStatus = reemit => {\n    const { id: invoiceID } = this.props.params\n    this.timer = setTimeout(async () => {\n      const cancelationStatus = await InvoiceActions.askCancelationStatus(\n        invoiceID\n      )\n      const { inProgress, cancelled } = cancelationStatus\n      switch (inProgress) {\n        case true:\n          this.askingCancelStatus()\n          break\n        case 'failed':\n          this.setState({ cancelInProgress: false })\n          NotificationsActions.clearAll()\n          NotificationsActions.error('Ocurrió un error al cancelar la factura')\n          break\n        default:\n          NotificationsActions.clearAll()\n\n          if (cancelled) {\n            NotificationsActions.success('Factura cancelada')\n            if (reemit) {\n              browserHistory.push(`/facturas/nueva?invoice=${invoiceID}`)\n            } else {\n              this.setState({ cancelInProgress: false })\n            }\n          } else {\n            NotificationsActions.error(\n              'Ocurrió un error al cancelar la factura'\n            )\n            this.setState({ cancelInProgress: false })\n          }\n\n          break\n      }\n    }, INTERVAL)\n  }\n\n  downloadFile (format) {\n    const { id } = this.props.params\n    let apiCall\n    switch (format) {\n      case 'xml':\n        apiCall = API.Invoice.Xml\n        break\n      case 'pdf':\n        apiCall = API.Invoice.Pdf\n        break\n    }\n    this.setState({ requestInProgress: true }, () => {\n      apiCall(id)\n        .then(r => {\n          if (typeof r[format] !== 'undefined') {\n            fileDownload(r[format], `factura-${r.uuid || 'enconta'}.${format}`)\n            NotificationsActions.success('Archivo guardado')\n          }\n          this.setState({ requestInProgress: false })\n        })\n        .catch(error => {\n          AppSignal.sendError(error)\n          NotificationsActions.error('El archivo no pudo descargarse')\n          this.setState({ requestInProgress: false })\n        })\n    })\n  }\n\n  renderCancelButton () {\n    let renderCancelButton = null\n    const { version } = this.state[INVOICE_KEY]\n    if (version === '3.2' || version === '3.3') {\n      const disabledButton =\n        this.state[INVOICE_KEY][PAC_REFERENCE] === null ||\n        this.state[INVOICE_KEY]['cancelled_at'] !== null\n\n      const isInvoice = this.state[INVOICE_KEY][TYPE_KEY] === 0\n      const isExpensePayroll =\n        this.state[INVOICE_KEY][TYPE_KEY] === 1 &&\n        this.state[INVOICE_KEY].payroll\n\n      renderCancelButton = (\n        <React.Fragment>\n          {(isInvoice || isExpensePayroll) && (\n            <Button\n              icon='repeat'\n              buttonStyle={disabledButton ? '' : 'danger'}\n              loading={this.state.cancelInProgress}\n              onClick={() => this.cancelInvoice(true)}\n              disabled={disabledButton}\n            >\n              Cancelar Factura y Reemitir\n            </Button>\n          )}\n          <Button\n            icon='cancel'\n            buttonStyle={disabledButton ? '' : 'danger'}\n            loading={this.state.cancelInProgress}\n            onClick={() => this.cancelInvoice(false)}\n            disabled={disabledButton}\n          >\n            Cancelar Factura\n          </Button>\n        </React.Fragment>\n      )\n    }\n    return renderCancelButton\n  }\n\n  renderActions () {\n    const { remainingSendEmails, updatePlanModal } = this.state\n    const noMoreMails = remainingSendEmails === 0\n    return (\n      <div>\n        <div className='columns'>\n          <div className='column flex-end'>\n            {this.renderCancelButton()}\n            <Button\n              buttonStyle='primary'\n              icon='email'\n              onClick={\n                noMoreMails\n                  ? () =>\n                    toggleUpdatePlanModal(\n                      this,\n                      updatePlanModal,\n                      'correos para enviar'\n                    )\n                  : () => this.toggleMailModal()\n              }\n            >\n              Enviar por Correo\n            </Button>\n          </div>\n        </div>\n      </div>\n    )\n  }\n\n  getInvoiceType () {\n    let type = ''\n    let subtype = ''\n    if (!_isNil(this.state[INVOICE_KEY][TYPE_KEY])) {\n      type = ENCONTA_INVOICE_TYPE[this.state[INVOICE_KEY][TYPE_KEY]].label\n    }\n    if (!_isNil(this.state[INVOICE_KEY][SUBTYPE_KEY])) {\n      const KEY = this.state[INVOICE_KEY][SUBTYPE_KEY]\n      subtype = ENCONTA_INVOICE_SUBTYPE[KEY].label.toLowerCase()\n    }\n    return `${type} ${subtype}`\n  }\n\n  renderCancelledInvoice () {\n    return (\n      this.state[INVOICE_KEY]['cancelled_at'] &&\n      this.state[INVOICE_KEY]['cancelled_at'] !== null && (\n        <h2 className='kinda-notification error'>\n          Factura Cancelada el{' '}\n          {prettyDate(this.state[INVOICE_KEY]['cancelled_at'])}\n        </h2>\n      )\n    )\n  }\n\n  downloadPDF = () => {\n    RestrictionsActions.downloadPDF()\n  }\n\n  render () {\n    const {\n      requestInProgress,\n      remainingPdfDownloads,\n      showBanner,\n      remainingSendEmails,\n      showBannerEmail,\n      showBannerModal,\n      updatePlanModal\n    } = this.state\n    let invoice = this.state[INVOICE_KEY]\n    const isValidVersion = invoice.version === '3.3' && invoice[TYPE_KEY] === 0\n    const isExpensePayroll = invoice[TYPE_KEY] === 1 && invoice.payroll\n    const isComplementVoucher = invoice.voucher_type === 'p'\n    const entityId = AppStorage.getCurrentEntity().id\n    const disabledButton = !invoice.digital_tax_stamp\n    if (requestInProgress) {\n      return <Loading />\n    }\n    pluralize.addPluralRule('queda', 'quedan')\n    const buttonInvoicesText = `Te ${pluralize(\n      'queda',\n      remainingPdfDownloads\n    )} ${remainingPdfDownloads} PDF para descargar.`\n\n    const buttonEmailText = `Te ${pluralize(\n      'queda',\n      remainingSendEmails\n    )} ${remainingSendEmails} correos para enviar.`\n    const { sawPdfBanner, showEmailBanner } = windowGlobal.localStorage\n\n    const plan = getClientsPlan()\n    const showPdfCounter =\n      plan === 'free' && sawPdfBanner !== 'seen' && showBanner\n    const showEmailCounter =\n      plan === 'free' && showEmailBanner !== 'seen' && showBannerEmail\n    const noMorePDF = remainingPdfDownloads === 0\n    return (\n      <Fragment>\n        <div className='flex-between'>\n          <h1 className='headline'>\n            {!isComplementVoucher\n              ? this.getInvoiceType()\n              : 'Complemento de pago'}\n          </h1>\n          <div>\n            {(isValidVersion || isExpensePayroll) && (\n              <Link\n                style={{ marginRight: '0.5rem' }}\n                to={`/${\n                  isExpensePayroll ? 'facturas_de_nomina' : 'facturas'\n                }/nueva?invoice=${invoice.id}`}\n              >\n                <Button buttonStyle='white' icon='repeat'>\n                  Reemitir\n                </Button>\n              </Link>\n            )}\n            {noMorePDF ? (\n              <Button\n                buttonStyle='white'\n                icon='file-pdf'\n                disabled={disabledButton}\n                onClick={() =>\n                  toggleUpdatePlanModal(\n                    this,\n                    updatePlanModal,\n                    'descargas de PDF'\n                  )\n                }\n              >\n                Descargar PDF\n              </Button>\n            ) : (\n              <a\n                style={{ marginRight: '0.5rem' }}\n                href={`${process.env.API_SERVER}${process.env.API_PREFIX}/pdfs/${this.props.params.id}/${entityId}`}\n                download\n              >\n                <Button\n                  buttonStyle='white'\n                  icon='file-pdf'\n                  disabled={disabledButton}\n                  onClick={() => this.downloadPDF()}\n                >\n                  Descargar PDF\n                </Button>\n              </a>\n            )}\n\n            <Button\n              buttonStyle='white'\n              icon='file-xml'\n              disabled={!invoice.digital_tax_stamp}\n              onClick={this.downloadFile.bind(this, 'xml')}\n              loading={this.state.requestInProgress}\n            >\n              Descargar XML\n            </Button>\n          </div>\n        </div>\n        <Card>\n          {this.renderCancelledInvoice()}\n          {showPdfCounter && (\n            <Banner\n              color={'blue'}\n              buttonText={'Mejora tu plan'}\n              text={buttonInvoicesText}\n              controlBanner={() =>\n                toggleBanner(this, showBanner, 'sawPdfBanner')\n              }\n              bannerAction={() => toggleBannerModal(this, showBannerModal)}\n            />\n          )}\n          <div className='columns'>\n            <Issuer invoice={invoice} />\n            <Recipient invoice={invoice} />\n          </div>\n          <div className='columns'>\n            <Details invoice={invoice} />\n            {!isComplementVoucher && (\n              <Payments\n                invoice={invoice}\n                toggleModal={this.togglePaymentModal.bind(this)}\n                getInvoice={this.getInvoice.bind(this)}\n              />\n            )}\n          </div>\n          {showEmailCounter && (\n            <Banner\n              color={'blue'}\n              buttonText={'Mejora tu plan'}\n              text={buttonEmailText}\n              controlBanner={() =>\n                toggleBanner(this, showBannerEmail, 'showEmailBanner')\n              }\n              bannerAction={() => toggleBannerModal(this, showBannerModal)}\n            />\n          )}\n          <div className='columns'>\n            {!isComplementVoucher ? (\n              <div className='is-fullwidth'>\n                {invoice.payroll ? (\n                  <PayrollConcepts invoice={invoice} />\n                ) : (\n                  <Concepts invoice={invoice} />\n                )}\n              </div>\n            ) : (\n              <PaymentComplement paymentDetails={this.state.paymentDetails} />\n            )}\n          </div>\n          <br />\n          <br />\n          {this.renderActions()}\n        </Card>\n        <PaymentModal\n          isActive={this.state.paymentModalOpen}\n          toggleModal={this.togglePaymentModal.bind(this)}\n          invoice={invoice}\n          paymentId={this.state.paymentId}\n          getInvoice={this.getInvoice.bind(this)}\n        />\n        <MailerModal\n          isActive={this.state.mailModalOpen}\n          toggleModal={this.toggleMailModal.bind(this)}\n          invoice={invoice}\n        />\n        {modalPlans(this)}\n        {modalUpdatePlan(this)}\n      </Fragment>\n    )\n  }\n}\n\nViewInvoice.propTypes = {\n  params: PropTypes.shape({\n    id: PropTypes.string\n  })\n}\n\nexport default ViewInvoice\n"]},"metadata":{},"sourceType":"module"}