{"ast":null,"code":"import _toConsumableArray from \"/Users/usuario-rtd/Desktop/widget-front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _objectSpread from \"/Users/usuario-rtd/Desktop/widget-front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread\";\nimport _classCallCheck from \"/Users/usuario-rtd/Desktop/widget-front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/usuario-rtd/Desktop/widget-front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/usuario-rtd/Desktop/widget-front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/usuario-rtd/Desktop/widget-front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/usuario-rtd/Desktop/widget-front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/Users/usuario-rtd/Desktop/widget-front/src/components/app/views/inventories/products/preview.js\";\n// Libraries\nimport React, { Component } from 'react';\nimport classNames from 'classnames';\nimport { handleURL } from 'utils';\nimport { browserHistory } from 'react-router';\nimport pluralize from 'pluralize'; // Components\n\nimport EmptyState from 'shared/emptyState';\nimport ResultBar from 'shared/resultsBar';\nimport Button from 'shared/button';\nimport IconButton from 'shared/iconButton'; // Stores\n\nimport InventoriesStore from 'stores/inventories'; // Actions\n\nimport NotificationsActions from 'actions/notifications';\nimport InventoriesActions from 'actions/inventories';\n\nvar getCurrentState = function getCurrentState() {\n  return {\n    productsTotal: InventoriesStore.getProductsTotal(),\n    validRecords: InventoriesStore.getValidRecords(),\n    invalidRecords: InventoriesStore.getInvalidRecords(),\n    analyzedProducts: InventoriesStore.getAnalyzedProducts(),\n    productImport: InventoriesStore.getProductImport()\n  };\n};\n\nvar PreviewProducts =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(PreviewProducts, _Component);\n\n  function PreviewProducts() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, PreviewProducts);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(PreviewProducts)).call.apply(_getPrototypeOf2, [this].concat(args)));\n    _this.state = _objectSpread({\n      productsTotal: 0,\n      validRecords: 0,\n      invalidRecords: 0,\n      requestInProgress: false\n    }, getCurrentState());\n\n    _this.toggleRecord = function (row) {\n      _this.setState(function (state) {\n        var analyzedProducts = _toConsumableArray(state.analyzedProducts);\n\n        analyzedProducts.forEach(function (product) {\n          product.isOpen = product.row === row ? !product.isOpen : false;\n        });\n        return {\n          analyzedProducts: analyzedProducts\n        };\n      });\n    };\n\n    _this.buildResultInformation = function () {\n      var _this$state = _this.state,\n          productsTotal = _this$state.productsTotal,\n          validRecords = _this$state.validRecords,\n          invalidRecords = _this$state.invalidRecords;\n      pluralize.addPluralRule('puede', 'pueden');\n      pluralize.addPluralRule('cumple', 'cumplen');\n      pluralize.addPluralRule('registró', 'registraron');\n      return [{\n        icon: 'cube-scan',\n        iconColor: '',\n        text: React.createElement(\"p\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 64\n          },\n          __self: this\n        }, \"Total de \", React.createElement(\"span\", {\n          className: \"is-semibold\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 65\n          },\n          __self: this\n        }, productsTotal), ' ', pluralize('producto', productsTotal))\n      }, {\n        icon: 'check',\n        iconColor: 'result-bar__icon--enconta-dark-green',\n        text: React.createElement(\"p\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 74\n          },\n          __self: this\n        }, React.createElement(\"span\", {\n          className: \"is-semibold\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 75\n          },\n          __self: this\n        }, validRecords), ' ', \"\".concat(pluralize('puede', validRecords), \"\\n             ser \").concat(pluralize('registrado', validRecords)))\n      }, {\n        icon: 'window-close',\n        iconColor: 'result-bar__icon--enconta-aux-red',\n        text: React.createElement(\"p\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 85\n          },\n          __self: this\n        }, React.createElement(\"span\", {\n          className: \"is-semibold\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 86\n          },\n          __self: this\n        }, invalidRecords), ' ', \"no \".concat(pluralize('cumple', invalidRecords), \" los\\n            lineamientos\"))\n      }];\n    };\n\n    _this.saveValidProducts = function () {\n      var _this$state2 = _this.state,\n          validRecords = _this$state2.validRecords,\n          productImport = _this$state2.productImport;\n      var successMessage = \"Se \".concat(pluralize('registró', validRecords), \" \").concat(validRecords, \" \").concat(pluralize('producto', validRecords), \" exitosamente\");\n      InventoriesActions.massivelyInsertProducts(productImport).then(function () {\n        NotificationsActions.success(successMessage);\n\n        _this.setState({\n          requestInProgress: false\n        });\n\n        browserHistory.push('/inventarios/productos');\n      }).catch(function () {\n        NotificationsActions.error('Error al procesar el archivo');\n\n        _this.setState({\n          requestInProgress: false\n        });\n      });\n    };\n\n    _this.renderAccordionInvalidRecords = function () {\n      var analyzedProducts = _this.state.analyzedProducts;\n      return analyzedProducts.map(function (_ref, index) {\n        var row = _ref.row,\n            sku = _ref.sku,\n            name = _ref.name,\n            errors = _ref.errors,\n            isOpen = _ref.isOpen;\n        return React.createElement(\"div\", {\n          className: \"accordion accordion--secondary\",\n          key: index,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 118\n          },\n          __self: this\n        }, React.createElement(\"header\", {\n          className: classNames('accordion--secondary__header', {\n            'accordion--secondary__header--close-header': !isOpen\n          }),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 119\n          },\n          __self: this\n        }, React.createElement(\"div\", {\n          className: \"accordion--secondary__title is-fullwidth\",\n          onClick: function onClick() {\n            return _this.toggleRecord(row);\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 124\n          },\n          __self: this\n        }, React.createElement(\"div\", {\n          className: \"columns is-fullwidth\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 128\n          },\n          __self: this\n        }, React.createElement(\"div\", {\n          className: \"column\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 129\n          },\n          __self: this\n        }, React.createElement(\"p\", {\n          className: \"is-semibold\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 130\n          },\n          __self: this\n        }, name || '---'), React.createElement(\"p\", {\n          className: \"accordion--secondary__sku\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 131\n          },\n          __self: this\n        }, sku || '---')), React.createElement(\"div\", {\n          className: \"column\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 133\n          },\n          __self: this\n        }, React.createElement(\"div\", {\n          className: \"accordion--secondary__excel-line\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 134\n          },\n          __self: this\n        }, React.createElement(\"i\", {\n          className: \"mdi mdi-table-row-height\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 135\n          },\n          __self: this\n        }), React.createElement(\"p\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 136\n          },\n          __self: this\n        }, \"L\\xEDnea \".concat(row)))))), React.createElement(\"div\", {\n          className: \"accordion--secondary__icons\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 141\n          },\n          __self: this\n        }, React.createElement(IconButton, {\n          icon: isOpen ? 'menu-up' : 'menu-down',\n          onClick: function onClick() {\n            return _this.toggleRecord(row);\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 142\n          },\n          __self: this\n        }))), isOpen && React.createElement(\"div\", {\n          className: \"accordion--secondary__body\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 149\n          },\n          __self: this\n        }, React.createElement(\"div\", {\n          className: \"columns\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 150\n          },\n          __self: this\n        }, React.createElement(\"div\", {\n          className: \"column is-narrow\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 151\n          },\n          __self: this\n        }, React.createElement(\"i\", {\n          className: \"mdi mdi-alert-octagon-outline accordion--secondary__icon-error\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 152\n          },\n          __self: this\n        })), React.createElement(\"div\", {\n          className: \"column\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 154\n          },\n          __self: this\n        }, _this.renderErrors(errors)))));\n      });\n    };\n\n    return _this;\n  }\n\n  _createClass(PreviewProducts, [{\n    key: \"renderErrors\",\n    value: function renderErrors(errors) {\n      return errors.map(function (error, index) {\n        return React.createElement(\"p\", {\n          className: \"accordion--secondary__error\",\n          key: index,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 166\n          },\n          __self: this\n        }, error);\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var requestInProgress = this.state.requestInProgress;\n      var resultInformation = this.buildResultInformation();\n      var invalidRecords = this.state.invalidRecords;\n      return React.createElement(\"div\", {\n        className: \"columns is-centered\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 178\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"column is-10\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 179\n        },\n        __self: this\n      }, React.createElement(\"p\", {\n        className: \"body\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 180\n        },\n        __self: this\n      }, \"Terminamos de procesar tu Excel y encontramos lo siguiente:\"), React.createElement(ResultBar, {\n        resultInformation: resultInformation,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 183\n        },\n        __self: this\n      }), invalidRecords > 0 ? this.renderAccordionInvalidRecords() : React.createElement(EmptyState, {\n        icon: 'file-check',\n        style: \"secondary\",\n        mainText: 'No se encontraron errores en el archivo',\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 187\n        },\n        __self: this\n      }), React.createElement(\"div\", {\n        className: classNames('buttons-bar', {\n          'buttons-bar--aligned-center': invalidRecords === 0\n        }),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 194\n        },\n        __self: this\n      }, React.createElement(Button, {\n        icon: \"cancel\",\n        onClick: function onClick() {\n          return handleURL('/inventarios/productos/agregar-varios');\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 199\n        },\n        __self: this\n      }, \"Cancelar registro\"), React.createElement(Button, {\n        buttonStyle: \"primary\",\n        icon: \"content-save\",\n        onClick: this.saveValidProducts,\n        loading: requestInProgress,\n        disabled: requestInProgress,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 205\n        },\n        __self: this\n      }, \"Guardar aprobados\"))));\n    }\n  }]);\n\n  return PreviewProducts;\n}(Component);\n\nexport { PreviewProducts as default };","map":{"version":3,"sources":["/Users/usuario-rtd/Desktop/widget-front/src/components/app/views/inventories/products/preview.js"],"names":["React","Component","classNames","handleURL","browserHistory","pluralize","EmptyState","ResultBar","Button","IconButton","InventoriesStore","NotificationsActions","InventoriesActions","getCurrentState","productsTotal","getProductsTotal","validRecords","getValidRecords","invalidRecords","getInvalidRecords","analyzedProducts","getAnalyzedProducts","productImport","getProductImport","PreviewProducts","state","requestInProgress","toggleRecord","row","setState","forEach","product","isOpen","buildResultInformation","addPluralRule","icon","iconColor","text","saveValidProducts","successMessage","massivelyInsertProducts","then","success","push","catch","error","renderAccordionInvalidRecords","map","index","sku","name","errors","renderErrors","resultInformation"],"mappings":"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","sourcesContent":["// Libraries\nimport React, { Component } from 'react'\nimport classNames from 'classnames'\nimport { handleURL } from 'utils'\nimport { browserHistory } from 'react-router'\nimport pluralize from 'pluralize'\n\n// Components\nimport EmptyState from 'shared/emptyState'\nimport ResultBar from 'shared/resultsBar'\nimport Button from 'shared/button'\nimport IconButton from 'shared/iconButton'\n\n// Stores\nimport InventoriesStore from 'stores/inventories'\n\n// Actions\nimport NotificationsActions from 'actions/notifications'\nimport InventoriesActions from 'actions/inventories'\n\nconst getCurrentState = () => {\n  return {\n    productsTotal: InventoriesStore.getProductsTotal(),\n    validRecords: InventoriesStore.getValidRecords(),\n    invalidRecords: InventoriesStore.getInvalidRecords(),\n    analyzedProducts: InventoriesStore.getAnalyzedProducts(),\n    productImport: InventoriesStore.getProductImport()\n  }\n}\nexport default class PreviewProducts extends Component {\n  state = {\n    productsTotal: 0,\n    validRecords: 0,\n    invalidRecords: 0,\n    requestInProgress: false,\n    ...getCurrentState()\n  }\n\n  toggleRecord = row => {\n    this.setState(state => {\n      const analyzedProducts = [...state.analyzedProducts]\n\n      analyzedProducts.forEach(product => {\n        product.isOpen = product.row === row ? !product.isOpen : false\n      })\n\n      return {\n        analyzedProducts: analyzedProducts\n      }\n    })\n  }\n\n  buildResultInformation = () => {\n    const { productsTotal, validRecords, invalidRecords } = this.state\n    pluralize.addPluralRule('puede', 'pueden')\n    pluralize.addPluralRule('cumple', 'cumplen')\n    pluralize.addPluralRule('registró', 'registraron')\n\n    return [\n      {\n        icon: 'cube-scan',\n        iconColor: '',\n        text: (\n          <p>\n            Total de <span className='is-semibold'>{productsTotal}</span>{' '}\n            {pluralize('producto', productsTotal)}\n          </p>\n        )\n      },\n      {\n        icon: 'check',\n        iconColor: 'result-bar__icon--enconta-dark-green',\n        text: (\n          <p>\n            <span className='is-semibold'>{validRecords}</span>{' '}\n            {`${pluralize('puede', validRecords)}\n             ser ${pluralize('registrado', validRecords)}`}\n          </p>\n        )\n      },\n      {\n        icon: 'window-close',\n        iconColor: 'result-bar__icon--enconta-aux-red',\n        text: (\n          <p>\n            <span className='is-semibold'>{invalidRecords}</span>{' '}\n            {`no ${pluralize('cumple', invalidRecords)} los\n            lineamientos`}\n          </p>\n        )\n      }\n    ]\n  }\n\n  saveValidProducts = () => {\n    const { validRecords, productImport } = this.state\n    const successMessage = `Se ${pluralize(\n      'registró',\n      validRecords\n    )} ${validRecords} ${pluralize('producto', validRecords)} exitosamente`\n    InventoriesActions.massivelyInsertProducts(productImport)\n      .then(() => {\n        NotificationsActions.success(successMessage)\n        this.setState({ requestInProgress: false })\n        browserHistory.push('/inventarios/productos')\n      })\n      .catch(() => {\n        NotificationsActions.error('Error al procesar el archivo')\n        this.setState({ requestInProgress: false })\n      })\n  }\n\n  renderAccordionInvalidRecords = () => {\n    const { analyzedProducts } = this.state\n\n    return analyzedProducts.map(({ row, sku, name, errors, isOpen }, index) => {\n      return (\n        <div className='accordion accordion--secondary' key={index}>\n          <header\n            className={classNames('accordion--secondary__header', {\n              'accordion--secondary__header--close-header': !isOpen\n            })}\n          >\n            <div\n              className='accordion--secondary__title is-fullwidth'\n              onClick={() => this.toggleRecord(row)}\n            >\n              <div className='columns is-fullwidth'>\n                <div className='column'>\n                  <p className='is-semibold'>{name || '---'}</p>\n                  <p className='accordion--secondary__sku'>{sku || '---'}</p>\n                </div>\n                <div className='column'>\n                  <div className='accordion--secondary__excel-line'>\n                    <i className='mdi mdi-table-row-height' />\n                    <p>{`Línea ${row}`}</p>\n                  </div>\n                </div>\n              </div>\n            </div>\n            <div className='accordion--secondary__icons'>\n              <IconButton\n                icon={isOpen ? 'menu-up' : 'menu-down'}\n                onClick={() => this.toggleRecord(row)}\n              />\n            </div>\n          </header>\n          {isOpen && (\n            <div className='accordion--secondary__body'>\n              <div className='columns'>\n                <div className='column is-narrow'>\n                  <i className='mdi mdi-alert-octagon-outline accordion--secondary__icon-error' />\n                </div>\n                <div className='column'>{this.renderErrors(errors)}</div>\n              </div>\n            </div>\n          )}\n        </div>\n      )\n    })\n  }\n\n  renderErrors (errors) {\n    return errors.map((error, index) => {\n      return (\n        <p className='accordion--secondary__error' key={index}>\n          {error}\n        </p>\n      )\n    })\n  }\n\n  render () {\n    const { requestInProgress } = this.state\n    const resultInformation = this.buildResultInformation()\n    const { invalidRecords } = this.state\n    return (\n      <div className='columns is-centered'>\n        <div className='column is-10'>\n          <p className='body'>\n            Terminamos de procesar tu Excel y encontramos lo siguiente:\n          </p>\n          <ResultBar resultInformation={resultInformation} />\n          {invalidRecords > 0 ? (\n            this.renderAccordionInvalidRecords()\n          ) : (\n            <EmptyState\n              icon={'file-check'}\n              style='secondary'\n              mainText={'No se encontraron errores en el archivo'}\n            />\n          )}\n\n          <div\n            className={classNames('buttons-bar', {\n              'buttons-bar--aligned-center': invalidRecords === 0\n            })}\n          >\n            <Button\n              icon='cancel'\n              onClick={() => handleURL('/inventarios/productos/agregar-varios')}\n            >\n              Cancelar registro\n            </Button>\n            <Button\n              buttonStyle='primary'\n              icon='content-save'\n              onClick={this.saveValidProducts}\n              loading={requestInProgress}\n              disabled={requestInProgress}\n            >\n              Guardar aprobados\n            </Button>\n          </div>\n        </div>\n      </div>\n    )\n  }\n}\n"]},"metadata":{},"sourceType":"module"}