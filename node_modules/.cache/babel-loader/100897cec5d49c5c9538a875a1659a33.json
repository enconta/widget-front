{"ast":null,"code":"import _toConsumableArray from \"/Users/usuario-rtd/Desktop/widget-front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _defineProperty from \"/Users/usuario-rtd/Desktop/widget-front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _classCallCheck from \"/Users/usuario-rtd/Desktop/widget-front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/usuario-rtd/Desktop/widget-front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/usuario-rtd/Desktop/widget-front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/usuario-rtd/Desktop/widget-front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/usuario-rtd/Desktop/widget-front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/Users/usuario-rtd/Desktop/widget-front/src/components/app/views/newInvoice/complementos/ine/campaign/state/index.js\";\n// Libraries\nimport React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport update from 'immutability-helper';\nimport uuid from 'uuid'; // Components\n\nimport Button from 'shared/button';\nimport { STATE_LIST } from 'shared/catalogs';\nimport TextField from 'shared/textField';\nimport SelectField from 'shared/selectField';\nvar STATE_OPTIONS = STATE_LIST.filter(function (i) {\n  return i.country === 'MEX';\n}); // Campaign Keys\n\nvar STATE_TAX_IDS_KEY = 'accounting_id';\nvar STATE_ID_KEY = 'entity_key';\nvar STATE_SCOPE_KEY = 'ambit';\nvar TAX_ID_WRAPPER_KEY = 'ine_accounting_mgs';\nvar STATE_SCOPES = [{\n  id: 'Local',\n  label: 'Local'\n}, {\n  id: 'Federal',\n  label: 'Federal'\n}];\nvar TAX_IDS_MAX = 1000;\nvar TAX_IDS_MIN = 1;\nvar requiredFields = new Set();\n\nvar CampaignState =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(CampaignState, _Component);\n\n  function CampaignState(props) {\n    var _this$data;\n\n    var _this;\n\n    _classCallCheck(this, CampaignState);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(CampaignState).call(this, props));\n    _this.data = (_this$data = {\n      uuid: uuid()\n    }, _defineProperty(_this$data, STATE_ID_KEY, STATE_OPTIONS[0].state), _defineProperty(_this$data, STATE_SCOPE_KEY, STATE_SCOPES[0].id), _defineProperty(_this$data, STATE_TAX_IDS_KEY, ['']), _this$data);\n    _this.state = Object.assign({}, _this.data);\n    return _this;\n  }\n\n  _createClass(CampaignState, [{\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      // Clears the stored requiredFields\n      requiredFields.clear();\n    } // Iterates over required fields and validates every one of them\n    // Then it returns true if all validations succeedeed, else false.\n\n  }, {\n    key: \"validateRequiredFields\",\n    value: function validateRequiredFields() {\n      return _toConsumableArray(requiredFields) // Converts the Set() into an array\n      .filter(Boolean) // Filters the array from any falsy value\n      .map(function (form) {\n        return form.validate();\n      }) // Calls the validate() method on each form\n      .every(function (e) {\n        return e;\n      }); // Checks if all validations suceeded\n    } // Handle changes to input fields in state\n\n  }, {\n    key: \"onChange\",\n    value: function onChange(field, e) {\n      this.setState(_defineProperty({}, field, e.target.value));\n    } // Handle changes to specific tax id\n\n  }, {\n    key: \"onChangeTaxId\",\n    value: function onChangeTaxId(pos, e) {\n      this.setState(_defineProperty({}, STATE_TAX_IDS_KEY, update(this.state[STATE_TAX_IDS_KEY], _defineProperty({}, pos, {\n        $set: e.target.value\n      }))));\n    } // Make inner data available to parent\n\n  }, {\n    key: \"exportData\",\n    value: function exportData() {\n      if (this.validateRequiredFields()) {\n        var _ref2;\n\n        return _ref2 = {}, _defineProperty(_ref2, STATE_ID_KEY, this.state[STATE_ID_KEY]), _defineProperty(_ref2, STATE_SCOPE_KEY, this.state[STATE_SCOPE_KEY]), _defineProperty(_ref2, TAX_ID_WRAPPER_KEY, this.state[STATE_TAX_IDS_KEY].map(function (tax) {\n          return _defineProperty({}, STATE_TAX_IDS_KEY, tax);\n        })), _ref2;\n      }\n\n      return null;\n    } // Render delete button if there's at least STATES_MIN states\n\n  }, {\n    key: \"renderDeleteButton\",\n    value: function renderDeleteButton(pos) {\n      return this.state[STATE_TAX_IDS_KEY].length > TAX_IDS_MIN ? React.createElement(\"span\", {\n        className: \"icon info-icon\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 89\n        },\n        __self: this\n      }, React.createElement(\"span\", {\n        className: \"tooltip\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 90\n        },\n        __self: this\n      }, \"Eliminar ID de contabilidad\"), React.createElement(\"i\", {\n        className: \"mdi mdi-close-circle\",\n        onClick: this.deleteTaxId.bind(this, pos),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 91\n        },\n        __self: this\n      })) : null;\n    } // Render single tax id\n\n  }, {\n    key: \"renderTaxId\",\n    value: function renderTaxId(tax, pos) {\n      var icon = {\n        icon: 'close-circle',\n        label: 'Eliminar',\n        onClick: this.deleteTaxId.bind(this, pos),\n        disabled: this.state[STATE_TAX_IDS_KEY].length <= TAX_IDS_MIN\n      };\n      return React.createElement(\"div\", {\n        className: \"column is-3\",\n        key: pos,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 108\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"control\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 109\n        },\n        __self: this\n      }, React.createElement(TextField, {\n        label: \"Estado: ID de contabilidad\",\n        value: this.state[STATE_TAX_IDS_KEY][pos],\n        onChange: this.onChangeTaxId.bind(this, pos),\n        type: \"number\",\n        maxLength: 5,\n        required: true,\n        ref: function ref(r) {\n          return requiredFields.add(r);\n        },\n        icon: icon,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 110\n        },\n        __self: this\n      })));\n    } // Remove taxId from campaignState , at least one required\n\n  }, {\n    key: \"deleteTaxId\",\n    value: function deleteTaxId(pos) {\n      var taxIds = this.state[STATE_TAX_IDS_KEY];\n\n      if (taxIds.length > TAX_IDS_MIN) {\n        requiredFields.clear();\n        taxIds.splice(pos, 1);\n        this.setState(_defineProperty({}, STATE_TAX_IDS_KEY, taxIds));\n      }\n    } // Add campaignStates.taxId to this.state[STATES][]\n\n  }, {\n    key: \"addTaxId\",\n    value: function addTaxId() {\n      var taxIds = this.state[STATE_TAX_IDS_KEY];\n      this.setState(_defineProperty({}, STATE_TAX_IDS_KEY, update(taxIds, _defineProperty({}, taxIds.length, {\n        $set: ''\n      }))));\n    } // Render all tax ids\n\n  }, {\n    key: \"renderTaxIds\",\n    value: function renderTaxIds(index) {\n      var _this2 = this;\n\n      return this.state[STATE_TAX_IDS_KEY].length > 0 ? this.state[STATE_TAX_IDS_KEY].map(function (tax, pos) {\n        return _this2.renderTaxId(tax, pos);\n      }) : React.createElement(\"p\", {\n        className: \"column content\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 150\n        },\n        __self: this\n      }, \"No hay IDs de contabilidad\");\n    } // Main render\n\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this$props = this.props,\n          uuid = _this$props.uuid,\n          deletable = _this$props.deletable;\n      var _this$state = this.state,\n          id = _this$state[STATE_ID_KEY],\n          scope = _this$state[STATE_SCOPE_KEY];\n      return React.createElement(\"div\", {\n        key: uuid,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 159\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"columns control\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 160\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"column\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 161\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"control\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 162\n        },\n        __self: this\n      }, React.createElement(SelectField, {\n        label: \"Estado: Clave Entidad\",\n        placeholder: \"Selecciona una opci\\xF3n\",\n        options: STATE_OPTIONS,\n        value: id,\n        onChange: this.onChange.bind(this, STATE_ID_KEY),\n        optionsConfig: {\n          id: 'state',\n          label: 'label'\n        },\n        required: true,\n        ref: function ref(r) {\n          return requiredFields.add(r);\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 163\n        },\n        __self: this\n      }))), React.createElement(\"div\", {\n        className: \"column\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 175\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"control\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 176\n        },\n        __self: this\n      }, React.createElement(SelectField, {\n        label: \"Estado: \\xC1mbito\",\n        placeholder: \"Selecciona una opci\\xF3n\",\n        options: STATE_SCOPES,\n        value: scope,\n        onChange: this.onChange.bind(this, STATE_SCOPE_KEY),\n        required: true,\n        ref: function ref(r) {\n          return requiredFields.add(r);\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 177\n        },\n        __self: this\n      }))), React.createElement(\"div\", {\n        className: \"column\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 188\n        },\n        __self: this\n      }, React.createElement(\"br\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 189\n        },\n        __self: this\n      }), React.createElement(\"div\", {\n        className: \"control\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 190\n        },\n        __self: this\n      }, React.createElement(Button, {\n        buttonStyle: \"link\",\n        icon: \"plus\",\n        onClick: this.addTaxId.bind(this),\n        disabled: this.state[STATE_TAX_IDS_KEY].length >= TAX_IDS_MAX,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 191\n        },\n        __self: this\n      }, \"Agregar ID Contabilidad\")))), React.createElement(\"div\", {\n        className: \"columns is-multiline\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 202\n        },\n        __self: this\n      }, this.renderTaxIds()), React.createElement(Button, {\n        buttonStyle: \"dangerLink\",\n        icon: \"close\",\n        onClick: this.props.deleteState.bind(this, uuid),\n        disabled: !deletable,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 203\n        },\n        __self: this\n      }, \"Eliminar Estado\"), React.createElement(\"hr\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 211\n        },\n        __self: this\n      }));\n    }\n  }]);\n\n  return CampaignState;\n}(Component);\n\nCampaignState.propTypes = {\n  uuid: PropTypes.string,\n  deletable: PropTypes.bool,\n  deleteState: PropTypes.func\n};\nexport default CampaignState;","map":{"version":3,"sources":["/Users/usuario-rtd/Desktop/widget-front/src/components/app/views/newInvoice/complementos/ine/campaign/state/index.js"],"names":["React","Component","PropTypes","update","uuid","Button","STATE_LIST","TextField","SelectField","STATE_OPTIONS","filter","i","country","STATE_TAX_IDS_KEY","STATE_ID_KEY","STATE_SCOPE_KEY","TAX_ID_WRAPPER_KEY","STATE_SCOPES","id","label","TAX_IDS_MAX","TAX_IDS_MIN","requiredFields","Set","CampaignState","props","data","state","Object","assign","clear","Boolean","map","form","validate","every","e","field","setState","target","value","pos","$set","validateRequiredFields","tax","length","deleteTaxId","bind","icon","onClick","disabled","onChangeTaxId","r","add","taxIds","splice","index","renderTaxId","deletable","scope","onChange","addTaxId","renderTaxIds","deleteState","propTypes","string","bool","func"],"mappings":"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","sourcesContent":["// Libraries\nimport React, { Component } from 'react'\nimport PropTypes from 'prop-types'\nimport update from 'immutability-helper'\nimport uuid from 'uuid'\n\n// Components\nimport Button from 'shared/button'\nimport { STATE_LIST } from 'shared/catalogs'\nimport TextField from 'shared/textField'\nimport SelectField from 'shared/selectField'\n\nconst STATE_OPTIONS = STATE_LIST.filter(i => i.country === 'MEX')\n\n// Campaign Keys\nconst STATE_TAX_IDS_KEY = 'accounting_id'\nconst STATE_ID_KEY = 'entity_key'\nconst STATE_SCOPE_KEY = 'ambit'\nconst TAX_ID_WRAPPER_KEY = 'ine_accounting_mgs'\n\nconst STATE_SCOPES = [\n  { id: 'Local', label: 'Local' },\n  { id: 'Federal', label: 'Federal' }\n]\n\nconst TAX_IDS_MAX = 1000\nconst TAX_IDS_MIN = 1\n\nconst requiredFields = new Set()\n\nclass CampaignState extends Component {\n  constructor (props) {\n    super(props)\n    this.data = {\n      uuid: uuid(),\n      [STATE_ID_KEY]: STATE_OPTIONS[0].state,\n      [STATE_SCOPE_KEY]: STATE_SCOPES[0].id,\n      [STATE_TAX_IDS_KEY]: ['']\n    }\n    this.state = Object.assign({}, this.data)\n  }\n\n  componentWillUnmount () {\n    // Clears the stored requiredFields\n    requiredFields.clear()\n  }\n\n  // Iterates over required fields and validates every one of them\n  // Then it returns true if all validations succeedeed, else false.\n  validateRequiredFields () {\n    return [...requiredFields] // Converts the Set() into an array\n      .filter(Boolean) // Filters the array from any falsy value\n      .map(form => form.validate()) // Calls the validate() method on each form\n      .every(e => e) // Checks if all validations suceeded\n  }\n\n  // Handle changes to input fields in state\n  onChange (field, e) {\n    this.setState({ [field]: e.target.value })\n  }\n\n  // Handle changes to specific tax id\n  onChangeTaxId (pos, e) {\n    this.setState({\n      [STATE_TAX_IDS_KEY]: update(this.state[STATE_TAX_IDS_KEY], {\n        [pos]: { $set: e.target.value }\n      })\n    })\n  }\n\n  // Make inner data available to parent\n  exportData () {\n    if (this.validateRequiredFields()) {\n      return {\n        [STATE_ID_KEY]: this.state[STATE_ID_KEY],\n        [STATE_SCOPE_KEY]: this.state[STATE_SCOPE_KEY],\n        [TAX_ID_WRAPPER_KEY]: this.state[STATE_TAX_IDS_KEY].map(tax => ({\n          [STATE_TAX_IDS_KEY]: tax\n        }))\n      }\n    }\n\n    return null\n  }\n\n  // Render delete button if there's at least STATES_MIN states\n  renderDeleteButton (pos) {\n    return this.state[STATE_TAX_IDS_KEY].length > TAX_IDS_MIN ? (\n      <span className='icon info-icon'>\n        <span className='tooltip'>Eliminar ID de contabilidad</span>\n        <i\n          className='mdi mdi-close-circle'\n          onClick={this.deleteTaxId.bind(this, pos)}\n        />\n      </span>\n    ) : null\n  }\n\n  // Render single tax id\n  renderTaxId (tax, pos) {\n    let icon = {\n      icon: 'close-circle',\n      label: 'Eliminar',\n      onClick: this.deleteTaxId.bind(this, pos),\n      disabled: this.state[STATE_TAX_IDS_KEY].length <= TAX_IDS_MIN\n    }\n    return (\n      <div className='column is-3' key={pos}>\n        <div className='control'>\n          <TextField\n            label='Estado: ID de contabilidad'\n            value={this.state[STATE_TAX_IDS_KEY][pos]}\n            onChange={this.onChangeTaxId.bind(this, pos)}\n            type='number'\n            maxLength={5}\n            required\n            ref={r => requiredFields.add(r)}\n            icon={icon}\n          />\n        </div>\n      </div>\n    )\n  }\n\n  // Remove taxId from campaignState , at least one required\n  deleteTaxId (pos) {\n    let { [STATE_TAX_IDS_KEY]: taxIds } = this.state\n    if (taxIds.length > TAX_IDS_MIN) {\n      requiredFields.clear()\n      taxIds.splice(pos, 1)\n      this.setState({ [STATE_TAX_IDS_KEY]: taxIds })\n    }\n  }\n\n  // Add campaignStates.taxId to this.state[STATES][]\n  addTaxId () {\n    let { [STATE_TAX_IDS_KEY]: taxIds } = this.state\n    this.setState({\n      [STATE_TAX_IDS_KEY]: update(taxIds, { [taxIds.length]: { $set: '' } })\n    })\n  }\n\n  // Render all tax ids\n  renderTaxIds (index) {\n    return this.state[STATE_TAX_IDS_KEY].length > 0 ? (\n      this.state[STATE_TAX_IDS_KEY].map((tax, pos) =>\n        this.renderTaxId(tax, pos)\n      )\n    ) : (\n      <p className='column content'>No hay IDs de contabilidad</p>\n    )\n  }\n\n  // Main render\n  render () {\n    let { uuid, deletable } = this.props\n    let { [STATE_ID_KEY]: id, [STATE_SCOPE_KEY]: scope } = this.state\n    return (\n      <div key={uuid}>\n        <div className='columns control'>\n          <div className='column'>\n            <div className='control'>\n              <SelectField\n                label='Estado: Clave Entidad'\n                placeholder='Selecciona una opción'\n                options={STATE_OPTIONS}\n                value={id}\n                onChange={this.onChange.bind(this, STATE_ID_KEY)}\n                optionsConfig={{ id: 'state', label: 'label' }}\n                required\n                ref={r => requiredFields.add(r)}\n              />\n            </div>\n          </div>\n          <div className='column'>\n            <div className='control'>\n              <SelectField\n                label='Estado: Ámbito'\n                placeholder='Selecciona una opción'\n                options={STATE_SCOPES}\n                value={scope}\n                onChange={this.onChange.bind(this, STATE_SCOPE_KEY)}\n                required\n                ref={r => requiredFields.add(r)}\n              />\n            </div>\n          </div>\n          <div className='column'>\n            <br />\n            <div className='control'>\n              <Button\n                buttonStyle='link'\n                icon='plus'\n                onClick={this.addTaxId.bind(this)}\n                disabled={this.state[STATE_TAX_IDS_KEY].length >= TAX_IDS_MAX}\n              >\n                Agregar ID Contabilidad\n              </Button>\n            </div>\n          </div>\n        </div>\n        <div className='columns is-multiline'>{this.renderTaxIds()}</div>\n        <Button\n          buttonStyle='dangerLink'\n          icon='close'\n          onClick={this.props.deleteState.bind(this, uuid)}\n          disabled={!deletable}\n        >\n          Eliminar Estado\n        </Button>\n        <hr />\n      </div>\n    )\n  }\n}\n\nCampaignState.propTypes = {\n  uuid: PropTypes.string,\n  deletable: PropTypes.bool,\n  deleteState: PropTypes.func\n}\n\nexport default CampaignState\n"]},"metadata":{},"sourceType":"module"}