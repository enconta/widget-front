{"ast":null,"code":"import _defineProperty from \"/Users/usuario-rtd/Desktop/widget-front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _classCallCheck from \"/Users/usuario-rtd/Desktop/widget-front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/usuario-rtd/Desktop/widget-front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/usuario-rtd/Desktop/widget-front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/usuario-rtd/Desktop/widget-front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/usuario-rtd/Desktop/widget-front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _regeneratorRuntime from \"/Users/usuario-rtd/Desktop/widget-front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/usuario-rtd/Desktop/widget-front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nvar _jsxFileName = \"/Users/usuario-rtd/Desktop/widget-front/src/components/app/views/documents/view/index.js\";\n\n/* global  fetch, Blob */\n// Libraries\nimport React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport { Link } from 'react-router';\nimport VerEx from 'verbal-expressions';\nimport AppSignal from 'appsignal'; // Components\n\nimport Button from 'shared/button';\nimport Card from 'shared/card';\nimport { prettyPeriod, prettyDate } from 'utils';\nimport API from 'api';\nimport NotificationsActions from 'actions/notifications'; // Constants\n\nvar DOCUMENT_KEY = 'regular_document';\nvar verex = VerEx().find('?').anythingBut(''); // Define the regex to find everything after the '?' (including the '?')\n\nvar imageEx = VerEx() // Define the regex to verifiy image urls\n.then('http').maybe('s').then('://').maybe('www.').anythingBut(' ').find('.').then('png').or('jpg').or('jpeg').or('gif').withAnyCase(); // Download file of the current url\n// Create new URLobject whit files downloaded\n// Download file of the new url with format csv.\n\nvar downloadCSV =\n/*#__PURE__*/\nfunction () {\n  var _ref = _asyncToGenerator(\n  /*#__PURE__*/\n  _regeneratorRuntime.mark(function _callee(url, name) {\n    var response, data, blob, blobURL, anchor;\n    return _regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            _context.next = 2;\n            return fetch(url);\n\n          case 2:\n            response = _context.sent;\n            _context.next = 5;\n            return response.text();\n\n          case 5:\n            data = _context.sent;\n            blob = new Blob([data], {\n              type: 'data:text/csv;charset=utf-8,'\n            });\n            blobURL = window.URL.createObjectURL(blob); // Create new tag for download file\n\n            anchor = document.createElement('a');\n            anchor.download = name;\n            anchor.href = blobURL;\n            anchor.dataset.downloadurl = ['text/csv', anchor.download, anchor.href].join(':');\n            anchor.click(); // Remove URL.createObjectURL. The browser should not save the reference to the file.\n\n            setTimeout(function () {\n              // For Firefox it is necessary to delay revoking the ObjectURL\n              URL.revokeObjectURL(blobURL);\n            }, 100);\n\n          case 14:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee);\n  }));\n\n  return function downloadCSV(_x, _x2) {\n    return _ref.apply(this, arguments);\n  };\n}();\n\nvar ViewDocument =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(ViewDocument, _Component);\n\n  function ViewDocument() {\n    var _this;\n\n    _classCallCheck(this, ViewDocument);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(ViewDocument).call(this));\n    _this.data = _defineProperty({\n      loadingDocument: true\n    }, DOCUMENT_KEY, {});\n    _this.state = Object.assign({}, _this.data);\n    return _this;\n  } // Load document or return to listing\n\n\n  _createClass(ViewDocument, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this$props = this.props,\n          location = _this$props.location,\n          params = _this$props.params;\n\n      if (location.pathname.includes('/documentos/ver') && typeof params.id !== 'undefined') {\n        this.getDocument(params.id);\n      }\n    } // Get document with documentID from API\n\n  }, {\n    key: \"getDocument\",\n    value: function getDocument(documentId) {\n      var _this2 = this;\n\n      this.setState({\n        loadingDocument: true\n      }, function () {\n        API.Documents.GetDocument(documentId).then(function (r) {\n          var _this2$setState;\n\n          _this2.setState((_this2$setState = {}, _defineProperty(_this2$setState, DOCUMENT_KEY, r[DOCUMENT_KEY]), _defineProperty(_this2$setState, \"loadingDocument\", false), _this2$setState));\n        }).catch(function (error) {\n          AppSignal.sendError(error);\n\n          _this2.setState({\n            loadingDocument: false\n          });\n\n          NotificationsActions.error('Error al obtener documento');\n        });\n      });\n    } // Preview document if document is set\n\n  }, {\n    key: \"renderDocumentViewer\",\n    value: function renderDocumentViewer() {\n      var doc = this.state[DOCUMENT_KEY];\n      var renderDocumentViewer = null;\n\n      if (doc && doc.url && doc.url.length > 0) {\n        var url = verex.replace(doc.url, ''); // Removes from the url everything after the '?' (including the '?')\n\n        renderDocumentViewer = React.createElement(\"div\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 107\n          },\n          __self: this\n        }, React.createElement(\"div\", {\n          className: \"caption\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 108\n          },\n          __self: this\n        }, \"Correspondiente al mes: \", prettyPeriod(doc.date), \"- Generado el:\", ' ', prettyDate(doc.created_at)), React.createElement(\"br\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 112\n          },\n          __self: this\n        }), imageEx.test(url) ? // If the url is an image, render the image, else, render the iframe\n        React.createElement(\"img\", {\n          style: {\n            width: '100%',\n            minHeight: '500px'\n          },\n          src: url,\n          alt: \"factura \".concat(doc.name),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 114\n          },\n          __self: this\n        }) : React.createElement(\"iframe\", {\n          title: doc.name,\n          style: {\n            width: '100%',\n            minHeight: '500px'\n          },\n          src: \"https://docs.google.com/gview?url=\".concat(url, \"&embedded=true\"),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 120\n          },\n          __self: this\n        }));\n      }\n\n      return renderDocumentViewer;\n    } // Render download/back buttons for document\n\n  }, {\n    key: \"renderDocumentActions\",\n    value: function renderDocumentActions() {\n      var doc = this.state[DOCUMENT_KEY];\n      return React.createElement(\"div\", {\n        className: \"field is-grouped\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 137\n        },\n        __self: this\n      }, React.createElement(Link, {\n        to: \"/documentos\",\n        className: \"encontaButton--marginRight\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 138\n        },\n        __self: this\n      }, React.createElement(Button, {\n        icon: \"arrow-left\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 139\n        },\n        __self: this\n      }, \"Regresar\")), doc && doc.file_name && doc.file_name.includes('.csv') ? React.createElement(Button, {\n        buttonStyle: \"primary\",\n        icon: \"download\",\n        onClick: function onClick() {\n          return downloadCSV(doc.url, doc.file_name);\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 142\n        },\n        __self: this\n      }, \"Descargar\") : React.createElement(\"a\", {\n        href: doc.url,\n        download: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 150\n        },\n        __self: this\n      }, React.createElement(Button, {\n        buttonStyle: \"primary\",\n        icon: \"download\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 151\n        },\n        __self: this\n      }, \"Descargar\")));\n    } // Main Render\n\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this$state = this.state,\n          document = _this$state[DOCUMENT_KEY],\n          loadingDocument = _this$state.loadingDocument;\n      if (loadingDocument) return null;\n      return React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 165\n        },\n        __self: this\n      }, React.createElement(\"h5\", {\n        className: \"headline\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 166\n        },\n        __self: this\n      }, \"Ver Documento\"), React.createElement(\"div\", {\n        className: \"columns\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 167\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"column\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 168\n        },\n        __self: this\n      }, React.createElement(Card, {\n        title: document.name,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 169\n        },\n        __self: this\n      }, this.renderDocumentViewer(), this.renderDocumentActions()))));\n    }\n  }]);\n\n  return ViewDocument;\n}(Component);\n\nViewDocument.propTypes = {\n  location: PropTypes.object,\n  params: PropTypes.object\n};\nexport default ViewDocument;","map":{"version":3,"sources":["/Users/usuario-rtd/Desktop/widget-front/src/components/app/views/documents/view/index.js"],"names":["React","Component","PropTypes","Link","VerEx","AppSignal","Button","Card","prettyPeriod","prettyDate","API","NotificationsActions","DOCUMENT_KEY","verex","find","anythingBut","imageEx","then","maybe","or","withAnyCase","downloadCSV","url","name","fetch","response","text","data","blob","Blob","type","blobURL","window","URL","createObjectURL","anchor","document","createElement","download","href","dataset","downloadurl","join","click","setTimeout","revokeObjectURL","ViewDocument","loadingDocument","state","Object","assign","props","location","params","pathname","includes","id","getDocument","documentId","setState","Documents","GetDocument","r","catch","error","sendError","doc","renderDocumentViewer","length","replace","date","created_at","test","width","minHeight","file_name","renderDocumentActions","propTypes","object"],"mappings":"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","sourcesContent":["/* global  fetch, Blob */\n// Libraries\nimport React, { Component } from 'react'\nimport PropTypes from 'prop-types'\nimport { Link } from 'react-router'\nimport VerEx from 'verbal-expressions'\nimport AppSignal from 'appsignal'\n\n// Components\nimport Button from 'shared/button'\nimport Card from 'shared/card'\nimport { prettyPeriod, prettyDate } from 'utils'\nimport API from 'api'\nimport NotificationsActions from 'actions/notifications'\n\n// Constants\nconst DOCUMENT_KEY = 'regular_document'\n\nconst verex = VerEx()\n  .find('?')\n  .anythingBut('') // Define the regex to find everything after the '?' (including the '?')\nconst imageEx = VerEx() // Define the regex to verifiy image urls\n  .then('http')\n  .maybe('s')\n  .then('://')\n  .maybe('www.')\n  .anythingBut(' ')\n  .find('.')\n  .then('png')\n  .or('jpg')\n  .or('jpeg')\n  .or('gif')\n  .withAnyCase()\n\n// Download file of the current url\n// Create new URLobject whit files downloaded\n// Download file of the new url with format csv.\nconst downloadCSV = async (url, name) => {\n  const response = await fetch(url)\n  const data = await response.text()\n  const blob = new Blob([data], { type: 'data:text/csv;charset=utf-8,' })\n  const blobURL = window.URL.createObjectURL(blob)\n\n  // Create new tag for download file\n  const anchor = document.createElement('a')\n  anchor.download = name\n  anchor.href = blobURL\n  anchor.dataset.downloadurl = ['text/csv', anchor.download, anchor.href].join(\n    ':'\n  )\n  anchor.click()\n\n  // Remove URL.createObjectURL. The browser should not save the reference to the file.\n  setTimeout(() => {\n    // For Firefox it is necessary to delay revoking the ObjectURL\n    URL.revokeObjectURL(blobURL)\n  }, 100)\n}\n\nclass ViewDocument extends Component {\n  constructor () {\n    super()\n    this.data = {\n      loadingDocument: true,\n      [DOCUMENT_KEY]: {}\n    }\n    this.state = Object.assign({}, this.data)\n  }\n\n  // Load document or return to listing\n  componentDidMount () {\n    const { location, params } = this.props\n    if (\n      location.pathname.includes('/documentos/ver') &&\n      typeof params.id !== 'undefined'\n    ) {\n      this.getDocument(params.id)\n    }\n  }\n\n  // Get document with documentID from API\n  getDocument (documentId) {\n    this.setState({ loadingDocument: true }, () => {\n      API.Documents.GetDocument(documentId)\n        .then(r => {\n          this.setState({\n            [DOCUMENT_KEY]: r[DOCUMENT_KEY],\n            loadingDocument: false\n          })\n        })\n        .catch(error => {\n          AppSignal.sendError(error)\n          this.setState({ loadingDocument: false })\n          NotificationsActions.error('Error al obtener documento')\n        })\n    })\n  }\n\n  // Preview document if document is set\n  renderDocumentViewer () {\n    const { [DOCUMENT_KEY]: doc } = this.state\n    let renderDocumentViewer = null\n\n    if (doc && doc.url && doc.url.length > 0) {\n      const url = verex.replace(doc.url, '') // Removes from the url everything after the '?' (including the '?')\n      renderDocumentViewer = (\n        <div>\n          <div className='caption'>\n            Correspondiente al mes: {prettyPeriod(doc.date)}- Generado el:{' '}\n            {prettyDate(doc.created_at)}\n          </div>\n          <br />\n          {imageEx.test(url) ? ( // If the url is an image, render the image, else, render the iframe\n            <img\n              style={{ width: '100%', minHeight: '500px' }}\n              src={url}\n              alt={`factura ${doc.name}`}\n            />\n          ) : (\n            <iframe\n              title={doc.name}\n              style={{ width: '100%', minHeight: '500px' }}\n              src={`https://docs.google.com/gview?url=${url}&embedded=true`}\n            />\n          )}\n        </div>\n      )\n    }\n    return renderDocumentViewer\n  }\n\n  // Render download/back buttons for document\n  renderDocumentActions () {\n    const { [DOCUMENT_KEY]: doc } = this.state\n\n    return (\n      <div className='field is-grouped'>\n        <Link to='/documentos' className='encontaButton--marginRight'>\n          <Button icon='arrow-left'>Regresar</Button>\n        </Link>\n        {doc && doc.file_name && doc.file_name.includes('.csv') ? (\n          <Button\n            buttonStyle='primary'\n            icon='download'\n            onClick={() => downloadCSV(doc.url, doc.file_name)}\n          >\n            Descargar\n          </Button>\n        ) : (\n          <a href={doc.url} download>\n            <Button buttonStyle='primary' icon='download'>\n              Descargar\n            </Button>\n          </a>\n        )}\n      </div>\n    )\n  }\n\n  // Main Render\n  render () {\n    const { [DOCUMENT_KEY]: document, loadingDocument } = this.state\n    if (loadingDocument) return null\n    return (\n      <div>\n        <h5 className='headline'>Ver Documento</h5>\n        <div className='columns'>\n          <div className='column'>\n            <Card title={document.name}>\n              {this.renderDocumentViewer()}\n              {this.renderDocumentActions()}\n            </Card>\n          </div>\n        </div>\n      </div>\n    )\n  }\n}\n\nViewDocument.propTypes = {\n  location: PropTypes.object,\n  params: PropTypes.object\n}\n\nexport default ViewDocument\n"]},"metadata":{},"sourceType":"module"}