{"ast":null,"code":"import _regeneratorRuntime from \"/Users/usuario-rtd/Desktop/widget-front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/usuario-rtd/Desktop/widget-front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"/Users/usuario-rtd/Desktop/widget-front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/usuario-rtd/Desktop/widget-front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/usuario-rtd/Desktop/widget-front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/usuario-rtd/Desktop/widget-front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/usuario-rtd/Desktop/widget-front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/Users/usuario-rtd/Desktop/widget-front/src/components/app/views/accountingPeriods/review/components/client.js\";\n// Libraries\nimport React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport moment from 'moment';\nimport { browserHistory } from 'react-router'; // Components\n\nimport { formatCurrency, prettyDate, getMonthLabel } from 'utils';\nimport Button from 'shared/button';\nimport Modal from 'shared/modal';\nimport MessagesActions from 'actions/messages';\nimport NotificationsActions from 'actions/notifications';\nimport { generateMessage } from '../../utils';\n\nvar Client =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(Client, _Component);\n\n  function Client() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, Client);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(Client)).call.apply(_getPrototypeOf2, [this].concat(args)));\n    _this.state = {\n      requestInProgress: false,\n      openModal: false,\n      comments: ''\n    };\n\n    _this.toggleModal = function () {\n      _this.setState({\n        openModal: !_this.state.openModal\n      });\n    };\n\n    _this.onChangeStatus = function (status) {\n      var comments = _this.state.comments;\n      var _this$props = _this.props,\n          calculation = _this$props.calculation,\n          period = _this$props.period,\n          sendCalculation = _this$props.sendCalculation;\n      var currentDate = prettyDate(moment().format('YYYY MM DD'));\n      var comment = status === 'rejected' ? \"\".concat(currentDate, \" / total por pagar $ \").concat(calculation.total_to_pay, \" \\n \").concat(comments) : '';\n      var params = {\n        calculation: {\n          status: status,\n          comments: comment\n        }\n      };\n\n      if (status === 'rejected') {\n        _this.createMessage(period.id, generateMessage(comment));\n      }\n\n      sendCalculation(period, calculation.id, params, status);\n    };\n\n    _this.createMessage =\n    /*#__PURE__*/\n    function () {\n      var _ref = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee(period, messageData) {\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.prev = 0;\n\n                _this.setState({\n                  requestInProgress: true\n                });\n\n                _context.next = 4;\n                return MessagesActions.createMessage({\n                  period: period,\n                  messageData: messageData\n                });\n\n              case 4:\n                _this.setState({\n                  requestInProgress: false\n                });\n\n                _context.next = 11;\n                break;\n\n              case 7:\n                _context.prev = 7;\n                _context.t0 = _context[\"catch\"](0);\n                NotificationsActions.error(_context.t0);\n\n                _this.setState({\n                  requestInProgress: false\n                });\n\n              case 11:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, null, [[0, 7]]);\n      }));\n\n      return function (_x, _x2) {\n        return _ref.apply(this, arguments);\n      };\n    }();\n\n    _this.onChangeComments = function (e) {\n      _this.setState({\n        comments: e.target.value\n      });\n    };\n\n    _this.goToPeriod = function () {\n      var oldestPeriod = _this.props.oldestPeriod;\n      browserHistory.push(\"/mi-contabilidad/\".concat(oldestPeriod.id, \"/ver\"));\n      window.location.reload();\n    };\n\n    return _this;\n  }\n\n  _createClass(Client, [{\n    key: \"render\",\n    // Main render\n    value: function render() {\n      var _this2 = this;\n\n      var _this$props2 = this.props,\n          period = _this$props2.period,\n          calculation = _this$props2.calculation,\n          showButtons = _this$props2.showButtons,\n          oldestPeriod = _this$props2.oldestPeriod;\n      var month = period.month,\n          year = period.year;\n      var isr = calculation.isr,\n          iva = calculation.iva,\n          leaseISR = calculation.lease_isr,\n          salariesISR = calculation.salaries_wages_isr,\n          isrTax = calculation.isr_tax,\n          leaseIsrTax = calculation.lease_isr_tax,\n          withholdIsrTax = calculation.withhold_isr_tax,\n          ivaTax = calculation.iva_tax,\n          total = calculation.total_to_pay;\n      var monthLabel = getMonthLabel(month);\n      var currentStep = period.actual_step;\n      var oldMonth = '';\n\n      if (oldestPeriod) {\n        oldMonth = getMonthLabel(oldestPeriod.month);\n      }\n\n      return React.createElement(\"div\", {\n        className: \"section section--is-small\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 117\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"columns is-centered calculation-information\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 118\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"column is-7\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 119\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"columns is-margin-bottom-less\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 120\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"column is-6\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 121\n        },\n        __self: this\n      }, React.createElement(\"p\", {\n        className: \"calculation-information__label\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 122\n        },\n        __self: this\n      }, \"Ejercicio\")), React.createElement(\"div\", {\n        className: \"column is-6\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 124\n        },\n        __self: this\n      }, React.createElement(\"p\", {\n        className: \"calculation-information__data\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 125\n        },\n        __self: this\n      }, year), ' ')), React.createElement(\"div\", {\n        className: \"columns margin-bottom-28px\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 128\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"column is-6\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 129\n        },\n        __self: this\n      }, React.createElement(\"p\", {\n        className: \"calculation-information__label\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 130\n        },\n        __self: this\n      }, \"Mes de trabajo\")), React.createElement(\"div\", {\n        className: \"column is-6\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 132\n        },\n        __self: this\n      }, React.createElement(\"p\", {\n        className: \"calculation-information__data\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 133\n        },\n        __self: this\n      }, monthLabel))), isr && React.createElement(\"div\", {\n        className: \"columns is-margin-bottom-less\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 137\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"column is-6\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 138\n        },\n        __self: this\n      }, React.createElement(\"p\", {\n        className: \"calculation-information__label\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 139\n        },\n        __self: this\n      }, \"isr\")), React.createElement(\"div\", {\n        className: \"column is-6\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 141\n        },\n        __self: this\n      }, React.createElement(\"p\", {\n        className: \"calculation-information__data\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 142\n        },\n        __self: this\n      }, ' ', formatCurrency(isrTax)))), leaseISR && React.createElement(\"div\", {\n        className: \"columns is-margin-bottom-less\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 150\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"column is-6\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 151\n        },\n        __self: this\n      }, React.createElement(\"p\", {\n        className: \"calculation-information__label\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 152\n        },\n        __self: this\n      }, \"isr Arrendamiento\")), React.createElement(\"div\", {\n        className: \"column is-6\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 156\n        },\n        __self: this\n      }, React.createElement(\"p\", {\n        className: \"calculation-information__data\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 157\n        },\n        __self: this\n      }, ' ', formatCurrency(leaseIsrTax)))), salariesISR && React.createElement(\"div\", {\n        className: \"columns is-margin-bottom-less\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 165\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"column is-6\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 166\n        },\n        __self: this\n      }, React.createElement(\"p\", {\n        className: \"calculation-information__label\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 167\n        },\n        __self: this\n      }, \"isr ret. por sueldos\")), React.createElement(\"div\", {\n        className: \"column is-6\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 171\n        },\n        __self: this\n      }, React.createElement(\"p\", {\n        className: \"calculation-information__data\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 172\n        },\n        __self: this\n      }, ' ', formatCurrency(withholdIsrTax)))), iva && React.createElement(\"div\", {\n        className: \"columns is-margin-bottom-less\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 180\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"column is-6\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 181\n        },\n        __self: this\n      }, React.createElement(\"p\", {\n        className: \"calculation-information__label\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 182\n        },\n        __self: this\n      }, \"iva\", ivaTax < 0 ? ' a favor' : ' por pagar')), React.createElement(\"div\", {\n        className: \"column is-6\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 187\n        },\n        __self: this\n      }, React.createElement(\"p\", {\n        className: \"calculation-information__data\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 188\n        },\n        __self: this\n      }, ' ', formatCurrency(ivaTax)))), React.createElement(\"div\", {\n        className: \"columns is-margin-bottom-less\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 195\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"column is-12\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 196\n        },\n        __self: this\n      }, React.createElement(\"hr\", {\n        className: \"visual-rest visual-rest--margin-16px\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 197\n        },\n        __self: this\n      }))), React.createElement(\"div\", {\n        className: \"columns flex-end\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 200\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"column is-4\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 201\n        },\n        __self: this\n      }, React.createElement(\"p\", {\n        className: \"total-to-pay\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 202\n        },\n        __self: this\n      }, React.createElement(\"span\", {\n        className: \"total-to-pay__amount\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 203\n        },\n        __self: this\n      }, formatCurrency(total)), React.createElement(\"span\", {\n        className: \"total-to-pay__label\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 206\n        },\n        __self: this\n      }, \"Total por pagar\")))))), showButtons && calculation.status === 'reviewed_by_accountant' ? React.createElement(\"div\", {\n        className: \"columns is-centered\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 213\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"column is-8\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 214\n        },\n        __self: this\n      }, React.createElement(\"p\", {\n        className: \"calculation-notification\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 215\n        },\n        __self: this\n      }, React.createElement(\"span\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 216\n        },\n        __self: this\n      }, React.createElement(\"i\", {\n        className: \"mdi mdi-alert-octagon-outline\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 217\n        },\n        __self: this\n      })), \"Para validar este periodo debes revisar y aprobar el perido:\", React.createElement(Button, {\n        buttonStyle: \"link link--blue\",\n        onClick: this.goToPeriod,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 220\n        },\n        __self: this\n      }, \" \".concat(oldMonth, \" \").concat(year, \".\"))))) : currentStep === 'accounting_done' && calculation.status === 'reviewed_by_accountant' && React.createElement(\"div\", {\n        className: \"columns is-centered\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 229\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"column is-7 flex-end\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 230\n        },\n        __self: this\n      }, React.createElement(Button, {\n        onClick: this.toggleModal,\n        loading: this.state.requestInProgress,\n        icon: \"close-circle-outline\",\n        buttonStyle: \"primaryInv\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 231\n        },\n        __self: this\n      }, \"Rechazar\"), React.createElement(Button, {\n        onClick: function onClick() {\n          return _this2.onChangeStatus('accepted');\n        },\n        loading: this.state.requestInProgress,\n        icon: \"check-circle-outline\",\n        buttonStyle: \"primary\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 239\n        },\n        __self: this\n      }, \"Aceptar\"))), React.createElement(Modal, {\n        title: \"\\xBFSeguro quieres rechazar los C\\xE1lculos ?\",\n        isActive: this.state.openModal,\n        toggleModal: this.toggleModal,\n        onSubmit: function onSubmit() {\n          return _this2.onChangeStatus('rejected');\n        },\n        disabled: !this.state.comments,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 251\n        },\n        __self: this\n      }, React.createElement(\"form\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 258\n        },\n        __self: this\n      }, React.createElement(\"label\", {\n        className: \"subtitle\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 259\n        },\n        __self: this\n      }, \"Dile a tu contador por qu\\xE9 rechazas los c\\xE1lculos *\"), React.createElement(\"textarea\", {\n        className: \"textarea\",\n        style: {\n          margin: '1em 0'\n        },\n        value: this.state.comments,\n        onChange: this.onChangeComments,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 262\n        },\n        __self: this\n      }))));\n    }\n  }]);\n\n  return Client;\n}(Component);\n\nClient.propTypes = {\n  period: PropTypes.shape({\n    month: PropTypes.number,\n    year: PropTypes.number,\n    taxable_entity: PropTypes.shape({\n      legal_name: PropTypes.string,\n      rfc: PropTypes.string,\n      tax_classification: PropTypes.string\n    })\n  }),\n  calculation: PropTypes.shape({\n    isr_tax: PropTypes.string,\n    lease_isr_tax: PropTypes.string,\n    withhold_isr_tax: PropTypes.string,\n    iva_tax: PropTypes.string,\n    total_to_pay: PropTypes.string\n  })\n};\nexport { Client as default };","map":{"version":3,"sources":["/Users/usuario-rtd/Desktop/widget-front/src/components/app/views/accountingPeriods/review/components/client.js"],"names":["React","Component","PropTypes","moment","browserHistory","formatCurrency","prettyDate","getMonthLabel","Button","Modal","MessagesActions","NotificationsActions","generateMessage","Client","state","requestInProgress","openModal","comments","toggleModal","setState","onChangeStatus","status","props","calculation","period","sendCalculation","currentDate","format","comment","total_to_pay","params","createMessage","id","messageData","error","onChangeComments","e","target","value","goToPeriod","oldestPeriod","push","window","location","reload","showButtons","month","year","isr","iva","leaseISR","lease_isr","salariesISR","salaries_wages_isr","isrTax","isr_tax","leaseIsrTax","lease_isr_tax","withholdIsrTax","withhold_isr_tax","ivaTax","iva_tax","total","monthLabel","currentStep","actual_step","oldMonth","margin","propTypes","shape","number","taxable_entity","legal_name","string","rfc","tax_classification"],"mappings":"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","sourcesContent":["// Libraries\nimport React, { Component } from 'react'\nimport PropTypes from 'prop-types'\nimport moment from 'moment'\nimport { browserHistory } from 'react-router'\n\n// Components\nimport { formatCurrency, prettyDate, getMonthLabel } from 'utils'\nimport Button from 'shared/button'\nimport Modal from 'shared/modal'\nimport MessagesActions from 'actions/messages'\nimport NotificationsActions from 'actions/notifications'\nimport { generateMessage } from '../../utils'\n\nexport default class Client extends Component {\n  static propTypes = {\n    period: PropTypes.shape({\n      month: PropTypes.number,\n      year: PropTypes.number,\n      taxable_entity: PropTypes.shape({\n        legal_name: PropTypes.string,\n        rfc: PropTypes.string,\n        tax_classification: PropTypes.string\n      })\n    }),\n    calculation: PropTypes.shape({\n      isr_tax: PropTypes.string,\n      lease_isr_tax: PropTypes.string,\n      withhold_isr_tax: PropTypes.string,\n      iva_tax: PropTypes.string,\n      total_to_pay: PropTypes.string\n    })\n  }\n\n  state = {\n    requestInProgress: false,\n    openModal: false,\n    comments: ''\n  }\n\n  // Open modal\n  toggleModal = () => {\n    this.setState({ openModal: !this.state.openModal })\n  }\n\n  onChangeStatus = status => {\n    const { comments } = this.state\n    const { calculation, period, sendCalculation } = this.props\n    const currentDate = prettyDate(moment().format('YYYY MM DD'))\n    const comment =\n      status === 'rejected'\n        ? `${currentDate} / total por pagar $ ${calculation.total_to_pay} \\n ${comments}`\n        : ''\n    const params = {\n      calculation: {\n        status,\n        comments: comment\n      }\n    }\n    if (status === 'rejected') {\n      this.createMessage(period.id, generateMessage(comment))\n    }\n    sendCalculation(period, calculation.id, params, status)\n  }\n\n  // Create messages\n  createMessage = async (period, messageData) => {\n    try {\n      this.setState({ requestInProgress: true })\n      await MessagesActions.createMessage({ period, messageData })\n      this.setState({ requestInProgress: false })\n    } catch (error) {\n      NotificationsActions.error(error)\n      this.setState({ requestInProgress: false })\n    }\n  }\n\n  // update message\n  onChangeComments = e => {\n    this.setState({\n      comments: e.target.value\n    })\n  }\n\n  goToPeriod = () => {\n    const { oldestPeriod } = this.props\n    browserHistory.push(`/mi-contabilidad/${oldestPeriod.id}/ver`)\n    window.location.reload()\n  }\n\n  // Main render\n  render () {\n    const { period, calculation, showButtons, oldestPeriod } = this.props\n    const { month, year } = period\n    const {\n      isr,\n      iva,\n      lease_isr: leaseISR,\n      salaries_wages_isr: salariesISR,\n      isr_tax: isrTax,\n      lease_isr_tax: leaseIsrTax,\n      withhold_isr_tax: withholdIsrTax,\n      iva_tax: ivaTax,\n      total_to_pay: total\n    } = calculation\n\n    const monthLabel = getMonthLabel(month)\n    const { actual_step: currentStep } = period\n\n    let oldMonth = ''\n\n    if (oldestPeriod) {\n      oldMonth = getMonthLabel(oldestPeriod.month)\n    }\n\n    return (\n      <div className='section section--is-small'>\n        <div className='columns is-centered calculation-information'>\n          <div className='column is-7'>\n            <div className='columns is-margin-bottom-less'>\n              <div className='column is-6'>\n                <p className='calculation-information__label'>Ejercicio</p>\n              </div>\n              <div className='column is-6'>\n                <p className='calculation-information__data'>{year}</p>{' '}\n              </div>\n            </div>\n            <div className='columns margin-bottom-28px'>\n              <div className='column is-6'>\n                <p className='calculation-information__label'>Mes de trabajo</p>\n              </div>\n              <div className='column is-6'>\n                <p className='calculation-information__data'>{monthLabel}</p>\n              </div>\n            </div>\n            {isr && (\n              <div className='columns is-margin-bottom-less'>\n                <div className='column is-6'>\n                  <p className='calculation-information__label'>isr</p>\n                </div>\n                <div className='column is-6'>\n                  <p className='calculation-information__data'>\n                    {' '}\n                    {formatCurrency(isrTax)}\n                  </p>\n                </div>\n              </div>\n            )}\n            {leaseISR && (\n              <div className='columns is-margin-bottom-less'>\n                <div className='column is-6'>\n                  <p className='calculation-information__label'>\n                    isr Arrendamiento\n                  </p>\n                </div>\n                <div className='column is-6'>\n                  <p className='calculation-information__data'>\n                    {' '}\n                    {formatCurrency(leaseIsrTax)}\n                  </p>\n                </div>\n              </div>\n            )}\n            {salariesISR && (\n              <div className='columns is-margin-bottom-less'>\n                <div className='column is-6'>\n                  <p className='calculation-information__label'>\n                    isr ret. por sueldos\n                  </p>\n                </div>\n                <div className='column is-6'>\n                  <p className='calculation-information__data'>\n                    {' '}\n                    {formatCurrency(withholdIsrTax)}\n                  </p>\n                </div>\n              </div>\n            )}\n            {iva && (\n              <div className='columns is-margin-bottom-less'>\n                <div className='column is-6'>\n                  <p className='calculation-information__label'>\n                    iva\n                    {ivaTax < 0 ? ' a favor' : ' por pagar'}\n                  </p>\n                </div>\n                <div className='column is-6'>\n                  <p className='calculation-information__data'>\n                    {' '}\n                    {formatCurrency(ivaTax)}\n                  </p>\n                </div>\n              </div>\n            )}\n            <div className='columns is-margin-bottom-less'>\n              <div className='column is-12'>\n                <hr className='visual-rest visual-rest--margin-16px' />\n              </div>\n            </div>\n            <div className='columns flex-end'>\n              <div className='column is-4'>\n                <p className='total-to-pay'>\n                  <span className='total-to-pay__amount'>\n                    {formatCurrency(total)}\n                  </span>\n                  <span className='total-to-pay__label'>Total por pagar</span>\n                </p>\n              </div>\n            </div>\n          </div>\n        </div>\n        {showButtons && calculation.status === 'reviewed_by_accountant' ? (\n          <div className='columns is-centered'>\n            <div className='column is-8'>\n              <p className='calculation-notification'>\n                <span>\n                  <i className='mdi mdi-alert-octagon-outline' />\n                </span>\n                Para validar este periodo debes revisar y aprobar el perido:\n                <Button buttonStyle='link link--blue' onClick={this.goToPeriod}>\n                  {` ${oldMonth} ${year}.`}\n                </Button>\n              </p>\n            </div>\n          </div>\n        ) : (\n          currentStep === 'accounting_done' &&\n          calculation.status === 'reviewed_by_accountant' && (\n            <div className='columns is-centered'>\n              <div className='column is-7 flex-end'>\n                <Button\n                  onClick={this.toggleModal}\n                  loading={this.state.requestInProgress}\n                  icon='close-circle-outline'\n                  buttonStyle='primaryInv'\n                >\n                  Rechazar\n                </Button>\n                <Button\n                  onClick={() => this.onChangeStatus('accepted')}\n                  loading={this.state.requestInProgress}\n                  icon='check-circle-outline'\n                  buttonStyle='primary'\n                >\n                  Aceptar\n                </Button>\n              </div>\n            </div>\n          )\n        )}\n        <Modal\n          title='¿Seguro quieres rechazar los Cálculos ?'\n          isActive={this.state.openModal}\n          toggleModal={this.toggleModal}\n          onSubmit={() => this.onChangeStatus('rejected')}\n          disabled={!this.state.comments}\n        >\n          <form>\n            <label className='subtitle'>\n              Dile a tu contador por qué rechazas los cálculos *\n            </label>\n            <textarea\n              className='textarea'\n              style={{ margin: '1em 0' }}\n              value={this.state.comments}\n              onChange={this.onChangeComments}\n            />\n          </form>\n        </Modal>\n      </div>\n    )\n  }\n}\n"]},"metadata":{},"sourceType":"module"}