{"ast":null,"code":"import _regeneratorRuntime from \"/Users/usuario-rtd/Desktop/widget-front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/usuario-rtd/Desktop/widget-front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"/Users/usuario-rtd/Desktop/widget-front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/usuario-rtd/Desktop/widget-front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/usuario-rtd/Desktop/widget-front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/usuario-rtd/Desktop/widget-front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/usuario-rtd/Desktop/widget-front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/Users/usuario-rtd/Desktop/widget-front/src/components/app/views/accountingPeriods/review/components/invoiceCalculation.js\";\n// Libraries\nimport React, { Component } from 'react';\nimport { Link, withRouter } from 'react-router';\nimport pluralize from 'pluralize';\nimport AppSignal from 'appsignal'; // Components\n\nimport Paginator from 'shared/paginator';\nimport NotificationsActions from 'actions/notifications';\nimport Loading from 'shared/loading';\nimport { prettyDate, formatCurrency } from 'utils';\nimport API from 'api';\n\nvar InvoiceCalculation =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(InvoiceCalculation, _Component);\n\n  function InvoiceCalculation() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, InvoiceCalculation);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(InvoiceCalculation)).call.apply(_getPrototypeOf2, [this].concat(args)));\n    _this.state = {\n      invoices: [],\n      totalPages: 0,\n      totalItems: 0,\n      invoicesIds: [],\n      requestInProgress: false\n    };\n    _this.getInvoiceCalculation =\n    /*#__PURE__*/\n    _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee() {\n      var _this$props, calculationId, type, page, params, _ref2, invoices, _ref2$pagination, totalPages, totalItems;\n\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _this$props = _this.props, calculationId = _this$props.calculationId, type = _this$props.type;\n              page = _this.props.location.query.page;\n              params = {\n                page: page,\n                invoice_type: type,\n                id: calculationId,\n                stamped: true\n              };\n\n              _this.setState({\n                requestInProgress: true\n              });\n\n              _context.prev = 4;\n              _context.next = 7;\n              return API.InvoicesConsiderated.List(params);\n\n            case 7:\n              _ref2 = _context.sent;\n              invoices = _ref2.invoices;\n              _ref2$pagination = _ref2.pagination;\n              totalPages = _ref2$pagination.total_pages;\n              totalItems = _ref2$pagination.total_items;\n\n              _this.setState({\n                invoices: invoices,\n                totalPages: totalPages,\n                totalItems: totalItems\n              });\n\n              _context.next = 19;\n              break;\n\n            case 15:\n              _context.prev = 15;\n              _context.t0 = _context[\"catch\"](4);\n              AppSignal.sendError(_context.t0);\n              NotificationsActions.error(_context.t0);\n\n            case 19:\n              _context.prev = 19;\n\n              _this.setState({\n                requestInProgress: false\n              });\n\n              return _context.finish(19);\n\n            case 22:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[4, 15, 19, 22]]);\n    }));\n    return _this;\n  }\n\n  _createClass(InvoiceCalculation, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this.getInvoiceCalculation();\n    }\n  }, {\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate(prevProps) {\n      if (prevProps.location.query.page !== this.props.location.query.page) {\n        this.getInvoiceCalculation();\n      }\n    } // Get invoices calculation from api\n\n  }, {\n    key: \"renderContent\",\n    value: function renderContent() {\n      var invoices = this.state.invoices;\n      return React.createElement(\"tbody\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 68\n        },\n        __self: this\n      }, invoices.map(function (invoice) {\n        return React.createElement(\"tr\", {\n          key: invoice.id,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 71\n          },\n          __self: this\n        }, React.createElement(\"td\", {\n          className: \"has-text-left small-padding\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 72\n          },\n          __self: this\n        }, React.createElement(Link, {\n          to: \"/facturas/ver/\".concat(invoice.id),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 73\n          },\n          __self: this\n        }, invoice.legal_name)), React.createElement(\"td\", {\n          className: \"is-uppercase small-padding\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 77\n          },\n          __self: this\n        }, invoice.rfc), React.createElement(\"td\", {\n          className: \"is-uppercase small-padding\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 78\n          },\n          __self: this\n        }, prettyDate(invoice.issue_date, '', true, false, '-')), React.createElement(\"td\", {\n          className: \"has-text-right small-padding\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 81\n          },\n          __self: this\n        }, formatCurrency(invoice.total)));\n      }));\n    } // Main render\n\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this$state = this.state,\n          totalPages = _this$state.totalPages,\n          totalItems = _this$state.totalItems,\n          requestInProgress = _this$state.requestInProgress;\n      var location = this.props.location;\n      return React.createElement(\"div\", {\n        className: \"section section--is-small\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 96\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"columns is-centered\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 97\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"column is-11\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 98\n        },\n        __self: this\n      }, React.createElement(\"p\", {\n        className: \"caption\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 99\n        },\n        __self: this\n      }, \"Hay \".concat(totalItems, \" \").concat(pluralize('factura', totalItems), \"\\n                \").concat(pluralize('relacionada', totalItems))), requestInProgress ? React.createElement(Loading, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 104\n        },\n        __self: this\n      }) : React.createElement(\"table\", {\n        className: \"table table--calculation-table is-borderless\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 106\n        },\n        __self: this\n      }, React.createElement(\"thead\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 107\n        },\n        __self: this\n      }, React.createElement(\"tr\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 108\n        },\n        __self: this\n      }, React.createElement(\"th\", {\n        className: \"has-text-left padding-bottom-less\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 109\n        },\n        __self: this\n      }, \"Concepto\"), React.createElement(\"th\", {\n        className: \"padding-bottom-less\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 112\n        },\n        __self: this\n      }, \"RFC\"), React.createElement(\"th\", {\n        className: \"padding-bottom-less\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 113\n        },\n        __self: this\n      }, \"Fecha de emisi\\xF3n\"), React.createElement(\"th\", {\n        className: \"has-text-right padding-bottom-less\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 114\n        },\n        __self: this\n      }, \"Total\"))), this.renderContent()), React.createElement(Paginator, {\n        location: location,\n        totalPages: totalPages,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 122\n        },\n        __self: this\n      }))));\n    }\n  }]);\n\n  return InvoiceCalculation;\n}(Component);\n\nexport default withRouter(InvoiceCalculation);","map":{"version":3,"sources":["/Users/usuario-rtd/Desktop/widget-front/src/components/app/views/accountingPeriods/review/components/invoiceCalculation.js"],"names":["React","Component","Link","withRouter","pluralize","AppSignal","Paginator","NotificationsActions","Loading","prettyDate","formatCurrency","API","InvoiceCalculation","state","invoices","totalPages","totalItems","invoicesIds","requestInProgress","getInvoiceCalculation","props","calculationId","type","page","location","query","params","invoice_type","id","stamped","setState","InvoicesConsiderated","List","pagination","total_pages","total_items","sendError","error","prevProps","map","invoice","legal_name","rfc","issue_date","total","renderContent"],"mappings":"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","sourcesContent":["// Libraries\nimport React, { Component } from 'react'\nimport { Link, withRouter } from 'react-router'\nimport pluralize from 'pluralize'\nimport AppSignal from 'appsignal'\n\n// Components\nimport Paginator from 'shared/paginator'\nimport NotificationsActions from 'actions/notifications'\nimport Loading from 'shared/loading'\nimport { prettyDate, formatCurrency } from 'utils'\n\nimport API from 'api'\n\nclass InvoiceCalculation extends Component {\n  state = {\n    invoices: [],\n    totalPages: 0,\n    totalItems: 0,\n    invoicesIds: [],\n    requestInProgress: false\n  }\n\n  componentDidMount () {\n    this.getInvoiceCalculation()\n  }\n\n  componentDidUpdate (prevProps) {\n    if (prevProps.location.query.page !== this.props.location.query.page) {\n      this.getInvoiceCalculation()\n    }\n  }\n\n  // Get invoices calculation from api\n  getInvoiceCalculation = async () => {\n    const { calculationId, type } = this.props\n    const { page } = this.props.location.query\n\n    const params = {\n      page: page,\n      invoice_type: type,\n      id: calculationId,\n      stamped: true\n    }\n    this.setState({ requestInProgress: true })\n    try {\n      const {\n        invoices,\n        pagination: { total_pages: totalPages, total_items: totalItems }\n      } = await API.InvoicesConsiderated.List(params)\n\n      this.setState({\n        invoices,\n        totalPages: totalPages,\n        totalItems: totalItems\n      })\n    } catch (error) {\n      AppSignal.sendError(error)\n      NotificationsActions.error(error)\n    } finally {\n      this.setState({ requestInProgress: false })\n    }\n  }\n\n  renderContent () {\n    const { invoices } = this.state\n    return (\n      <tbody>\n        {invoices.map(invoice => {\n          return (\n            <tr key={invoice.id}>\n              <td className='has-text-left small-padding'>\n                <Link to={`/facturas/ver/${invoice.id}`}>\n                  {invoice.legal_name}\n                </Link>\n              </td>\n              <td className='is-uppercase small-padding'>{invoice.rfc}</td>\n              <td className='is-uppercase small-padding'>\n                {prettyDate(invoice.issue_date, '', true, false, '-')}\n              </td>\n              <td className='has-text-right small-padding'>\n                {formatCurrency(invoice.total)}\n              </td>\n            </tr>\n          )\n        })}\n      </tbody>\n    )\n  }\n\n  // Main render\n  render () {\n    const { totalPages, totalItems, requestInProgress } = this.state\n    const { location } = this.props\n    return (\n      <div className='section section--is-small'>\n        <div className='columns is-centered'>\n          <div className='column is-11'>\n            <p className='caption'>\n              {`Hay ${totalItems} ${pluralize('factura', totalItems)}\n                ${pluralize('relacionada', totalItems)}`}\n            </p>\n            {requestInProgress ? (\n              <Loading />\n            ) : (\n              <table className='table table--calculation-table is-borderless'>\n                <thead>\n                  <tr>\n                    <th className='has-text-left padding-bottom-less'>\n                      Concepto\n                    </th>\n                    <th className='padding-bottom-less'>RFC</th>\n                    <th className='padding-bottom-less'>Fecha de emisión</th>\n                    <th className='has-text-right padding-bottom-less'>\n                      Total\n                    </th>\n                  </tr>\n                </thead>\n                {this.renderContent()}\n              </table>\n            )}\n            <Paginator location={location} totalPages={totalPages} />\n          </div>\n        </div>\n      </div>\n    )\n  }\n}\n\nexport default withRouter(InvoiceCalculation)\n"]},"metadata":{},"sourceType":"module"}