{"ast":null,"code":"import _defineProperty from \"/Users/usuario-rtd/Desktop/widget-front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _classCallCheck from \"/Users/usuario-rtd/Desktop/widget-front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/usuario-rtd/Desktop/widget-front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/usuario-rtd/Desktop/widget-front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/usuario-rtd/Desktop/widget-front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/usuario-rtd/Desktop/widget-front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _assertThisInitialized from \"/Users/usuario-rtd/Desktop/widget-front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";\nvar _jsxFileName = \"/Users/usuario-rtd/Desktop/widget-front/src/components/app/views/income/index.js\";\nimport React, { Component, Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport { browserHistory, Link } from 'react-router';\nimport accounting from 'accounting';\nimport _debounce from 'lodash/debounce';\nimport classNames from 'classnames';\nimport { AsyncCreatable } from 'react-select';\nimport moment from 'moment';\nimport ReactGa from 'react-ga';\nimport _kebabCase from 'lodash/kebabCase';\nimport AppSignal from 'appsignal';\nimport AppStorage from 'api/appStorage';\nimport API from 'api';\nimport { prettyDate, absolutify, createGaEvent, resetScroll, isDisabledInvoiceLabeling, askRemainingPlanDays, getClientsPlan } from 'utils';\nimport { INVOICE_PAYMENT_STATUS, FORMATTED_SAT_CATEGORIES } from 'shared/catalogs';\nimport Modal from 'shared/modal';\nimport TextField from 'shared/textField';\nimport Datepicker from 'shared/datepicker';\nimport SelectField from 'shared/selectField';\nimport TableFilter from 'shared/tableFilter';\nimport Paginator from 'shared/paginator';\nimport Card from 'shared/card';\nimport StatusIcon from 'shared/statusIcon';\nimport IconButton from 'shared/iconButton';\nimport StatusLabel from 'shared/statusLabel';\nimport ExportButton from 'shared/exportButton';\nimport CredentialsExpire from 'shared/credentials';\nimport InvoicesActions from 'actions/invoices';\nimport NotificationsActions from 'actions/notifications';\nimport RestrictionsActions from 'actions/restrictions';\nimport InvoicesStore from 'stores/invoices';\nimport RestrictionsStore from 'stores/restrictions';\nimport Banner from 'shared/banner';\nimport { toggleBanner, textIncomes, toggleBannerModal, modalPlans, toggleUpdatePlanModal, modalUpdatePlan } from '../viewInvoice/utilsRestrictions';\nvar EXPORT_SUCCESS_MESSAGE = 'Se ha iniciado la generacion del archivo, estará listo en la seccion de Descargas en unos momentos.';\nvar EXPORT_ERROR_MESSAGE_1 = 'La selección debe tener al menos un registro, por favor intentelo de nuevo optimizando los filtros de búsqueda.';\nvar windowGlobal = typeof window !== 'undefined' && window;\n\nfunction getCurrentState() {\n  return {\n    invoices: InvoicesStore.getInvoices('incomes'),\n    totalPages: InvoicesStore.getTotalPages('incomes'),\n    totalItems: InvoicesStore.getTotalItems('incomes'),\n    remainingDownloads: RestrictionsStore.getRemainingExcelDownloads()\n  };\n}\n\nvar EXPORT_BUTTONS = [{\n  icon: 'file-excel',\n  label: 'Exportar a excel',\n  format: 'invoice_excel'\n}, {\n  icon: 'file-xml',\n  label: 'Exportar a XML',\n  format: 'xml'\n}];\nvar STATUS_FILTERS = [{\n  value: 'pending_payment',\n  label: 'Por cobrar'\n}, {\n  value: 'partially_paid',\n  label: 'Cobrada parcialmente',\n  className: 'is-marginless'\n}, {\n  value: 'paid',\n  label: 'Cobrada',\n  className: 'is-marginless'\n}, {\n  value: 'cancelled',\n  label: 'Cancelada',\n  className: 'is-marginless'\n}];\nvar DEFAULT_FILTERS = {\n  stamped: true,\n  invoice_type: 'incomes'\n};\n\nvar debouncedFetch = _debounce(function (searchTerm, callback) {\n  API.CustomCategories.List().then(function (r) {\n    return callback(null, {\n      options: r.invoice_categories.map(function (cat) {\n        return {\n          value: cat.name,\n          label: cat.name\n        };\n      })\n    });\n  }).catch(function (r) {\n    return callback(err);\n  }); // eslint-disable-line\n}, 700);\n\nvar Income =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(Income, _Component);\n\n  function Income() {\n    var _this;\n\n    _classCallCheck(this, Income);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(Income).call(this));\n\n    _this.exportTo = function (format) {\n      var params = Object.assign({}, _this.props.location.query, DEFAULT_FILTERS);\n      var totalItems = _this.state.totalItems;\n\n      if (totalItems > 500) {\n        ReactGa.event(createGaEvent('ingresos', 'click on disabled button', format));\n      } else if (totalItems < 1) {\n        NotificationsActions.error(EXPORT_ERROR_MESSAGE_1);\n      } else {\n        ReactGa.event(createGaEvent('ingresos', 'click on button', format));\n        InvoicesActions.exportInvoices(params, format).then(function (r) {\n          return NotificationsActions.success(EXPORT_SUCCESS_MESSAGE);\n        }).catch(function (err) {\n          return NotificationsActions.error(err);\n        });\n      }\n    };\n\n    _this.data = {\n      sort: {\n        sort_by: 'issue_date',\n        sort_direction: 'desc'\n      },\n      filters: {\n        sat_folio: '',\n        startDate: moment().subtract(1, 'M'),\n        endDate: moment(),\n        status: '',\n        legalName: '',\n        rfc: '',\n        amountType: 'subtotal',\n        category: '',\n        amountMin: 0,\n        amountMax: 0\n      },\n      modal: {\n        open: false,\n        invoiceCategory: null,\n        invoiceId: null\n      },\n      datesOpen: false,\n      amountOpen: false,\n      statusOpen: false,\n      dataLoading: true,\n      formQuit: false,\n      showBannerIncomes: true,\n      showBannerModal: false,\n      updatePlanModal: false\n    };\n    _this.state = Object.assign({}, _this.data, getCurrentState());\n    _this._onChange = _this._onChange.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    return _this;\n  }\n\n  _createClass(Income, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      InvoicesStore.addChangeListener(this._onChange);\n      RestrictionsStore.addChangeListener(this._onChange);\n      this.loadData();\n      askRemainingPlanDays();\n      RestrictionsActions.getRestrictions().catch(function (error) {\n        NotificationsActions.error(error);\n      });\n    }\n  }, {\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate(prevProps) {\n      if (this.props.location.search !== prevProps.location.search) {\n        this.loadData(this.props);\n      }\n\n      resetScroll();\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      InvoicesStore.removeChangeListener(this._onChange);\n      RestrictionsStore.removeChangeListener(this._onChange);\n\n      if (this.state.formQuit) {\n        ReactGa.event(createGaEvent('ingresos', 'form quit'));\n      }\n    }\n  }, {\n    key: \"_onChange\",\n    value: function _onChange() {\n      var state = getCurrentState();\n\n      if (this.state.dataLoading) {\n        this.setState({\n          dataLoading: false,\n          formQuit: false\n        });\n        ReactGa.event(createGaEvent('ingresos', 'result', this.props.location.search, state.totalItems));\n      }\n\n      this.setState(state);\n    }\n  }, {\n    key: \"setFilters\",\n    value: function setFilters(field, value) {\n      this.setState(function (prevState) {\n        return {\n          filters: Object.assign({}, prevState.filters, _defineProperty({}, field, value))\n        };\n      });\n    }\n  }, {\n    key: \"onChangeFilter\",\n    value: function onChangeFilter(field, e) {\n      var value = e.target ? e.target.value : e;\n      this.setFilters(field, value);\n    }\n  }, {\n    key: \"formatAmount\",\n    value: function formatAmount(field) {\n      var value = accounting.formatMoney(absolutify(this.state.filters[field]), '$ ');\n      this.setFilters(field, value);\n    }\n  }, {\n    key: \"unformatAmount\",\n    value: function unformatAmount(field) {\n      var value = absolutify(this.state.filters[field]);\n      this.setFilters(field, value);\n    }\n  }, {\n    key: \"toggleFiltersOpen\",\n    value: function toggleFiltersOpen(field) {\n      this.setState(function (prevState) {\n        return _defineProperty({}, field, !prevState[field]);\n      });\n    }\n  }, {\n    key: \"prepareFilters\",\n    value: function prepareFilters(filters) {\n      var _filters2;\n\n      ReactGa.event(createGaEvent('ingresos', 'click on button', 'filtrar tabla'));\n      var _this$state = this.state,\n          datesOpen = _this$state.datesOpen,\n          amountOpen = _this$state.amountOpen;\n      var legalName = filters.legalName,\n          amountType = filters.amountType,\n          rfc = filters.rfc,\n          startDate = filters.startDate,\n          endDate = filters.endDate,\n          amountMin = filters.amountMin,\n          amountMax = filters.amountMax,\n          status = filters.status;\n      var absAmountMin = absolutify(amountMin);\n      var absAmountMax = absolutify(amountMax);\n      var RFC_KEY = 'recipient_rfc';\n      var LEGAL_NAME_KEY = 'recipient_legal_name';\n      var AMOUNT_MIN_KEY = \"\".concat(amountType, \"_range[min]\");\n      var AMOUNT_MAX_KEY = \"\".concat(amountType, \"_range[max]\");\n\n      var _filters = (_filters2 = {}, _defineProperty(_filters2, RFC_KEY, rfc), _defineProperty(_filters2, LEGAL_NAME_KEY, legalName), _defineProperty(_filters2, \"status\", status), _filters2);\n\n      if (datesOpen) {\n        if (startDate.isAfter(endDate, 'day')) {\n          ReactGa.event(createGaEvent('ingresos', 'form error', 'fecha de inicio mayor a fecha de fin'));\n          NotificationsActions.error('La fecha de inicio no puede ser mayor a la fecha de fin.');\n          return {};\n        }\n\n        Object.assign(_filters, {\n          'date_range[start]': moment(startDate).format('YYYY-MM-DD'),\n          'date_range[end]': moment(endDate).format('YYYY-MM-DD')\n        });\n      }\n\n      if (amountOpen) {\n        var _Object$assign2;\n\n        if (absAmountMin > absAmountMax) {\n          ReactGa.event(createGaEvent('ingresos', 'form error', 'importe minimo mayor que maximo'));\n          NotificationsActions.error('La cantidad mínima debe ser menor que la máxima.');\n          return {};\n        }\n\n        Object.assign(_filters, (_Object$assign2 = {}, _defineProperty(_Object$assign2, AMOUNT_MIN_KEY, absAmountMin.toString()), _defineProperty(_Object$assign2, AMOUNT_MAX_KEY, absAmountMax.toString()), _Object$assign2));\n      }\n\n      this.setState({\n        dataLoading: true,\n        filtersSuccess: false\n      });\n      return _filters;\n    }\n  }, {\n    key: \"clearFilters\",\n    value: function clearFilters() {\n      ReactGa.event(createGaEvent('ingresos', 'click on button', 'limpiar filtros'));\n      this.setState({\n        filters: this.data.filters,\n        dataLoading: true\n      });\n    }\n  }, {\n    key: \"onSearchInvoice\",\n    value: function onSearchInvoice() {\n      browserHistory.push(\"/ingresos?sat_folio=\".concat(this.state.filters.sat_folio));\n    }\n  }, {\n    key: \"loadData\",\n    value: function loadData() {\n      var props = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : this.props;\n      var params = Object.assign({}, props.location.query, this.state.sort, DEFAULT_FILTERS);\n      InvoicesActions.getInvoices(params);\n      this.setState(function (prevState) {\n        return {\n          filters: Object.assign({}, prevState.filters, params)\n        };\n      });\n    }\n  }, {\n    key: \"sortBy\",\n    value: function sortBy(column) {\n      var sort = this.state.sort;\n\n      if (sort.sort_by === column) {\n        switch (sort.sort_direction) {\n          case 'asc':\n            sort.sort_direction = 'desc';\n            break;\n\n          case 'desc':\n            sort.sort_direction = 'asc';\n            break;\n        }\n      } else {\n        sort = {\n          sort_by: column,\n          sort_direction: 'asc'\n        };\n      }\n\n      this.setState({\n        sort: sort\n      }, this.loadData);\n    }\n  }, {\n    key: \"getIcon\",\n    value: function getIcon(column) {\n      var sort = this.state.sort;\n      return React.createElement(\"i\", {\n        style: {\n          fontSize: '1rem'\n        },\n        className: classNames('mdi', {\n          'mdi-chevron-down': sort.sort_direction === 'desc',\n          'mdi-chevron-up': sort.sort_direction === 'asc',\n          'mdi-unfold-more-horizontal': sort.sort_by !== column\n        }),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 364\n        },\n        __self: this\n      });\n    }\n  }, {\n    key: \"setCategory\",\n    value: function setCategory(id, category) {\n      var _this2 = this;\n\n      var invoice = this.state.invoices.find(function (invoice) {\n        return invoice.id === id;\n      });\n      var successMessage = 'Rubro asignado';\n\n      if (category === null) {\n        category = {\n          value: null,\n          label: null\n        };\n        successMessage = 'Rubro retirado de la factura';\n\n        if (invoice.sat_category === null) {\n          this.toggleCategoryModal();\n          return;\n        }\n      }\n\n      API.Invoice.SetCategory(id, {\n        category: {\n          sat_category: category.label\n        }\n      }).then(function (r) {\n        NotificationsActions.success(successMessage);\n\n        _this2.toggleCategoryModal();\n\n        _this2.loadData();\n      }).catch(function (error) {\n        AppSignal.sendError(error);\n        NotificationsActions.error('Error al asignar rubro');\n      });\n    }\n  }, {\n    key: \"createCategory\",\n    value: function createCategory(id, category) {\n      var _this3 = this;\n\n      API.CustomCategories.Create({\n        invoice_category: {\n          name: category.value\n        }\n      }).then(function (r) {\n        NotificationsActions.success(\"Rubro creado: \".concat(r.invoice_category.name));\n\n        _this3.setCategory(id, category);\n      }).catch(function (r) {\n        NotificationsActions.error('Falla al crear rubro');\n        console.error(r);\n      });\n    }\n  }, {\n    key: \"toggleCategoryModal\",\n    value: function toggleCategoryModal(id, category) {\n      this.setState(function (prevState) {\n        return {\n          modal: Object.assign({}, prevState.modal, {\n            open: !prevState.modal.open,\n            invoiceId: prevState.modal.open ? null : id,\n            invoiceCategory: {\n              value: prevState.modal.open ? null : category,\n              label: prevState.modal.open ? null : category\n            }\n          })\n        };\n      });\n    }\n  }, {\n    key: \"renderTable\",\n    value: function renderTable() {\n      var _this4 = this;\n\n      var entityId = AppStorage.getCurrentEntity().id;\n      var _this$state2 = this.state,\n          invoices = _this$state2.invoices,\n          totalPages = _this$state2.totalPages,\n          sort = _this$state2.sort;\n      var renderTable = React.createElement(\"div\", {\n        className: \"block unselectable\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 431\n        },\n        __self: this\n      }, React.createElement(\"p\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 432\n        },\n        __self: this\n      }, \"No hay facturas\"));\n\n      if (invoices.length > 0) {\n        var invoicesList = invoices.map(function (invoice) {\n          return React.createElement(\"tr\", {\n            key: invoice.id,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 437\n            },\n            __self: this\n          }, React.createElement(\"td\", {\n            className: \"align-left\",\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 438\n            },\n            __self: this\n          }, React.createElement(Link, {\n            to: \"/facturas/ver/\".concat(invoice.id),\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 439\n            },\n            __self: this\n          }, invoice.legal_name)), React.createElement(\"td\", {\n            className: \"align-right table--actions\",\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 441\n            },\n            __self: this\n          }, invoice.payment_status !== 'cancelled' ? invoice.sat_category : null, \"\\xA0\\xA0\\xA0\", React.createElement(IconButton, {\n            icon: \"pencil\",\n            tooltip: \"Modificar rubro\",\n            onClick: _this4.toggleCategoryModal.bind(_this4, invoice.id, invoice.sat_category),\n            disabled: isDisabledInvoiceLabeling(invoice.payment_status),\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 446\n            },\n            __self: this\n          })), React.createElement(\"td\", {\n            className: \"nowrap\",\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 457\n            },\n            __self: this\n          }, invoice.issue_date ? prettyDate(invoice.issue_date, false, true, false, '/') : ''), React.createElement(\"td\", {\n            className: \"is-money\",\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 462\n            },\n            __self: this\n          }, accounting.formatMoney(invoice.subtotal, '', 2)), React.createElement(\"td\", {\n            className: \"is-money\",\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 465\n            },\n            __self: this\n          }, accounting.formatMoney(invoice.total, '', 2)), React.createElement(\"td\", {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 468\n            },\n            __self: this\n          }, React.createElement(StatusIcon, {\n            className: INVOICE_PAYMENT_STATUS[invoice.payment_status],\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 469\n            },\n            __self: this\n          })), React.createElement(\"td\", {\n            className: \"table--actions flex-center\",\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 473\n            },\n            __self: this\n          }, React.createElement(\"a\", {\n            onClick: function onClick() {\n              ReactGa.event(createGaEvent('ingresos', 'click on button', 'Descargar PDF'));\n            },\n            href: \"\".concat(process.env.API_SERVER).concat(process.env.API_PREFIX, \"/pdfs/\").concat(invoice.id, \"/\").concat(entityId),\n            download: true,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 474\n            },\n            __self: this\n          }, React.createElement(IconButton, {\n            icon: \"file-pdf\",\n            tooltip: \"Descargar PDF\",\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 483\n            },\n            __self: this\n          })), invoice.version === '3.3' && React.createElement(Link, {\n            to: \"/facturas/nueva?invoice=\".concat(invoice.id),\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 486\n            },\n            __self: this\n          }, React.createElement(IconButton, {\n            icon: \"autorenew\",\n            tooltip: \"Reemitir factura\",\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 487\n            },\n            __self: this\n          }))));\n        });\n        renderTable = React.createElement(\"div\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 494\n          },\n          __self: this\n        }, React.createElement(\"table\", {\n          className: \"table is-sortable\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 495\n          },\n          __self: this\n        }, React.createElement(\"thead\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 496\n          },\n          __self: this\n        }, React.createElement(\"tr\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 497\n          },\n          __self: this\n        }, React.createElement(\"th\", {\n          className: classNames('align-left', {\n            'is-sorting': sort.sort_by === 'legal_name'\n          }),\n          onClick: this.sortBy.bind(this, 'legal_name'),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 498\n          },\n          __self: this\n        }, \"Raz\\xF3n social \", this.getIcon('legal_name')), React.createElement(\"th\", {\n          style: {\n            width: '8rem'\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 506\n          },\n          __self: this\n        }, \"Rubro\"), React.createElement(\"th\", {\n          className: classNames({\n            'is-sorting': sort.sort_by === 'issue_date'\n          }),\n          onClick: this.sortBy.bind(this, 'issue_date'),\n          style: {\n            width: '8rem'\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 507\n          },\n          __self: this\n        }, \"Fecha \", this.getIcon('issue_date')), React.createElement(\"th\", {\n          className: classNames('is-money', {\n            'is-sorting': sort.sort_by === 'subtotal_cents'\n          }),\n          onClick: this.sortBy.bind(this, 'subtotal_cents'),\n          style: {\n            width: '10rem'\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 516\n          },\n          __self: this\n        }, \"Subtotal \", this.getIcon('subtotal_cents')), React.createElement(\"th\", {\n          className: classNames('is-money', {\n            'is-sorting': sort.sort_by === 'total_cents'\n          }),\n          onClick: this.sortBy.bind(this, 'total_cents'),\n          style: {\n            width: '10rem'\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 525\n          },\n          __self: this\n        }, \"Total \", this.getIcon('total_cents')), React.createElement(\"th\", {\n          style: {\n            width: '5rem'\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 534\n          },\n          __self: this\n        }, \"Estado\"))), React.createElement(\"tbody\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 537\n          },\n          __self: this\n        }, invoicesList)), React.createElement(Paginator, {\n          onPageChanged: function onPageChanged(page) {\n            return ReactGa.event(createGaEvent('ingresos', 'page changed', '', page));\n          },\n          totalPages: totalPages,\n          location: this.props.location,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 539\n          },\n          __self: this\n        }));\n      }\n\n      return renderTable;\n    }\n  }, {\n    key: \"renderCategorySelector\",\n    value: function renderCategorySelector() {\n      var _this$state$modal = this.state.modal,\n          open = _this$state$modal.open,\n          invoiceId = _this$state$modal.invoiceId;\n      var select = open ? React.createElement(AsyncCreatable, {\n        value: this.state.modal.invoiceCategory,\n        loadOptions: debouncedFetch,\n        clearable: true,\n        placeholder: \"Selecciona un rubro\",\n        loadingPlaceholder: \"Buscando\",\n        searchPromptText: \"Buscar un rubro\",\n        noResultsText: \"No encontrado\",\n        promptTextCreator: function promptTextCreator(label) {\n          return \"Crear rubro: \".concat(label);\n        },\n        onChange: this.setCategory.bind(this, invoiceId),\n        onNewOptionClick: this.createCategory.bind(this, invoiceId),\n        ignoreAccents: false,\n        openOnFocus: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 555\n        },\n        __self: this\n      }) : null;\n      return React.createElement(Modal, {\n        title: \"Rubro\",\n        isActive: open,\n        toggleModal: this.toggleCategoryModal.bind(this),\n        noFooter: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 571\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"espacio-xxlarge\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 577\n        },\n        __self: this\n      }, select, React.createElement(\"br\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 579\n        },\n        __self: this\n      }), React.createElement(\"br\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 580\n        },\n        __self: this\n      }), React.createElement(\"br\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 581\n        },\n        __self: this\n      }), React.createElement(\"br\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 582\n        },\n        __self: this\n      }), React.createElement(\"br\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 583\n        },\n        __self: this\n      })));\n    }\n  }, {\n    key: \"renderLegalName\",\n    value: function renderLegalName() {\n      return React.createElement(TextField, {\n        placeholder: \"Raz\\xF3n Social\",\n        value: this.state.filters.legalName,\n        onChange: this.onChangeFilter.bind(this, 'legalName'),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 591\n        },\n        __self: this\n      });\n    }\n  }, {\n    key: \"renderRfc\",\n    value: function renderRfc() {\n      return React.createElement(TextField, {\n        placeholder: \"RFC\",\n        value: this.state.filters.rfc,\n        onChange: this.onChangeFilter.bind(this, 'rfc'),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 601\n        },\n        __self: this\n      });\n    }\n  }, {\n    key: \"renderCategory\",\n    value: function renderCategory() {\n      return React.createElement(SelectField, {\n        placeholder: \"Rubro\",\n        options: FORMATTED_SAT_CATEGORIES,\n        value: this.state.category,\n        onChange: this.onChangeFilter.bind(this, 'category'),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 611\n        },\n        __self: this\n      });\n    }\n  }, {\n    key: \"renderDates\",\n    value: function renderDates() {\n      var _this$state3 = this.state,\n          datesOpen = _this$state3.datesOpen,\n          filters = _this$state3.filters;\n      return React.createElement(\"div\", {\n        className: \"flex-column\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 623\n        },\n        __self: this\n      }, React.createElement(\"button\", {\n        onClick: this.toggleFiltersOpen.bind(this, 'datesOpen'),\n        style: {\n          cursor: 'pointer'\n        },\n        className: \"subtitle-body flex-between\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 624\n        },\n        __self: this\n      }, \"Periodo\", React.createElement(\"i\", {\n        className: classNames('mdi', {\n          'mdi-plus': !datesOpen,\n          'mdi-minus': datesOpen\n        }),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 630\n        },\n        __self: this\n      })), React.createElement(\"div\", {\n        className: classNames({\n          'is-hidden': !datesOpen\n        }),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 637\n        },\n        __self: this\n      }, React.createElement(Datepicker, {\n        label: \"Del\",\n        placeholder: \"Fecha inicio\",\n        value: filters.startDate,\n        onChange: this.onChangeFilter.bind(this, 'startDate'),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 638\n        },\n        __self: this\n      }), React.createElement(Datepicker, {\n        label: \"Al\",\n        placeholder: \"Fecha fin\",\n        value: filters.endDate,\n        onChange: this.onChangeFilter.bind(this, 'endDate'),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 644\n        },\n        __self: this\n      })));\n    }\n  }, {\n    key: \"renderAmount\",\n    value: function renderAmount() {\n      var _this$state4 = this.state,\n          amountOpen = _this$state4.amountOpen,\n          filters = _this$state4.filters;\n      return React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 658\n        },\n        __self: this\n      }, React.createElement(\"button\", {\n        onClick: this.toggleFiltersOpen.bind(this, 'amountOpen'),\n        style: {\n          cursor: 'pointer'\n        },\n        className: \"subtitle-body flex-between\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 659\n        },\n        __self: this\n      }, \"Importe\", React.createElement(\"i\", {\n        className: classNames('mdi', {\n          'mdi-plus': !amountOpen,\n          'mdi-minus': amountOpen\n        }),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 665\n        },\n        __self: this\n      })), React.createElement(\"div\", {\n        className: classNames('control flex-column', {\n          'is-hidden': !amountOpen\n        }),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 672\n        },\n        __self: this\n      }, React.createElement(\"label\", {\n        className: \"radio\",\n        htmlFor: \"subtotal\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 677\n        },\n        __self: this\n      }, React.createElement(\"input\", {\n        id: \"subtotal\",\n        type: \"radio\",\n        value: \"subtotal\",\n        onChange: this.onChangeFilter.bind(this, 'amountType'),\n        checked: filters.amountType === 'subtotal',\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 678\n        },\n        __self: this\n      }), \"\\xA0Subtotal\"), React.createElement(\"label\", {\n        className: \"radio is-marginless\",\n        htmlFor: \"total\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 687\n        },\n        __self: this\n      }, React.createElement(\"input\", {\n        id: \"total\",\n        type: \"radio\",\n        value: \"total\",\n        onChange: this.onChangeFilter.bind(this, 'amountType'),\n        checked: filters.amountType === 'total',\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 688\n        },\n        __self: this\n      }), \"\\xA0Total\"), React.createElement(TextField, {\n        label: \"Desde\",\n        placeholder: \"0.00\",\n        value: filters.amountMin,\n        onChange: this.onChangeFilter.bind(this, 'amountMin'),\n        onBlur: this.formatAmount.bind(this, 'amountMin'),\n        onFocus: this.unformatAmount.bind(this, 'amountMin'),\n        selectAllOnFocus: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 697\n        },\n        __self: this\n      }), React.createElement(TextField, {\n        label: \"Hasta\",\n        placeholder: \"0.00\",\n        value: filters.amountMax,\n        onChange: this.onChangeFilter.bind(this, 'amountMax'),\n        onBlur: this.formatAmount.bind(this, 'amountMax'),\n        onFocus: this.unformatAmount.bind(this, 'amountMax'),\n        selectAllOnFocus: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 706\n        },\n        __self: this\n      })));\n    }\n  }, {\n    key: \"renderStatus\",\n    value: function renderStatus() {\n      var _this5 = this;\n\n      var _this$state5 = this.state,\n          statusOpen = _this$state5.statusOpen,\n          filters = _this$state5.filters;\n      return React.createElement(\"div\", {\n        className: \"flex-column\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 723\n        },\n        __self: this\n      }, React.createElement(\"button\", {\n        onClick: this.toggleFiltersOpen.bind(this, 'statusOpen'),\n        style: {\n          cursor: 'pointer'\n        },\n        className: \"subtitle-body flex-between\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 724\n        },\n        __self: this\n      }, \"Estado\", React.createElement(\"i\", {\n        className: classNames('mdi', {\n          'mdi-plus': !statusOpen,\n          'mdi-minus': statusOpen\n        }),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 730\n        },\n        __self: this\n      })), React.createElement(\"div\", {\n        className: classNames('control flex-column', {\n          'is-hidden': !statusOpen\n        }),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 737\n        },\n        __self: this\n      }, STATUS_FILTERS.map(function (_ref2) {\n        var value = _ref2.value,\n            label = _ref2.label,\n            className = _ref2.className;\n        return React.createElement(\"label\", {\n          key: \"status-\".concat(value),\n          className: \"radio \".concat(className),\n          htmlFor: \"filterStatus-\".concat(_kebabCase(value)),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 743\n          },\n          __self: this\n        }, React.createElement(\"input\", {\n          id: \"filterStatus-\".concat(_kebabCase(value)),\n          type: \"radio\",\n          onChange: _this5.onChangeFilter.bind(_this5, 'status'),\n          checked: filters.status === value,\n          value: value,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 748\n          },\n          __self: this\n        }), \"\\xA0\", label);\n      })));\n    }\n  }, {\n    key: \"renderExportButton\",\n    value: function renderExportButton(_ref3) {\n      var _this6 = this;\n\n      var icon = _ref3.icon,\n          label = _ref3.label,\n          format = _ref3.format;\n      var _this$state6 = this.state,\n          totalItems = _this$state6.totalItems,\n          remainingDownloads = _this$state6.remainingDownloads,\n          updatePlanModal = _this$state6.updatePlanModal;\n      var disabledExportButton = totalItems > 500;\n      var noMoreDowloads = remainingDownloads === 0 && format === 'invoice_excel';\n      return React.createElement(ExportButton, {\n        totalItems: totalItems,\n        label: label,\n        key: label,\n        disabled: disabledExportButton,\n        icon: icon,\n        onClick: noMoreDowloads ? function () {\n          return toggleUpdatePlanModal(_this6, updatePlanModal, 'descargas de PDF');\n        } : function () {\n          return _this6.exportTo(format);\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 770\n        },\n        __self: this\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this7 = this;\n\n      var _this$state7 = this.state,\n          totalItems = _this$state7.totalItems,\n          filters = _this$state7.filters,\n          remainingDownloads = _this$state7.remainingDownloads,\n          showBannerIncomes = _this$state7.showBannerIncomes,\n          showBannerModal = _this$state7.showBannerModal;\n      var showBannerIncome = windowGlobal.localStorage.showBannerIncome;\n      var plan = getClientsPlan();\n      var showEmailCounter = plan === 'free' && showBannerIncome !== 'seen' && showBannerIncomes;\n      return React.createElement(Fragment, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 799\n        },\n        __self: this\n      }, React.createElement(CredentialsExpire, {\n        fiel: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 800\n        },\n        __self: this\n      }), React.createElement(\"div\", {\n        className: \"flex-between\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 801\n        },\n        __self: this\n      }, React.createElement(\"h1\", {\n        className: \"headline\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 802\n        },\n        __self: this\n      }, \"Ingresos\"), React.createElement(\"div\", {\n        className: \"flex-column\",\n        style: {\n          display: 'inline-block'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 803\n        },\n        __self: this\n      }, EXPORT_BUTTONS.map(this.renderExportButton.bind(this)), React.createElement(\"p\", {\n        className: classNames('caption', {\n          'is-hidden': totalItems < 500\n        }),\n        style: {\n          padding: '0.5rem 1rem'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 805\n        },\n        __self: this\n      }, \"(Se debe aplicar un filtro para poder exportar las facturas)\"))), React.createElement(Card, {\n        searchbar: {\n          value: filters.sat_folio,\n          placeholder: 'Buscar por Folio Fiscal',\n          onEnter: this.onSearchInvoice.bind(this),\n          onChange: this.onChangeFilter.bind(this, 'sat_folio')\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 815\n        },\n        __self: this\n      }, React.createElement(TableFilter, {\n        onOpenFilters: function onOpenFilters() {\n          ReactGa.event(createGaEvent('ingresos', 'click on button', 'filtrar tabla toggle'));\n\n          _this7.setState({\n            formQuit: true\n          });\n        },\n        baseUrl: \"/ingresos\",\n        filters: filters,\n        prepareFilters: this.prepareFilters.bind(this),\n        onClearFilters: this.clearFilters.bind(this),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 823\n        },\n        __self: this\n      }, this.renderLegalName(), this.renderRfc(), this.renderDates(), this.renderAmount(), this.renderStatus()), showEmailCounter && React.createElement(Banner, {\n        color: 'blue',\n        buttonText: 'Mejora tu plan',\n        text: textIncomes(remainingDownloads),\n        controlBanner: function controlBanner() {\n          return toggleBanner(_this7, showBannerIncomes, 'showBannerIncome');\n        },\n        bannerAction: function bannerAction() {\n          return toggleBannerModal(_this7, showBannerModal);\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 846\n        },\n        __self: this\n      }), React.createElement(\"div\", {\n        className: \"flex-between\",\n        style: {\n          paddingBottom: '1rem'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 857\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"caption\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 858\n        },\n        __self: this\n      }, accounting.formatNumber(totalItems), \" facturas visibles\"), React.createElement(StatusLabel, {\n        type: \"income\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 861\n        },\n        __self: this\n      })), this.renderTable()), this.renderCategorySelector(), modalPlans(this), modalUpdatePlan(this));\n    }\n  }]);\n\n  return Income;\n}(Component);\n\nIncome.propTypes = {\n  location: PropTypes.shape({\n    search: PropTypes.object,\n    query: PropTypes.object\n  })\n};\nexport default Income;","map":{"version":3,"sources":["/Users/usuario-rtd/Desktop/widget-front/src/components/app/views/income/index.js"],"names":["React","Component","Fragment","PropTypes","browserHistory","Link","accounting","_debounce","classNames","AsyncCreatable","moment","ReactGa","_kebabCase","AppSignal","AppStorage","API","prettyDate","absolutify","createGaEvent","resetScroll","isDisabledInvoiceLabeling","askRemainingPlanDays","getClientsPlan","INVOICE_PAYMENT_STATUS","FORMATTED_SAT_CATEGORIES","Modal","TextField","Datepicker","SelectField","TableFilter","Paginator","Card","StatusIcon","IconButton","StatusLabel","ExportButton","CredentialsExpire","InvoicesActions","NotificationsActions","RestrictionsActions","InvoicesStore","RestrictionsStore","Banner","toggleBanner","textIncomes","toggleBannerModal","modalPlans","toggleUpdatePlanModal","modalUpdatePlan","EXPORT_SUCCESS_MESSAGE","EXPORT_ERROR_MESSAGE_1","windowGlobal","window","getCurrentState","invoices","getInvoices","totalPages","getTotalPages","totalItems","getTotalItems","remainingDownloads","getRemainingExcelDownloads","EXPORT_BUTTONS","icon","label","format","STATUS_FILTERS","value","className","DEFAULT_FILTERS","stamped","invoice_type","debouncedFetch","searchTerm","callback","CustomCategories","List","then","r","options","invoice_categories","map","cat","name","catch","err","Income","exportTo","params","Object","assign","props","location","query","state","event","error","exportInvoices","success","data","sort","sort_by","sort_direction","filters","sat_folio","startDate","subtract","endDate","status","legalName","rfc","amountType","category","amountMin","amountMax","modal","open","invoiceCategory","invoiceId","datesOpen","amountOpen","statusOpen","dataLoading","formQuit","showBannerIncomes","showBannerModal","updatePlanModal","_onChange","bind","addChangeListener","loadData","getRestrictions","prevProps","search","removeChangeListener","setState","field","prevState","e","target","setFilters","formatMoney","absAmountMin","absAmountMax","RFC_KEY","LEGAL_NAME_KEY","AMOUNT_MIN_KEY","AMOUNT_MAX_KEY","_filters","isAfter","toString","filtersSuccess","push","column","fontSize","id","invoice","find","successMessage","sat_category","toggleCategoryModal","Invoice","SetCategory","sendError","Create","invoice_category","setCategory","console","entityId","getCurrentEntity","renderTable","length","invoicesList","legal_name","payment_status","issue_date","subtotal","total","process","env","API_SERVER","API_PREFIX","version","sortBy","getIcon","width","page","select","createCategory","onChangeFilter","toggleFiltersOpen","cursor","formatAmount","unformatAmount","disabledExportButton","noMoreDowloads","showBannerIncome","localStorage","plan","showEmailCounter","display","renderExportButton","padding","placeholder","onEnter","onSearchInvoice","onChange","prepareFilters","clearFilters","renderLegalName","renderRfc","renderDates","renderAmount","renderStatus","paddingBottom","formatNumber","renderCategorySelector","propTypes","shape","object"],"mappings":"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","sourcesContent":["import React, { Component, Fragment } from 'react'\nimport PropTypes from 'prop-types'\nimport { browserHistory, Link } from 'react-router'\nimport accounting from 'accounting'\nimport _debounce from 'lodash/debounce'\nimport classNames from 'classnames'\nimport { AsyncCreatable } from 'react-select'\nimport moment from 'moment'\nimport ReactGa from 'react-ga'\nimport _kebabCase from 'lodash/kebabCase'\nimport AppSignal from 'appsignal'\nimport AppStorage from 'api/appStorage'\nimport API from 'api'\nimport {\n  prettyDate,\n  absolutify,\n  createGaEvent,\n  resetScroll,\n  isDisabledInvoiceLabeling,\n  askRemainingPlanDays,\n  getClientsPlan\n} from 'utils'\nimport { INVOICE_PAYMENT_STATUS, FORMATTED_SAT_CATEGORIES } from 'shared/catalogs'\n\nimport Modal from 'shared/modal'\nimport TextField from 'shared/textField'\nimport Datepicker from 'shared/datepicker'\nimport SelectField from 'shared/selectField'\nimport TableFilter from 'shared/tableFilter'\nimport Paginator from 'shared/paginator'\nimport Card from 'shared/card'\nimport StatusIcon from 'shared/statusIcon'\nimport IconButton from 'shared/iconButton'\nimport StatusLabel from 'shared/statusLabel'\nimport ExportButton from 'shared/exportButton'\nimport CredentialsExpire from 'shared/credentials'\n\nimport InvoicesActions from 'actions/invoices'\nimport NotificationsActions from 'actions/notifications'\nimport RestrictionsActions from 'actions/restrictions'\n\nimport InvoicesStore from 'stores/invoices'\nimport RestrictionsStore from 'stores/restrictions'\nimport Banner from 'shared/banner'\nimport {\n  toggleBanner,\n  textIncomes,\n  toggleBannerModal,\n  modalPlans,\n  toggleUpdatePlanModal,\n  modalUpdatePlan\n} from '../viewInvoice/utilsRestrictions'\n\nconst EXPORT_SUCCESS_MESSAGE =\n  'Se ha iniciado la generacion del archivo, estará listo en la seccion de Descargas en unos momentos.'\nconst EXPORT_ERROR_MESSAGE_1 =\n  'La selección debe tener al menos un registro, por favor intentelo de nuevo optimizando los filtros de búsqueda.'\n\nconst windowGlobal = typeof window !== 'undefined' && window\n\nfunction getCurrentState () {\n  return {\n    invoices: InvoicesStore.getInvoices('incomes'),\n    totalPages: InvoicesStore.getTotalPages('incomes'),\n    totalItems: InvoicesStore.getTotalItems('incomes'),\n    remainingDownloads: RestrictionsStore.getRemainingExcelDownloads()\n  }\n}\n\nconst EXPORT_BUTTONS = [\n  {\n    icon: 'file-excel',\n    label: 'Exportar a excel',\n    format: 'invoice_excel'\n  },\n  {\n    icon: 'file-xml',\n    label: 'Exportar a XML',\n    format: 'xml'\n  }\n]\n\nconst STATUS_FILTERS = [\n  {\n    value: 'pending_payment',\n    label: 'Por cobrar'\n  },\n  {\n    value: 'partially_paid',\n    label: 'Cobrada parcialmente',\n    className: 'is-marginless'\n  },\n  {\n    value: 'paid',\n    label: 'Cobrada',\n    className: 'is-marginless'\n  },\n  {\n    value: 'cancelled',\n    label: 'Cancelada',\n    className: 'is-marginless'\n  }\n]\n\nconst DEFAULT_FILTERS = {\n  stamped: true,\n  invoice_type: 'incomes'\n}\n\nconst debouncedFetch = _debounce((searchTerm, callback) => {\n  API.CustomCategories.List()\n    .then(r =>\n      callback(null, {\n        options: r.invoice_categories.map(cat => ({\n          value: cat.name,\n          label: cat.name\n        }))\n      })\n    )\n    .catch(r => callback(err)) // eslint-disable-line\n}, 700)\n\nclass Income extends Component {\n  constructor () {\n    super()\n    this.data = {\n      sort: {\n        sort_by: 'issue_date',\n        sort_direction: 'desc'\n      },\n      filters: {\n        sat_folio: '',\n        startDate: moment().subtract(1, 'M'),\n        endDate: moment(),\n        status: '',\n        legalName: '',\n        rfc: '',\n        amountType: 'subtotal',\n        category: '',\n        amountMin: 0,\n        amountMax: 0\n      },\n      modal: {\n        open: false,\n        invoiceCategory: null,\n        invoiceId: null\n      },\n      datesOpen: false,\n      amountOpen: false,\n      statusOpen: false,\n      dataLoading: true,\n      formQuit: false,\n      showBannerIncomes: true,\n      showBannerModal: false,\n      updatePlanModal: false\n    }\n\n    this.state = Object.assign({}, this.data, getCurrentState())\n    this._onChange = this._onChange.bind(this)\n  }\n\n  componentDidMount () {\n    InvoicesStore.addChangeListener(this._onChange)\n    RestrictionsStore.addChangeListener(this._onChange)\n    this.loadData()\n    askRemainingPlanDays()\n    RestrictionsActions.getRestrictions().catch(error => {\n      NotificationsActions.error(error)\n    })\n  }\n\n  componentDidUpdate (prevProps) {\n    if (this.props.location.search !== prevProps.location.search) {\n      this.loadData(this.props)\n    }\n    resetScroll()\n  }\n\n  componentWillUnmount () {\n    InvoicesStore.removeChangeListener(this._onChange)\n    RestrictionsStore.removeChangeListener(this._onChange)\n    if (this.state.formQuit) {\n      ReactGa.event(createGaEvent('ingresos', 'form quit'))\n    }\n  }\n\n  _onChange () {\n    const state = getCurrentState()\n    if (this.state.dataLoading) {\n      this.setState({ dataLoading: false, formQuit: false })\n      ReactGa.event(\n        createGaEvent(\n          'ingresos',\n          'result',\n          this.props.location.search,\n          state.totalItems\n        )\n      )\n    }\n    this.setState(state)\n  }\n\n  setFilters (field, value) {\n    this.setState(prevState => ({\n      filters: Object.assign({}, prevState.filters, {\n        [field]: value\n      })\n    }))\n  }\n\n  onChangeFilter (field, e) {\n    const value = e.target ? e.target.value : e\n    this.setFilters(field, value)\n  }\n\n  formatAmount (field) {\n    const value = accounting.formatMoney(\n      absolutify(this.state.filters[field]),\n      '$ '\n    )\n    this.setFilters(field, value)\n  }\n\n  unformatAmount (field) {\n    const value = absolutify(this.state.filters[field])\n    this.setFilters(field, value)\n  }\n\n  toggleFiltersOpen (field) {\n    this.setState(prevState => ({ [field]: !prevState[field] }))\n  }\n\n  prepareFilters (filters) {\n    ReactGa.event(createGaEvent('ingresos', 'click on button', 'filtrar tabla'))\n    const { datesOpen, amountOpen } = this.state\n    const {\n      legalName,\n      amountType,\n      rfc,\n      startDate,\n      endDate,\n      amountMin,\n      amountMax,\n      status\n    } = filters\n    const absAmountMin = absolutify(amountMin)\n    const absAmountMax = absolutify(amountMax)\n    const RFC_KEY = 'recipient_rfc'\n    const LEGAL_NAME_KEY = 'recipient_legal_name'\n    const AMOUNT_MIN_KEY = `${amountType}_range[min]`\n    const AMOUNT_MAX_KEY = `${amountType}_range[max]`\n    const _filters = {\n      [RFC_KEY]: rfc,\n      [LEGAL_NAME_KEY]: legalName,\n      status\n    }\n    if (datesOpen) {\n      if (startDate.isAfter(endDate, 'day')) {\n        ReactGa.event(\n          createGaEvent(\n            'ingresos',\n            'form error',\n            'fecha de inicio mayor a fecha de fin'\n          )\n        )\n        NotificationsActions.error(\n          'La fecha de inicio no puede ser mayor a la fecha de fin.'\n        )\n        return {}\n      }\n      Object.assign(_filters, {\n        'date_range[start]': moment(startDate).format('YYYY-MM-DD'),\n        'date_range[end]': moment(endDate).format('YYYY-MM-DD')\n      })\n    }\n    if (amountOpen) {\n      if (absAmountMin > absAmountMax) {\n        ReactGa.event(\n          createGaEvent(\n            'ingresos',\n            'form error',\n            'importe minimo mayor que maximo'\n          )\n        )\n        NotificationsActions.error(\n          'La cantidad mínima debe ser menor que la máxima.'\n        )\n        return {}\n      }\n      Object.assign(_filters, {\n        [AMOUNT_MIN_KEY]: absAmountMin.toString(),\n        [AMOUNT_MAX_KEY]: absAmountMax.toString()\n      })\n    }\n    this.setState({ dataLoading: true, filtersSuccess: false })\n\n    return _filters\n  }\n\n  clearFilters () {\n    ReactGa.event(\n      createGaEvent('ingresos', 'click on button', 'limpiar filtros')\n    )\n    this.setState({ filters: this.data.filters, dataLoading: true })\n  }\n\n  onSearchInvoice () {\n    browserHistory.push(`/ingresos?sat_folio=${this.state.filters.sat_folio}`)\n  }\n\n  loadData (props = this.props) {\n    const params = Object.assign(\n      {},\n      props.location.query,\n      this.state.sort,\n      DEFAULT_FILTERS\n    )\n    InvoicesActions.getInvoices(params)\n    this.setState(prevState => ({\n      filters: Object.assign({}, prevState.filters, params)\n    }))\n  }\n\n  exportTo = format => {\n    const params = Object.assign({}, this.props.location.query, DEFAULT_FILTERS)\n    const { totalItems } = this.state\n    if (totalItems > 500) {\n      ReactGa.event(\n        createGaEvent('ingresos', 'click on disabled button', format)\n      )\n    } else if (totalItems < 1) {\n      NotificationsActions.error(EXPORT_ERROR_MESSAGE_1)\n    } else {\n      ReactGa.event(createGaEvent('ingresos', 'click on button', format))\n      InvoicesActions.exportInvoices(params, format)\n        .then(r => NotificationsActions.success(EXPORT_SUCCESS_MESSAGE))\n        .catch(err => NotificationsActions.error(err))\n    }\n  }\n\n  sortBy (column) {\n    let { sort } = this.state\n    if (sort.sort_by === column) {\n      switch (sort.sort_direction) {\n        case 'asc':\n          sort.sort_direction = 'desc'\n          break\n        case 'desc':\n          sort.sort_direction = 'asc'\n          break\n      }\n    } else {\n      sort = {\n        sort_by: column,\n        sort_direction: 'asc'\n      }\n    }\n    this.setState({ sort }, this.loadData)\n  }\n\n  getIcon (column) {\n    const { sort } = this.state\n    return (\n      <i\n        style={{ fontSize: '1rem' }}\n        className={classNames('mdi', {\n          'mdi-chevron-down': sort.sort_direction === 'desc',\n          'mdi-chevron-up': sort.sort_direction === 'asc',\n          'mdi-unfold-more-horizontal': sort.sort_by !== column\n        })}\n      />\n    )\n  }\n\n  setCategory (id, category) {\n    const invoice = this.state.invoices.find(invoice => invoice.id === id)\n    let successMessage = 'Rubro asignado'\n    if (category === null) {\n      category = { value: null, label: null }\n      successMessage = 'Rubro retirado de la factura'\n      if (invoice.sat_category === null) {\n        this.toggleCategoryModal()\n        return\n      }\n    }\n    API.Invoice.SetCategory(id, { category: { sat_category: category.label } })\n      .then(r => {\n        NotificationsActions.success(successMessage)\n        this.toggleCategoryModal()\n        this.loadData()\n      })\n      .catch(error => {\n        AppSignal.sendError(error)\n        NotificationsActions.error('Error al asignar rubro')\n      })\n  }\n\n  createCategory (id, category) {\n    API.CustomCategories.Create({\n      invoice_category: {\n        name: category.value\n      }\n    })\n      .then(r => {\n        NotificationsActions.success(`Rubro creado: ${r.invoice_category.name}`)\n        this.setCategory(id, category)\n      })\n      .catch(r => {\n        NotificationsActions.error('Falla al crear rubro')\n        console.error(r)\n      })\n  }\n\n  toggleCategoryModal (id, category) {\n    this.setState(prevState => ({\n      modal: Object.assign({}, prevState.modal, {\n        open: !prevState.modal.open,\n        invoiceId: prevState.modal.open ? null : id,\n        invoiceCategory: {\n          value: prevState.modal.open ? null : category,\n          label: prevState.modal.open ? null : category\n        }\n      })\n    }))\n  }\n\n  renderTable () {\n    const entityId = AppStorage.getCurrentEntity().id\n    const { invoices, totalPages, sort } = this.state\n    let renderTable = (\n      <div className='block unselectable'>\n        <p>No hay facturas</p>\n      </div>\n    )\n    if (invoices.length > 0) {\n      let invoicesList = invoices.map(invoice => (\n        <tr key={invoice.id}>\n          <td className='align-left'>\n            <Link to={`/facturas/ver/${invoice.id}`}>{invoice.legal_name}</Link>\n          </td>\n          <td className='align-right table--actions'>\n            {invoice.payment_status !== 'cancelled'\n              ? invoice.sat_category\n              : null}\n            &nbsp;&nbsp;&nbsp;\n            <IconButton\n              icon='pencil'\n              tooltip='Modificar rubro'\n              onClick={this.toggleCategoryModal.bind(\n                this,\n                invoice.id,\n                invoice.sat_category\n              )}\n              disabled={isDisabledInvoiceLabeling(invoice.payment_status)}\n            />\n          </td>\n          <td className='nowrap'>\n            {invoice.issue_date\n              ? prettyDate(invoice.issue_date, false, true, false, '/')\n              : ''}\n          </td>\n          <td className='is-money'>\n            {accounting.formatMoney(invoice.subtotal, '', 2)}\n          </td>\n          <td className='is-money'>\n            {accounting.formatMoney(invoice.total, '', 2)}\n          </td>\n          <td>\n            <StatusIcon\n              className={INVOICE_PAYMENT_STATUS[invoice.payment_status]}\n            />\n          </td>\n          <td className='table--actions flex-center'>\n            <a\n              onClick={() => {\n                ReactGa.event(\n                  createGaEvent('ingresos', 'click on button', 'Descargar PDF')\n                )\n              }}\n              href={`${process.env.API_SERVER}${process.env.API_PREFIX}/pdfs/${invoice.id}/${entityId}`}\n              download\n            >\n              <IconButton icon='file-pdf' tooltip='Descargar PDF' />\n            </a>\n            {invoice.version === '3.3' && (\n              <Link to={`/facturas/nueva?invoice=${invoice.id}`}>\n                <IconButton icon='autorenew' tooltip='Reemitir factura' />\n              </Link>\n            )}\n          </td>\n        </tr>\n      ))\n      renderTable = (\n        <div>\n          <table className='table is-sortable'>\n            <thead>\n              <tr>\n                <th\n                  className={classNames('align-left', {\n                    'is-sorting': sort.sort_by === 'legal_name'\n                  })}\n                  onClick={this.sortBy.bind(this, 'legal_name')}\n                >\n                  Razón social {this.getIcon('legal_name')}\n                </th>\n                <th style={{ width: '8rem' }}>Rubro</th>\n                <th\n                  className={classNames({\n                    'is-sorting': sort.sort_by === 'issue_date'\n                  })}\n                  onClick={this.sortBy.bind(this, 'issue_date')}\n                  style={{ width: '8rem' }}\n                >\n                  Fecha {this.getIcon('issue_date')}\n                </th>\n                <th\n                  className={classNames('is-money', {\n                    'is-sorting': sort.sort_by === 'subtotal_cents'\n                  })}\n                  onClick={this.sortBy.bind(this, 'subtotal_cents')}\n                  style={{ width: '10rem' }}\n                >\n                  Subtotal {this.getIcon('subtotal_cents')}\n                </th>\n                <th\n                  className={classNames('is-money', {\n                    'is-sorting': sort.sort_by === 'total_cents'\n                  })}\n                  onClick={this.sortBy.bind(this, 'total_cents')}\n                  style={{ width: '10rem' }}\n                >\n                  Total {this.getIcon('total_cents')}\n                </th>\n                <th style={{ width: '5rem' }}>Estado</th>\n              </tr>\n            </thead>\n            <tbody>{invoicesList}</tbody>\n          </table>\n          <Paginator\n            onPageChanged={page =>\n              ReactGa.event(createGaEvent('ingresos', 'page changed', '', page))\n            }\n            totalPages={totalPages}\n            location={this.props.location}\n          />\n        </div>\n      )\n    }\n    return renderTable\n  }\n\n  renderCategorySelector () {\n    const { open, invoiceId } = this.state.modal\n    const select = open ? (\n      <AsyncCreatable\n        value={this.state.modal.invoiceCategory}\n        loadOptions={debouncedFetch}\n        clearable\n        placeholder='Selecciona un rubro'\n        loadingPlaceholder='Buscando'\n        searchPromptText='Buscar un rubro'\n        noResultsText='No encontrado'\n        promptTextCreator={label => `Crear rubro: ${label}`}\n        onChange={this.setCategory.bind(this, invoiceId)}\n        onNewOptionClick={this.createCategory.bind(this, invoiceId)}\n        ignoreAccents={false}\n        openOnFocus\n      />\n    ) : null\n    return (\n      <Modal\n        title='Rubro'\n        isActive={open}\n        toggleModal={this.toggleCategoryModal.bind(this)}\n        noFooter\n      >\n        <div className='espacio-xxlarge'>\n          {select}\n          <br />\n          <br />\n          <br />\n          <br />\n          <br />\n        </div>\n      </Modal>\n    )\n  }\n\n  renderLegalName () {\n    return (\n      <TextField\n        placeholder='Razón Social'\n        value={this.state.filters.legalName}\n        onChange={this.onChangeFilter.bind(this, 'legalName')}\n      />\n    )\n  }\n\n  renderRfc () {\n    return (\n      <TextField\n        placeholder='RFC'\n        value={this.state.filters.rfc}\n        onChange={this.onChangeFilter.bind(this, 'rfc')}\n      />\n    )\n  }\n\n  renderCategory () {\n    return (\n      <SelectField\n        placeholder='Rubro'\n        options={FORMATTED_SAT_CATEGORIES}\n        value={this.state.category}\n        onChange={this.onChangeFilter.bind(this, 'category')}\n      />\n    )\n  }\n\n  renderDates () {\n    const { datesOpen, filters } = this.state\n    return (\n      <div className='flex-column'>\n        <button\n          onClick={this.toggleFiltersOpen.bind(this, 'datesOpen')}\n          style={{ cursor: 'pointer' }}\n          className='subtitle-body flex-between'\n        >\n          Periodo\n          <i\n            className={classNames('mdi', {\n              'mdi-plus': !datesOpen,\n              'mdi-minus': datesOpen\n            })}\n          />\n        </button>\n        <div className={classNames({ 'is-hidden': !datesOpen })}>\n          <Datepicker\n            label='Del'\n            placeholder='Fecha inicio'\n            value={filters.startDate}\n            onChange={this.onChangeFilter.bind(this, 'startDate')}\n          />\n          <Datepicker\n            label='Al'\n            placeholder='Fecha fin'\n            value={filters.endDate}\n            onChange={this.onChangeFilter.bind(this, 'endDate')}\n          />\n        </div>\n      </div>\n    )\n  }\n\n  renderAmount () {\n    const { amountOpen, filters } = this.state\n    return (\n      <div>\n        <button\n          onClick={this.toggleFiltersOpen.bind(this, 'amountOpen')}\n          style={{ cursor: 'pointer' }}\n          className='subtitle-body flex-between'\n        >\n          Importe\n          <i\n            className={classNames('mdi', {\n              'mdi-plus': !amountOpen,\n              'mdi-minus': amountOpen\n            })}\n          />\n        </button>\n        <div\n          className={classNames('control flex-column', {\n            'is-hidden': !amountOpen\n          })}\n        >\n          <label className='radio' htmlFor='subtotal'>\n            <input\n              id='subtotal'\n              type='radio'\n              value='subtotal'\n              onChange={this.onChangeFilter.bind(this, 'amountType')}\n              checked={filters.amountType === 'subtotal'}\n            />\n            &nbsp;Subtotal\n          </label>\n          <label className='radio is-marginless' htmlFor='total'>\n            <input\n              id='total'\n              type='radio'\n              value='total'\n              onChange={this.onChangeFilter.bind(this, 'amountType')}\n              checked={filters.amountType === 'total'}\n            />\n            &nbsp;Total\n          </label>\n          <TextField\n            label='Desde'\n            placeholder='0.00'\n            value={filters.amountMin}\n            onChange={this.onChangeFilter.bind(this, 'amountMin')}\n            onBlur={this.formatAmount.bind(this, 'amountMin')}\n            onFocus={this.unformatAmount.bind(this, 'amountMin')}\n            selectAllOnFocus\n          />\n          <TextField\n            label='Hasta'\n            placeholder='0.00'\n            value={filters.amountMax}\n            onChange={this.onChangeFilter.bind(this, 'amountMax')}\n            onBlur={this.formatAmount.bind(this, 'amountMax')}\n            onFocus={this.unformatAmount.bind(this, 'amountMax')}\n            selectAllOnFocus\n          />\n        </div>\n      </div>\n    )\n  }\n\n  renderStatus () {\n    const { statusOpen, filters } = this.state\n    return (\n      <div className='flex-column'>\n        <button\n          onClick={this.toggleFiltersOpen.bind(this, 'statusOpen')}\n          style={{ cursor: 'pointer' }}\n          className='subtitle-body flex-between'\n        >\n          Estado\n          <i\n            className={classNames('mdi', {\n              'mdi-plus': !statusOpen,\n              'mdi-minus': statusOpen\n            })}\n          />\n        </button>\n        <div\n          className={classNames('control flex-column', {\n            'is-hidden': !statusOpen\n          })}\n        >\n          {STATUS_FILTERS.map(({ value, label, className }) => (\n            <label\n              key={`status-${value}`}\n              className={`radio ${className}`}\n              htmlFor={`filterStatus-${_kebabCase(value)}`}\n            >\n              <input\n                id={`filterStatus-${_kebabCase(value)}`}\n                type='radio'\n                onChange={this.onChangeFilter.bind(this, 'status')}\n                checked={filters.status === value}\n                value={value}\n              />\n              &nbsp;\n              {label}\n            </label>\n          ))}\n        </div>\n      </div>\n    )\n  }\n\n  renderExportButton ({ icon, label, format }) {\n    const { totalItems, remainingDownloads, updatePlanModal } = this.state\n    const disabledExportButton = totalItems > 500\n    const noMoreDowloads =\n      remainingDownloads === 0 && format === 'invoice_excel'\n    return (\n      <ExportButton\n        totalItems={totalItems}\n        label={label}\n        key={label}\n        disabled={disabledExportButton}\n        icon={icon}\n        onClick={\n          noMoreDowloads\n            ? () =>\n              toggleUpdatePlanModal(this, updatePlanModal, 'descargas de PDF')\n            : () => this.exportTo(format)\n        }\n      />\n    )\n  }\n\n  render () {\n    const {\n      totalItems,\n      filters,\n      remainingDownloads,\n      showBannerIncomes,\n      showBannerModal\n    } = this.state\n    const { showBannerIncome } = windowGlobal.localStorage\n    const plan = getClientsPlan()\n    const showEmailCounter =\n      plan === 'free' && showBannerIncome !== 'seen' && showBannerIncomes\n    return (\n      <Fragment>\n        <CredentialsExpire fiel />\n        <div className='flex-between'>\n          <h1 className='headline'>Ingresos</h1>\n          <div className='flex-column' style={{ display: 'inline-block' }}>\n            {EXPORT_BUTTONS.map(this.renderExportButton.bind(this))}\n            <p\n              className={classNames('caption', {\n                'is-hidden': totalItems < 500\n              })}\n              style={{ padding: '0.5rem 1rem' }}\n            >\n              (Se debe aplicar un filtro para poder exportar las facturas)\n            </p>\n          </div>\n        </div>\n        <Card\n          searchbar={{\n            value: filters.sat_folio,\n            placeholder: 'Buscar por Folio Fiscal',\n            onEnter: this.onSearchInvoice.bind(this),\n            onChange: this.onChangeFilter.bind(this, 'sat_folio')\n          }}\n        >\n          <TableFilter\n            onOpenFilters={() => {\n              ReactGa.event(\n                createGaEvent(\n                  'ingresos',\n                  'click on button',\n                  'filtrar tabla toggle'\n                )\n              )\n              this.setState({ formQuit: true })\n            }}\n            baseUrl='/ingresos'\n            filters={filters}\n            prepareFilters={this.prepareFilters.bind(this)}\n            onClearFilters={this.clearFilters.bind(this)}\n          >\n            {this.renderLegalName()}\n            {this.renderRfc()}\n            {this.renderDates()}\n            {this.renderAmount()}\n            {this.renderStatus()}\n          </TableFilter>\n          {showEmailCounter && (\n            <Banner\n              color={'blue'}\n              buttonText={'Mejora tu plan'}\n              text={textIncomes(remainingDownloads)}\n              controlBanner={() =>\n                toggleBanner(this, showBannerIncomes, 'showBannerIncome')\n              }\n              bannerAction={() => toggleBannerModal(this, showBannerModal)}\n            />\n          )}\n\n          <div className='flex-between' style={{ paddingBottom: '1rem' }}>\n            <div className='caption'>\n              {accounting.formatNumber(totalItems)} facturas visibles\n            </div>\n            <StatusLabel type='income' />\n          </div>\n          {this.renderTable()}\n        </Card>\n        {this.renderCategorySelector()}\n        {modalPlans(this)}\n        {modalUpdatePlan(this)}\n      </Fragment>\n    )\n  }\n}\n\nIncome.propTypes = {\n  location: PropTypes.shape({\n    search: PropTypes.object,\n    query: PropTypes.object\n  })\n}\n\nexport default Income\n"]},"metadata":{},"sourceType":"module"}