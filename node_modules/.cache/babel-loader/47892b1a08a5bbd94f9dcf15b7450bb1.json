{"ast":null,"code":"import _toConsumableArray from \"/Users/usuario-rtd/Desktop/widget-front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _objectSpread from \"/Users/usuario-rtd/Desktop/widget-front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread\";\nimport _classCallCheck from \"/Users/usuario-rtd/Desktop/widget-front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/usuario-rtd/Desktop/widget-front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/usuario-rtd/Desktop/widget-front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/usuario-rtd/Desktop/widget-front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/usuario-rtd/Desktop/widget-front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/Users/usuario-rtd/Desktop/widget-front/src/components/app/shared/mainMenu/index.js\";\nimport React, { PureComponent } from 'react';\nimport PropTypes from 'prop-types';\nimport { Link } from 'react-router';\nimport classNames from 'classnames';\nimport ReactGa from 'react-ga';\nimport { createGaEvent, getClientsPlan } from 'utils';\nimport Button from 'shared/button';\nimport ButtonPlan from 'shared/buttonPlan';\nimport SessionActions from 'actions/session';\nimport SessionStore from 'stores/session'; // Items that will populate the sidebar\n\nvar MENU_ITEMS = [{\n  title: 'Inicio',\n  route: '/dashboard',\n  icon: 'mdi mdi-home-outline',\n  admin: false,\n  feature: 'default',\n  availableFor: ['free_premium', 'free', 'premium', 'integral_service']\n}, {\n  title: 'Ingresos',\n  route: '/ingresos',\n  icon: 'mdi mdi-import',\n  admin: false,\n  feature: 'default',\n  availableFor: ['free_premium', 'free', 'premium', 'integral_service']\n}, {\n  title: 'Gastos',\n  route: '/gastos',\n  icon: 'mdi mdi-export',\n  admin: false,\n  feature: 'default',\n  availableFor: ['free_premium', 'free', 'premium', 'integral_service']\n}, {\n  title: 'Mi Contabilidad',\n  route: '/mi-contabilidad',\n  icon: 'mdi mdi-file-table-outline',\n  admin: false,\n  feature: 'default',\n  availableFor: ['integral_service']\n},\n/* TODO: uncomment when finished */\n// {\n//   title: 'Inventarios',\n//   route: '/inventarios',\n//   icon: 'mdi mdi-inbox-multiple',\n//   admin: false,\n//   feature: 'inventory'\n// },\n{\n  title: 'Reportes',\n  route: '/reportes',\n  icon: 'mdi mdi-chart-bar',\n  admin: false,\n  feature: 'default',\n  availableFor: ['free_premium', 'premium', 'integral_service']\n}, {\n  title: 'Documentos',\n  route: '/documentos',\n  icon: 'mdi mdi-file-outline',\n  admin: false,\n  feature: 'default',\n  availableFor: ['free_premium', 'free', 'premium', 'integral_service']\n}, {\n  title: 'Facturas Enviadas',\n  route: '/emails',\n  icon: 'mdi mdi-email-check-outline',\n  admin: false,\n  feature: 'default',\n  availableFor: ['free_premium', 'free', 'premium', 'integral_service']\n}, {\n  title: 'Descargas',\n  route: '/descargas',\n  icon: 'mdi mdi-arrow-down-bold-circle-outline',\n  admin: false,\n  feature: 'default',\n  availableFor: ['free_premium', 'free', 'premium', 'integral_service']\n}, {\n  title: 'Entidades Fiscales',\n  route: '/admin/entidades_fiscales?status=client&platform_status=active',\n  icon: 'mdi mdi-account-switch',\n  admin: true,\n  feature: 'default',\n  availableFor: ['free_premium', 'free', 'premium', 'integral_service']\n}];\nvar MOBILE_MENU_ITEMS = [{\n  route: '/mi-cuenta/general',\n  icon: 'mdi mdi-account-edit',\n  title: 'Mi Cuenta',\n  availableFor: ['free_premium', 'free', 'premium', 'integral_service']\n}, {\n  route: '/entidades',\n  icon: 'mdi mdi-briefcase-account',\n  title: 'Mi Empresa',\n  availableFor: ['free_premium', 'free', 'premium', 'integral_service']\n}];\n\nvar getCurrentState = function getCurrentState() {\n  return {\n    features: SessionStore.getFeatures()\n  };\n};\n/**\n * This component will appear as a sidebar on desktop size, for small sizes it\n * is going to be hidden. It is handled by the small logo to show it.\n */\n\n\nvar Sidebar =\n/*#__PURE__*/\nfunction (_PureComponent) {\n  _inherits(Sidebar, _PureComponent);\n\n  function Sidebar() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, Sidebar);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(Sidebar)).call.apply(_getPrototypeOf2, [this].concat(args)));\n    _this.state = _objectSpread({\n      features: []\n    }, getCurrentState());\n\n    _this.componentWillUnmount = function () {\n      SessionStore.removeChangeListener(_this._onChange);\n      document.removeEventListener('mousedown', _this.handleClickOutside);\n    };\n\n    _this._onChange = function () {\n      _this.setState(getCurrentState());\n    };\n\n    _this.loadData = function () {\n      SessionActions.setFeatures();\n    };\n\n    _this.handleLinks = function (_ref) {\n      var title = _ref.title;\n      ReactGa.event(createGaEvent('inicio', 'click on button', title));\n\n      if (window.innerWidth < 1200) {\n        _this.props.toggleMenu();\n      }\n    };\n\n    _this.handleClickOutside = function (event) {\n      var _event$target$parentN = event.target.parentNode,\n          parentClass = _event$target$parentN.className,\n          tagName = _event$target$parentN.tagName;\n      var isLogo = tagName === 'DIV' ? parentClass.includes('enconta-logo ') : true;\n\n      if (_this.wrapperRef && !_this.wrapperRef.contains(event.target) && !isLogo) {\n        _this.props.toggleMenu();\n      }\n    };\n\n    _this.setWrapperRef = function (node) {\n      _this.wrapperRef = node;\n    };\n\n    _this.setUpUserMenu = function (features) {\n      return MENU_ITEMS.filter(function (item) {\n        var _SessionStore$getUser = SessionStore.getUser(),\n            role = _SessionStore$getUser.role;\n\n        var element = features.find(function (feature) {\n          return feature.key === item.feature;\n        });\n\n        if (element) {\n          return element.enabled && item;\n        }\n\n        if (role === 'account_holder') {\n          return item.feature === 'default' && !item.admin && item;\n        } else {\n          return item.feature === 'default' && item;\n        }\n      });\n    };\n\n    _this.renderMenuItem = function (item, index) {\n      var pathname = _this.props.pathname;\n      var menuOptions = pathname.split('/').filter(function (option) {\n        return option !== '';\n      });\n      var baseRouteOption = \"/\".concat(menuOptions[0]);\n      var plan = getClientsPlan();\n      var disabled = !item.availableFor.includes(plan);\n      return React.createElement(\"li\", {\n        className: classNames('main-menu__option', {\n          'main-menu__option--active': baseRouteOption.includes(item.route),\n          'main-menu__option--disabled': disabled\n        }),\n        key: index,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 194\n        },\n        __self: this\n      }, disabled ? React.createElement(\"div\", {\n        className: \"main-menu__link main-menu__link--disabled\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 202\n        },\n        __self: this\n      }, React.createElement(\"i\", {\n        className: \"\".concat(item.icon),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 203\n        },\n        __self: this\n      }), React.createElement(\"p\", {\n        className: \"main-menu__title\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 204\n        },\n        __self: this\n      }, item.title)) : React.createElement(Link, {\n        to: item.route,\n        onClick: function onClick() {\n          _this.handleLinks(item);\n        },\n        className: \"main-menu__link\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 207\n        },\n        __self: this\n      }, React.createElement(\"i\", {\n        className: \"\".concat(item.icon),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 214\n        },\n        __self: this\n      }), React.createElement(\"p\", {\n        className: \"main-menu__title\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 215\n        },\n        __self: this\n      }, item.title)));\n    };\n\n    _this.getLogOutButton = function () {\n      return React.createElement(Button, {\n        buttonStyle: \"encontaButton--main-menu-button\",\n        icon: \"logout\",\n        onClick: SessionActions.logout,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 224\n        },\n        __self: this\n      }, \"Cerrar Sesi\\xF3n\");\n    };\n\n    _this.addMobileItemsMenu = function (menu) {\n      var mobileOptions = MOBILE_MENU_ITEMS.map(function (item, index) {\n        return _this.renderMenuItem(item, index);\n      });\n\n      var logout = _this.getLogOutButton();\n\n      menu = [].concat(_toConsumableArray(menu), _toConsumableArray(mobileOptions));\n      menu.push(logout);\n      return menu;\n    };\n\n    _this.buildMenu = function (features) {\n      var enabledMenuItems = _this.setUpUserMenu(features);\n\n      var buildedMenu = enabledMenuItems.map(function (item, index) {\n        return _this.renderMenuItem(item, index);\n      });\n\n      if (window.innerWidth < 768) {\n        buildedMenu = _this.addMobileItemsMenu(buildedMenu);\n      }\n\n      return buildedMenu;\n    };\n\n    return _this;\n  }\n\n  _createClass(Sidebar, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      SessionStore.addChangeListener(this._onChange);\n      document.addEventListener('mousedown', this.handleClickOutside);\n      this.loadData();\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var features = this.state.features;\n      return React.createElement(\"nav\", {\n        className: \"main-menu\",\n        ref: this.setWrapperRef,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 266\n        },\n        __self: this\n      }, React.createElement(ButtonPlan, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 267\n        },\n        __self: this\n      }), React.createElement(\"ul\", {\n        className: \"main-menu__container\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 268\n        },\n        __self: this\n      }, this.buildMenu(features)));\n    }\n  }]);\n\n  return Sidebar;\n}(PureComponent);\n\nSidebar.propTypes = {\n  pathname: PropTypes.string.isRequired,\n  toggleMenu: PropTypes.func.isRequired\n};\nSidebar.defaultProps = {\n  pathname: '/',\n  toggleMenu: function toggleMenu() {}\n};\nexport default Sidebar;","map":{"version":3,"sources":["/Users/usuario-rtd/Desktop/widget-front/src/components/app/shared/mainMenu/index.js"],"names":["React","PureComponent","PropTypes","Link","classNames","ReactGa","createGaEvent","getClientsPlan","Button","ButtonPlan","SessionActions","SessionStore","MENU_ITEMS","title","route","icon","admin","feature","availableFor","MOBILE_MENU_ITEMS","getCurrentState","features","getFeatures","Sidebar","state","componentWillUnmount","removeChangeListener","_onChange","document","removeEventListener","handleClickOutside","setState","loadData","setFeatures","handleLinks","event","window","innerWidth","props","toggleMenu","target","parentNode","parentClass","className","tagName","isLogo","includes","wrapperRef","contains","setWrapperRef","node","setUpUserMenu","filter","item","getUser","role","element","find","key","enabled","renderMenuItem","index","pathname","menuOptions","split","option","baseRouteOption","plan","disabled","getLogOutButton","logout","addMobileItemsMenu","menu","mobileOptions","map","push","buildMenu","enabledMenuItems","buildedMenu","addChangeListener","addEventListener","propTypes","string","isRequired","func","defaultProps"],"mappings":";;;;;;;;AAAA,OAAOA,KAAP,IAAgBC,aAAhB,QAAqC,OAArC;AACA,OAAOC,SAAP,MAAsB,YAAtB;AACA,SAASC,IAAT,QAAqB,cAArB;AACA,OAAOC,UAAP,MAAuB,YAAvB;AACA,OAAOC,OAAP,MAAoB,UAApB;AACA,SAASC,aAAT,EAAwBC,cAAxB,QAA8C,OAA9C;AAEA,OAAOC,MAAP,MAAmB,eAAnB;AACA,OAAOC,UAAP,MAAuB,mBAAvB;AAEA,OAAOC,cAAP,MAA2B,iBAA3B;AAEA,OAAOC,YAAP,MAAyB,gBAAzB,C,CAEA;;AACA,IAAMC,UAAU,GAAG,CACjB;AACEC,EAAAA,KAAK,EAAE,QADT;AAEEC,EAAAA,KAAK,EAAE,YAFT;AAGEC,EAAAA,IAAI,EAAE,sBAHR;AAIEC,EAAAA,KAAK,EAAE,KAJT;AAKEC,EAAAA,OAAO,EAAE,SALX;AAMEC,EAAAA,YAAY,EAAE,CAAC,cAAD,EAAiB,MAAjB,EAAyB,SAAzB,EAAoC,kBAApC;AANhB,CADiB,EASjB;AACEL,EAAAA,KAAK,EAAE,UADT;AAEEC,EAAAA,KAAK,EAAE,WAFT;AAGEC,EAAAA,IAAI,EAAE,gBAHR;AAIEC,EAAAA,KAAK,EAAE,KAJT;AAKEC,EAAAA,OAAO,EAAE,SALX;AAMEC,EAAAA,YAAY,EAAE,CAAC,cAAD,EAAiB,MAAjB,EAAyB,SAAzB,EAAoC,kBAApC;AANhB,CATiB,EAiBjB;AACEL,EAAAA,KAAK,EAAE,QADT;AAEEC,EAAAA,KAAK,EAAE,SAFT;AAGEC,EAAAA,IAAI,EAAE,gBAHR;AAIEC,EAAAA,KAAK,EAAE,KAJT;AAKEC,EAAAA,OAAO,EAAE,SALX;AAMEC,EAAAA,YAAY,EAAE,CAAC,cAAD,EAAiB,MAAjB,EAAyB,SAAzB,EAAoC,kBAApC;AANhB,CAjBiB,EAyBjB;AACEL,EAAAA,KAAK,EAAE,iBADT;AAEEC,EAAAA,KAAK,EAAE,kBAFT;AAGEC,EAAAA,IAAI,EAAE,4BAHR;AAIEC,EAAAA,KAAK,EAAE,KAJT;AAKEC,EAAAA,OAAO,EAAE,SALX;AAMEC,EAAAA,YAAY,EAAE,CAAC,kBAAD;AANhB,CAzBiB;AAiCjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACEL,EAAAA,KAAK,EAAE,UADT;AAEEC,EAAAA,KAAK,EAAE,WAFT;AAGEC,EAAAA,IAAI,EAAE,mBAHR;AAIEC,EAAAA,KAAK,EAAE,KAJT;AAKEC,EAAAA,OAAO,EAAE,SALX;AAMEC,EAAAA,YAAY,EAAE,CAAC,cAAD,EAAiB,SAAjB,EAA4B,kBAA5B;AANhB,CAzCiB,EAiDjB;AACEL,EAAAA,KAAK,EAAE,YADT;AAEEC,EAAAA,KAAK,EAAE,aAFT;AAGEC,EAAAA,IAAI,EAAE,sBAHR;AAIEC,EAAAA,KAAK,EAAE,KAJT;AAKEC,EAAAA,OAAO,EAAE,SALX;AAMEC,EAAAA,YAAY,EAAE,CAAC,cAAD,EAAiB,MAAjB,EAAyB,SAAzB,EAAoC,kBAApC;AANhB,CAjDiB,EAyDjB;AACEL,EAAAA,KAAK,EAAE,mBADT;AAEEC,EAAAA,KAAK,EAAE,SAFT;AAGEC,EAAAA,IAAI,EAAE,6BAHR;AAIEC,EAAAA,KAAK,EAAE,KAJT;AAKEC,EAAAA,OAAO,EAAE,SALX;AAMEC,EAAAA,YAAY,EAAE,CAAC,cAAD,EAAiB,MAAjB,EAAyB,SAAzB,EAAoC,kBAApC;AANhB,CAzDiB,EAiEjB;AACEL,EAAAA,KAAK,EAAE,WADT;AAEEC,EAAAA,KAAK,EAAE,YAFT;AAGEC,EAAAA,IAAI,EAAE,wCAHR;AAIEC,EAAAA,KAAK,EAAE,KAJT;AAKEC,EAAAA,OAAO,EAAE,SALX;AAMEC,EAAAA,YAAY,EAAE,CAAC,cAAD,EAAiB,MAAjB,EAAyB,SAAzB,EAAoC,kBAApC;AANhB,CAjEiB,EAyEjB;AACEL,EAAAA,KAAK,EAAE,oBADT;AAEEC,EAAAA,KAAK,EAAE,gEAFT;AAGEC,EAAAA,IAAI,EAAE,wBAHR;AAIEC,EAAAA,KAAK,EAAE,IAJT;AAKEC,EAAAA,OAAO,EAAE,SALX;AAMEC,EAAAA,YAAY,EAAE,CAAC,cAAD,EAAiB,MAAjB,EAAyB,SAAzB,EAAoC,kBAApC;AANhB,CAzEiB,CAAnB;AAmFA,IAAMC,iBAAiB,GAAG,CACxB;AACEL,EAAAA,KAAK,EAAE,oBADT;AAEEC,EAAAA,IAAI,EAAE,sBAFR;AAGEF,EAAAA,KAAK,EAAE,WAHT;AAIEK,EAAAA,YAAY,EAAE,CAAC,cAAD,EAAiB,MAAjB,EAAyB,SAAzB,EAAoC,kBAApC;AAJhB,CADwB,EAOxB;AACEJ,EAAAA,KAAK,EAAE,YADT;AAEEC,EAAAA,IAAI,EAAE,2BAFR;AAGEF,EAAAA,KAAK,EAAE,YAHT;AAIEK,EAAAA,YAAY,EAAE,CAAC,cAAD,EAAiB,MAAjB,EAAyB,SAAzB,EAAoC,kBAApC;AAJhB,CAPwB,CAA1B;;AAeA,IAAME,eAAe,GAAG,SAAlBA,eAAkB;AAAA,SAAO;AAC7BC,IAAAA,QAAQ,EAAEV,YAAY,CAACW,WAAb;AADmB,GAAP;AAAA,CAAxB;AAIA;;;;;;IAIMC,O;;;;;;;;;;;;;;;;;UACJC,K;AAAUH,MAAAA,QAAQ,EAAE;OAAOD,eAAe,E;;UAQ1CK,oB,GAAuB,YAAM;AAC3Bd,MAAAA,YAAY,CAACe,oBAAb,CAAkC,MAAKC,SAAvC;AACAC,MAAAA,QAAQ,CAACC,mBAAT,CAA6B,WAA7B,EAA0C,MAAKC,kBAA/C;AACD,K;;UAEDH,S,GAAY,YAAM;AAChB,YAAKI,QAAL,CAAcX,eAAe,EAA7B;AACD,K;;UAEDY,Q,GAAW,YAAM;AACftB,MAAAA,cAAc,CAACuB,WAAf;AACD,K;;UAEDC,W,GAAc,gBAAe;AAAA,UAAZrB,KAAY,QAAZA,KAAY;AAC3BR,MAAAA,OAAO,CAAC8B,KAAR,CAAc7B,aAAa,CAAC,QAAD,EAAW,iBAAX,EAA8BO,KAA9B,CAA3B;;AACA,UAAIuB,MAAM,CAACC,UAAP,GAAoB,IAAxB,EAA8B;AAC5B,cAAKC,KAAL,CAAWC,UAAX;AACD;AACF,K;;UAEDT,kB,GAAqB,UAAAK,KAAK,EAAI;AAAA,kCACgBA,KAAK,CAACK,MAAN,CAAaC,UAD7B;AAAA,UACTC,WADS,yBACpBC,SADoB;AAAA,UACIC,OADJ,yBACIA,OADJ;AAE5B,UAAMC,MAAM,GACVD,OAAO,KAAK,KAAZ,GAAoBF,WAAW,CAACI,QAAZ,CAAqB,eAArB,CAApB,GAA4D,IAD9D;;AAGA,UAAI,MAAKC,UAAL,IAAmB,CAAC,MAAKA,UAAL,CAAgBC,QAAhB,CAAyBb,KAAK,CAACK,MAA/B,CAApB,IAA8D,CAACK,MAAnE,EAA2E;AACzE,cAAKP,KAAL,CAAWC,UAAX;AACD;AACF,K;;UAEDU,a,GAAgB,UAAAC,IAAI,EAAI;AACtB,YAAKH,UAAL,GAAkBG,IAAlB;AACD,K;;UAODC,a,GAAgB,UAAA9B,QAAQ,EAAI;AAC1B,aAAOT,UAAU,CAACwC,MAAX,CAAkB,UAAAC,IAAI,EAAI;AAAA,oCACd1C,YAAY,CAAC2C,OAAb,EADc;AAAA,YACvBC,IADuB,yBACvBA,IADuB;;AAE/B,YAAMC,OAAO,GAAGnC,QAAQ,CAACoC,IAAT,CAAc,UAAAxC,OAAO;AAAA,iBAAIA,OAAO,CAACyC,GAAR,KAAgBL,IAAI,CAACpC,OAAzB;AAAA,SAArB,CAAhB;;AAEA,YAAIuC,OAAJ,EAAa;AACX,iBAAOA,OAAO,CAACG,OAAR,IAAmBN,IAA1B;AACD;;AAED,YAAIE,IAAI,KAAK,gBAAb,EAA+B;AAC7B,iBAAOF,IAAI,CAACpC,OAAL,KAAiB,SAAjB,IAA8B,CAACoC,IAAI,CAACrC,KAApC,IAA6CqC,IAApD;AACD,SAFD,MAEO;AACL,iBAAOA,IAAI,CAACpC,OAAL,KAAiB,SAAjB,IAA8BoC,IAArC;AACD;AACF,OAbM,CAAP;AAcD,K;;UAEDO,c,GAAiB,UAACP,IAAD,EAAOQ,KAAP,EAAiB;AAAA,UACxBC,QADwB,GACX,MAAKxB,KADM,CACxBwB,QADwB;AAEhC,UAAMC,WAAW,GAAGD,QAAQ,CAACE,KAAT,CAAe,GAAf,EAAoBZ,MAApB,CAA2B,UAAAa,MAAM;AAAA,eAAIA,MAAM,KAAK,EAAf;AAAA,OAAjC,CAApB;AACA,UAAMC,eAAe,cAAOH,WAAW,CAAC,CAAD,CAAlB,CAArB;AACA,UAAMI,IAAI,GAAG5D,cAAc,EAA3B;AACA,UAAM6D,QAAQ,GAAG,CAACf,IAAI,CAACnC,YAAL,CAAkB4B,QAAlB,CAA2BqB,IAA3B,CAAlB;AACA,aACE;AACE,QAAA,SAAS,EAAE/D,UAAU,CAAC,mBAAD,EAAsB;AACzC,uCAA6B8D,eAAe,CAACpB,QAAhB,CAAyBO,IAAI,CAACvC,KAA9B,CADY;AAEzC,yCAA+BsD;AAFU,SAAtB,CADvB;AAKE,QAAA,GAAG,EAAEP,KALP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAOGO,QAAQ,GACP;AAAK,QAAA,SAAS,EAAC,2CAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE;AAAG,QAAA,SAAS,YAAKf,IAAI,CAACtC,IAAV,CAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QADF,EAEE;AAAG,QAAA,SAAS,EAAC,kBAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAAiCsC,IAAI,CAACxC,KAAtC,CAFF,CADO,GAMP,oBAAC,IAAD;AACE,QAAA,EAAE,EAAEwC,IAAI,CAACvC,KADX;AAEE,QAAA,OAAO,EAAE,mBAAM;AACb,gBAAKoB,WAAL,CAAiBmB,IAAjB;AACD,SAJH;AAKE,QAAA,SAAS,EAAC,iBALZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAOE;AAAG,QAAA,SAAS,YAAKA,IAAI,CAACtC,IAAV,CAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAPF,EAQE;AAAG,QAAA,SAAS,EAAC,kBAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAAiCsC,IAAI,CAACxC,KAAtC,CARF,CAbJ,CADF;AA2BD,K;;UAEDwD,e,GAAkB,YAAM;AACtB,aACE,oBAAC,MAAD;AACE,QAAA,WAAW,EAAC,iCADd;AAEE,QAAA,IAAI,EAAC,QAFP;AAGE,QAAA,OAAO,EAAE3D,cAAc,CAAC4D,MAH1B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,4BADF;AASD,K;;UAEDC,kB,GAAqB,UAAAC,IAAI,EAAI;AAC3B,UAAMC,aAAa,GAAGtD,iBAAiB,CAACuD,GAAlB,CAAsB,UAACrB,IAAD,EAAOQ,KAAP;AAAA,eAC1C,MAAKD,cAAL,CAAoBP,IAApB,EAA0BQ,KAA1B,CAD0C;AAAA,OAAtB,CAAtB;;AAGA,UAAMS,MAAM,GAAG,MAAKD,eAAL,EAAf;;AAEAG,MAAAA,IAAI,gCAAOA,IAAP,sBAAgBC,aAAhB,EAAJ;AACAD,MAAAA,IAAI,CAACG,IAAL,CAAUL,MAAV;AAEA,aAAOE,IAAP;AACD,K;;UAMDI,S,GAAY,UAAAvD,QAAQ,EAAI;AACtB,UAAMwD,gBAAgB,GAAG,MAAK1B,aAAL,CAAmB9B,QAAnB,CAAzB;;AACA,UAAIyD,WAAW,GAAGD,gBAAgB,CAACH,GAAjB,CAAqB,UAACrB,IAAD,EAAOQ,KAAP;AAAA,eACrC,MAAKD,cAAL,CAAoBP,IAApB,EAA0BQ,KAA1B,CADqC;AAAA,OAArB,CAAlB;;AAIA,UAAIzB,MAAM,CAACC,UAAP,GAAoB,GAAxB,EAA6B;AAC3ByC,QAAAA,WAAW,GAAG,MAAKP,kBAAL,CAAwBO,WAAxB,CAAd;AACD;;AAED,aAAOA,WAAP;AACD,K;;;;;;;wCAxIoB;AACnBnE,MAAAA,YAAY,CAACoE,iBAAb,CAA+B,KAAKpD,SAApC;AACAC,MAAAA,QAAQ,CAACoD,gBAAT,CAA0B,WAA1B,EAAuC,KAAKlD,kBAA5C;AACA,WAAKE,QAAL;AACD;;;6BAsIS;AAAA,UACAX,QADA,GACa,KAAKG,KADlB,CACAH,QADA;AAER,aACE;AAAK,QAAA,SAAS,EAAC,WAAf;AAA2B,QAAA,GAAG,EAAE,KAAK4B,aAArC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE,oBAAC,UAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QADF,EAEE;AAAI,QAAA,SAAS,EAAC,sBAAd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAAsC,KAAK2B,SAAL,CAAevD,QAAf,CAAtC,CAFF,CADF;AAMD;;;;EArJmBpB,a;;AAwJtBsB,OAAO,CAAC0D,SAAR,GAAoB;AAClBnB,EAAAA,QAAQ,EAAE5D,SAAS,CAACgF,MAAV,CAAiBC,UADT;AAElB5C,EAAAA,UAAU,EAAErC,SAAS,CAACkF,IAAV,CAAeD;AAFT,CAApB;AAKA5D,OAAO,CAAC8D,YAAR,GAAuB;AACrBvB,EAAAA,QAAQ,EAAE,GADW;AAErBvB,EAAAA,UAAU,EAAE,sBAAM,CAAE;AAFC,CAAvB;AAKA,eAAehB,OAAf","sourcesContent":["import React, { PureComponent } from 'react'\nimport PropTypes from 'prop-types'\nimport { Link } from 'react-router'\nimport classNames from 'classnames'\nimport ReactGa from 'react-ga'\nimport { createGaEvent, getClientsPlan } from 'utils'\n\nimport Button from 'shared/button'\nimport ButtonPlan from 'shared/buttonPlan'\n\nimport SessionActions from 'actions/session'\n\nimport SessionStore from 'stores/session'\n\n// Items that will populate the sidebar\nconst MENU_ITEMS = [\n  {\n    title: 'Inicio',\n    route: '/dashboard',\n    icon: 'mdi mdi-home-outline',\n    admin: false,\n    feature: 'default',\n    availableFor: ['free_premium', 'free', 'premium', 'integral_service']\n  },\n  {\n    title: 'Ingresos',\n    route: '/ingresos',\n    icon: 'mdi mdi-import',\n    admin: false,\n    feature: 'default',\n    availableFor: ['free_premium', 'free', 'premium', 'integral_service']\n  },\n  {\n    title: 'Gastos',\n    route: '/gastos',\n    icon: 'mdi mdi-export',\n    admin: false,\n    feature: 'default',\n    availableFor: ['free_premium', 'free', 'premium', 'integral_service']\n  },\n  {\n    title: 'Mi Contabilidad',\n    route: '/mi-contabilidad',\n    icon: 'mdi mdi-file-table-outline',\n    admin: false,\n    feature: 'default',\n    availableFor: ['integral_service']\n  },\n  /* TODO: uncomment when finished */\n  // {\n  //   title: 'Inventarios',\n  //   route: '/inventarios',\n  //   icon: 'mdi mdi-inbox-multiple',\n  //   admin: false,\n  //   feature: 'inventory'\n  // },\n  {\n    title: 'Reportes',\n    route: '/reportes',\n    icon: 'mdi mdi-chart-bar',\n    admin: false,\n    feature: 'default',\n    availableFor: ['free_premium', 'premium', 'integral_service']\n  },\n  {\n    title: 'Documentos',\n    route: '/documentos',\n    icon: 'mdi mdi-file-outline',\n    admin: false,\n    feature: 'default',\n    availableFor: ['free_premium', 'free', 'premium', 'integral_service']\n  },\n  {\n    title: 'Facturas Enviadas',\n    route: '/emails',\n    icon: 'mdi mdi-email-check-outline',\n    admin: false,\n    feature: 'default',\n    availableFor: ['free_premium', 'free', 'premium', 'integral_service']\n  },\n  {\n    title: 'Descargas',\n    route: '/descargas',\n    icon: 'mdi mdi-arrow-down-bold-circle-outline',\n    admin: false,\n    feature: 'default',\n    availableFor: ['free_premium', 'free', 'premium', 'integral_service']\n  },\n  {\n    title: 'Entidades Fiscales',\n    route: '/admin/entidades_fiscales?status=client&platform_status=active',\n    icon: 'mdi mdi-account-switch',\n    admin: true,\n    feature: 'default',\n    availableFor: ['free_premium', 'free', 'premium', 'integral_service']\n  }\n]\n\nconst MOBILE_MENU_ITEMS = [\n  {\n    route: '/mi-cuenta/general',\n    icon: 'mdi mdi-account-edit',\n    title: 'Mi Cuenta',\n    availableFor: ['free_premium', 'free', 'premium', 'integral_service']\n  },\n  {\n    route: '/entidades',\n    icon: 'mdi mdi-briefcase-account',\n    title: 'Mi Empresa',\n    availableFor: ['free_premium', 'free', 'premium', 'integral_service']\n  }\n]\n\nconst getCurrentState = () => ({\n  features: SessionStore.getFeatures()\n})\n\n/**\n * This component will appear as a sidebar on desktop size, for small sizes it\n * is going to be hidden. It is handled by the small logo to show it.\n */\nclass Sidebar extends PureComponent {\n  state = { features: [], ...getCurrentState() }\n\n  componentDidMount () {\n    SessionStore.addChangeListener(this._onChange)\n    document.addEventListener('mousedown', this.handleClickOutside)\n    this.loadData()\n  }\n\n  componentWillUnmount = () => {\n    SessionStore.removeChangeListener(this._onChange)\n    document.removeEventListener('mousedown', this.handleClickOutside)\n  }\n\n  _onChange = () => {\n    this.setState(getCurrentState())\n  }\n\n  loadData = () => {\n    SessionActions.setFeatures()\n  }\n\n  handleLinks = ({ title }) => {\n    ReactGa.event(createGaEvent('inicio', 'click on button', title))\n    if (window.innerWidth < 1200) {\n      this.props.toggleMenu()\n    }\n  }\n\n  handleClickOutside = event => {\n    const { className: parentClass, tagName } = event.target.parentNode\n    const isLogo =\n      tagName === 'DIV' ? parentClass.includes('enconta-logo ') : true\n\n    if (this.wrapperRef && !this.wrapperRef.contains(event.target) && !isLogo) {\n      this.props.toggleMenu()\n    }\n  }\n\n  setWrapperRef = node => {\n    this.wrapperRef = node\n  }\n\n  /**\n   * Builds dynamically the client's menu, if the feature exists it will be shown\n   * otherwise adds the default features if doesn't admin only\n   * @param {array} features\n   */\n  setUpUserMenu = features => {\n    return MENU_ITEMS.filter(item => {\n      const { role } = SessionStore.getUser()\n      const element = features.find(feature => feature.key === item.feature)\n\n      if (element) {\n        return element.enabled && item\n      }\n\n      if (role === 'account_holder') {\n        return item.feature === 'default' && !item.admin && item\n      } else {\n        return item.feature === 'default' && item\n      }\n    })\n  }\n\n  renderMenuItem = (item, index) => {\n    const { pathname } = this.props\n    const menuOptions = pathname.split('/').filter(option => option !== '')\n    const baseRouteOption = `/${menuOptions[0]}`\n    const plan = getClientsPlan()\n    const disabled = !item.availableFor.includes(plan)\n    return (\n      <li\n        className={classNames('main-menu__option', {\n          'main-menu__option--active': baseRouteOption.includes(item.route),\n          'main-menu__option--disabled': disabled\n        })}\n        key={index}\n      >\n        {disabled ? (\n          <div className='main-menu__link main-menu__link--disabled'>\n            <i className={`${item.icon}`} />\n            <p className='main-menu__title'>{item.title}</p>\n          </div>\n        ) : (\n          <Link\n            to={item.route}\n            onClick={() => {\n              this.handleLinks(item)\n            }}\n            className='main-menu__link'\n          >\n            <i className={`${item.icon}`} />\n            <p className='main-menu__title'>{item.title}</p>\n          </Link>\n        )}\n      </li>\n    )\n  }\n\n  getLogOutButton = () => {\n    return (\n      <Button\n        buttonStyle='encontaButton--main-menu-button'\n        icon='logout'\n        onClick={SessionActions.logout}\n      >\n        Cerrar Sesión\n      </Button>\n    )\n  }\n\n  addMobileItemsMenu = menu => {\n    const mobileOptions = MOBILE_MENU_ITEMS.map((item, index) =>\n      this.renderMenuItem(item, index)\n    )\n    const logout = this.getLogOutButton()\n\n    menu = [...menu, ...mobileOptions]\n    menu.push(logout)\n\n    return menu\n  }\n\n  /**\n   * Builds the main menu according to features activated and screen size\n   * @param  {Array} features\n   */\n  buildMenu = features => {\n    const enabledMenuItems = this.setUpUserMenu(features)\n    let buildedMenu = enabledMenuItems.map((item, index) =>\n      this.renderMenuItem(item, index)\n    )\n\n    if (window.innerWidth < 768) {\n      buildedMenu = this.addMobileItemsMenu(buildedMenu)\n    }\n\n    return buildedMenu\n  }\n\n  render () {\n    const { features } = this.state\n    return (\n      <nav className='main-menu' ref={this.setWrapperRef}>\n        <ButtonPlan />\n        <ul className='main-menu__container'>{this.buildMenu(features)}</ul>\n      </nav>\n    )\n  }\n}\n\nSidebar.propTypes = {\n  pathname: PropTypes.string.isRequired,\n  toggleMenu: PropTypes.func.isRequired\n}\n\nSidebar.defaultProps = {\n  pathname: '/',\n  toggleMenu: () => {}\n}\n\nexport default Sidebar\n"]},"metadata":{},"sourceType":"module"}