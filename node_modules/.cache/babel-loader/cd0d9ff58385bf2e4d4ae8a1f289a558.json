{"ast":null,"code":"import _defineProperty from \"/Users/usuario-rtd/Desktop/widget-front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _classCallCheck from \"/Users/usuario-rtd/Desktop/widget-front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/usuario-rtd/Desktop/widget-front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/usuario-rtd/Desktop/widget-front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/usuario-rtd/Desktop/widget-front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/usuario-rtd/Desktop/widget-front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/Users/usuario-rtd/Desktop/widget-front/src/components/app/views/invoiceConcepts/new/index.js\";\n// Libraries\nimport React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport { Link } from 'react-router';\nimport classNames from 'classnames';\nimport validator from 'validator';\nimport update from 'immutability-helper';\nimport Button from 'shared/button'; // Catalogs\n\nimport { SAT_CATEGORIES } from 'shared/catalogs'; // Constants\n\nvar CATEGORY_CATALOG_START = 1;\nvar CATEGORY_ID_POSITION = 0;\nvar CATEGORY_LEVEL_POSITION = 1;\nvar CATEGORY_GROUPING_CODE_POSITION = 2;\nvar CATEGORY_NAME_POSITION = 3;\nvar CATEGORY_ANCESTRY_POSITION = 4;\nvar CATEGORY_LABEL_ID = 'id';\nvar CATEGORY_LABEL_LEVEL = 'level';\nvar CATEGORY_LABEL_GROUPING_CODE = 'grouping_code';\nvar CATEGORY_LABEL_NAME = 'name';\nvar CATEGORY_LABEL_ANCESTRY = 'ancestry';\n\nvar NewInvoiceConcept =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(NewInvoiceConcept, _Component);\n\n  function NewInvoiceConcept(props) {\n    var _this;\n\n    _classCallCheck(this, NewInvoiceConcept);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(NewInvoiceConcept).call(this, props));\n    _this.data = {\n      title: 'New Invoice Concept',\n      isUpdate: props.location.pathname !== '/admin/rubros/nuevo',\n      requestInProgress: false,\n      form: {\n        name: '',\n        kind: 'expense',\n        category: -1\n      },\n      isValid: {\n        name: true,\n        category: true\n      },\n      categories: []\n    };\n    _this.state = Object.assign({}, _this.data);\n    return _this;\n  }\n\n  _createClass(NewInvoiceConcept, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this.getCategories();\n    }\n  }, {\n    key: \"getCategories\",\n    value: function getCategories() {\n      var categories = [];\n\n      for (var i = CATEGORY_CATALOG_START; i < SAT_CATEGORIES.length; i++) {\n        var _categories$push;\n\n        categories.push((_categories$push = {}, _defineProperty(_categories$push, CATEGORY_LABEL_ID, SAT_CATEGORIES[i][CATEGORY_ID_POSITION]), _defineProperty(_categories$push, CATEGORY_LABEL_LEVEL, SAT_CATEGORIES[i][CATEGORY_LEVEL_POSITION]), _defineProperty(_categories$push, CATEGORY_LABEL_GROUPING_CODE, SAT_CATEGORIES[i][CATEGORY_GROUPING_CODE_POSITION]), _defineProperty(_categories$push, CATEGORY_LABEL_NAME, SAT_CATEGORIES[i][CATEGORY_NAME_POSITION]), _defineProperty(_categories$push, CATEGORY_LABEL_ANCESTRY, SAT_CATEGORIES[i][CATEGORY_ANCESTRY_POSITION] || ''), _categories$push));\n      }\n\n      this.setState({\n        categories: categories\n      });\n    }\n  }, {\n    key: \"sendData\",\n    value: function sendData(e) {\n      e.preventDefault();\n\n      if (this.isValidFormName() && this.isValidCategory() && !this.state.requestInProgress) {\n        this.setState({\n          requestInProgress: true\n        }, function () {\n          this.setState({\n            requestInProgress: false\n          });\n        });\n      }\n    }\n  }, {\n    key: \"onChangeFormName\",\n    value: function onChangeFormName(e) {\n      this.setState({\n        form: update(this.state.form, {\n          name: {\n            $set: e.target.value\n          }\n        })\n      });\n      if (!this.state.isValid.name) this.isValidFormName();\n    }\n  }, {\n    key: \"setFormCategory\",\n    value: function setFormCategory(e) {\n      var categoryValue = 0;\n\n      for (var i = CATEGORY_CATALOG_START; i < this.state.categories.length; i++) {\n        if (this.state.categories[i][CATEGORY_LABEL_ID] === Number(e.target.value)) {\n          categoryValue = Number(e.target.value);\n        }\n      }\n\n      if (categoryValue !== 0) {\n        this.setState({\n          form: update(this.state.form, {\n            category: {\n              $set: categoryValue\n            }\n          })\n        });\n      }\n    }\n  }, {\n    key: \"setFormKind\",\n    value: function setFormKind(e) {\n      e.preventDefault();\n      this.setState({\n        form: update(this.state.form, {\n          kind: {\n            $set: e.target.value\n          }\n        })\n      });\n    }\n  }, {\n    key: \"isValidFormName\",\n    value: function isValidFormName() {\n      var isValid = validator.isLength(this.state.form.name, 2);\n      this.setState({\n        isValid: update(this.state.isValid, {\n          name: {\n            $set: isValid\n          }\n        })\n      });\n      return isValid;\n    }\n  }, {\n    key: \"isValidCategory\",\n    value: function isValidCategory() {\n      var isValid = !validator.equals(String(this.state.form.category), '-1');\n      this.setState({\n        isValid: update(this.state.isValid, {\n          category: {\n            $set: isValid\n          }\n        })\n      });\n      return isValid;\n    }\n  }, {\n    key: \"renderCategories\",\n    value: function renderCategories() {\n      var categories = null;\n      var mainLabel = 'No hay categorías';\n\n      if (this.state.categories.length > 0) {\n        mainLabel = 'Selecciona una categoría del SAT';\n        categories = this.state.categories.map(function (category, index) {\n          return React.createElement(\"option\", {\n            key: category.id,\n            value: category.id,\n            disabled: category.ancestry === '',\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 143\n            },\n            __self: this\n          }, category.grouping_code + ' - ' + category.name);\n        });\n      }\n\n      var renderCategories = React.createElement(\"label\", {\n        className: \"caption\",\n        htmlFor: \"category\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 154\n        },\n        __self: this\n      }, \"Categor\\xEDas del SAT\", React.createElement(\"select\", {\n        id: \"category\",\n        value: this.state.form.category,\n        className: classNames('input', {\n          'is-danger': !this.state.isValid.category\n        }),\n        onChange: this.setFormCategory.bind(this),\n        onBlur: this.isValidCategory.bind(this),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 156\n        },\n        __self: this\n      }, React.createElement(\"option\", {\n        value: \"\",\n        disabled: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 165\n        },\n        __self: this\n      }, mainLabel), categories));\n      return renderCategories;\n    }\n  }, {\n    key: \"renderKind\",\n    value: function renderKind() {\n      return React.createElement(\"label\", {\n        className: \"caption\",\n        htmlFor: \"kind\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 177\n        },\n        __self: this\n      }, \"Tipo de factura\", React.createElement(\"select\", {\n        id: \"kind\",\n        value: this.state.form.kind,\n        onBlur: this.setFormKind.bind(this),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 179\n        },\n        __self: this\n      }, React.createElement(\"option\", {\n        value: \"income\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 184\n        },\n        __self: this\n      }, \"Ingreso\"), React.createElement(\"option\", {\n        value: \"expense\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 185\n        },\n        __self: this\n      }, \"Egreso\")));\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var title = this.state.isUpdate ? 'Update ' + this.state.title : this.state.title;\n      return React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 197\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"columns\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 198\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"column\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 199\n        },\n        __self: this\n      }, React.createElement(\"h2\", {\n        className: \"title is-5\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 200\n        },\n        __self: this\n      }, title), React.createElement(\"hr\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 201\n        },\n        __self: this\n      }), React.createElement(\"form\", {\n        className: \"login-content\",\n        onSubmit: this.sendData.bind(this),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 202\n        },\n        __self: this\n      }, React.createElement(\"p\", {\n        className: \"control\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 203\n        },\n        __self: this\n      }, React.createElement(\"label\", {\n        className: \"caption\",\n        htmlFor: \"name\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 204\n        },\n        __self: this\n      }, \"Nombre\", React.createElement(\"input\", {\n        id: \"name\",\n        className: classNames('input', {\n          'is-danger': !this.state.isValid.name\n        }),\n        type: \"text\",\n        placeholder: \"Nombre\",\n        value: this.state.form.name,\n        onChange: this.onChangeFormName.bind(this),\n        onBlur: this.isValidFormName.bind(this),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 206\n        },\n        __self: this\n      })), React.createElement(\"span\", {\n        className: classNames('help', 'is-danger', {\n          'is-hidden': this.state.isValid.name\n        }),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 218\n        },\n        __self: this\n      }, \"M\\xEDnimo 2 caracteres\")), React.createElement(\"div\", {\n        className: \"control\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 226\n        },\n        __self: this\n      }, React.createElement(\"span\", {\n        className: \"select is-fullwidth\",\n        style: {\n          height: '4em'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 227\n        },\n        __self: this\n      }, this.renderKind())), React.createElement(\"div\", {\n        className: \"control\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 231\n        },\n        __self: this\n      }, React.createElement(\"span\", {\n        className: \"select is-fullwidth\",\n        style: {\n          height: '4em'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 232\n        },\n        __self: this\n      }, this.renderCategories()), React.createElement(\"span\", {\n        className: classNames('help', 'is-danger', {\n          'is-hidden': this.state.isValid.category\n        }),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 235\n        },\n        __self: this\n      }, \"Selecciona una categor\\xEDa\")), React.createElement(\"div\", {\n        className: \"control is-grouped\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 243\n        },\n        __self: this\n      }, React.createElement(\"p\", {\n        className: \"control\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 244\n        },\n        __self: this\n      }, React.createElement(Link, {\n        to: \"/admin/rubros\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 245\n        },\n        __self: this\n      }, React.createElement(Button, {\n        buttonStyle: \"dangerInv\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 246\n        },\n        __self: this\n      }, \"Cancelar\"))), React.createElement(\"p\", {\n        className: \"control\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 249\n        },\n        __self: this\n      }, React.createElement(Button, {\n        buttonStyle: \"primary\",\n        icon: \"content-save\",\n        loading: this.state.requestInProgress,\n        disabled: !this.state.isValid.name || !this.state.isValid.category,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 250\n        },\n        __self: this\n      }, \"Guardar\")))))));\n    }\n  }]);\n\n  return NewInvoiceConcept;\n}(Component);\n\nNewInvoiceConcept.propTypes = {\n  location: PropTypes.shape({\n    pathname: PropTypes.string\n  })\n};\nexport default NewInvoiceConcept;","map":{"version":3,"sources":["/Users/usuario-rtd/Desktop/widget-front/src/components/app/views/invoiceConcepts/new/index.js"],"names":["React","Component","PropTypes","Link","classNames","validator","update","Button","SAT_CATEGORIES","CATEGORY_CATALOG_START","CATEGORY_ID_POSITION","CATEGORY_LEVEL_POSITION","CATEGORY_GROUPING_CODE_POSITION","CATEGORY_NAME_POSITION","CATEGORY_ANCESTRY_POSITION","CATEGORY_LABEL_ID","CATEGORY_LABEL_LEVEL","CATEGORY_LABEL_GROUPING_CODE","CATEGORY_LABEL_NAME","CATEGORY_LABEL_ANCESTRY","NewInvoiceConcept","props","data","title","isUpdate","location","pathname","requestInProgress","form","name","kind","category","isValid","categories","state","Object","assign","getCategories","i","length","push","setState","e","preventDefault","isValidFormName","isValidCategory","$set","target","value","categoryValue","Number","isLength","equals","String","mainLabel","map","index","id","ancestry","grouping_code","renderCategories","setFormCategory","bind","setFormKind","sendData","onChangeFormName","height","renderKind","propTypes","shape","string"],"mappings":";;;;;;;AAAA;AACA,OAAOA,KAAP,IAAgBC,SAAhB,QAAiC,OAAjC;AACA,OAAOC,SAAP,MAAsB,YAAtB;AACA,SAASC,IAAT,QAAqB,cAArB;AACA,OAAOC,UAAP,MAAuB,YAAvB;AACA,OAAOC,SAAP,MAAsB,WAAtB;AACA,OAAOC,MAAP,MAAmB,qBAAnB;AAEA,OAAOC,MAAP,MAAmB,eAAnB,C,CACA;;AACA,SAASC,cAAT,QAA+B,iBAA/B,C,CAEA;;AACA,IAAMC,sBAAsB,GAAG,CAA/B;AACA,IAAMC,oBAAoB,GAAG,CAA7B;AACA,IAAMC,uBAAuB,GAAG,CAAhC;AACA,IAAMC,+BAA+B,GAAG,CAAxC;AACA,IAAMC,sBAAsB,GAAG,CAA/B;AACA,IAAMC,0BAA0B,GAAG,CAAnC;AAEA,IAAMC,iBAAiB,GAAG,IAA1B;AACA,IAAMC,oBAAoB,GAAG,OAA7B;AACA,IAAMC,4BAA4B,GAAG,eAArC;AACA,IAAMC,mBAAmB,GAAG,MAA5B;AACA,IAAMC,uBAAuB,GAAG,UAAhC;;IAEMC,iB;;;;;AACJ,6BAAaC,KAAb,EAAoB;AAAA;;AAAA;;AAClB,2FAAMA,KAAN;AACA,UAAKC,IAAL,GAAY;AACVC,MAAAA,KAAK,EAAE,qBADG;AAEVC,MAAAA,QAAQ,EAAEH,KAAK,CAACI,QAAN,CAAeC,QAAf,KAA4B,qBAF5B;AAGVC,MAAAA,iBAAiB,EAAE,KAHT;AAIVC,MAAAA,IAAI,EAAE;AACJC,QAAAA,IAAI,EAAE,EADF;AAEJC,QAAAA,IAAI,EAAE,SAFF;AAGJC,QAAAA,QAAQ,EAAE,CAAC;AAHP,OAJI;AASVC,MAAAA,OAAO,EAAE;AACPH,QAAAA,IAAI,EAAE,IADC;AAEPE,QAAAA,QAAQ,EAAE;AAFH,OATC;AAaVE,MAAAA,UAAU,EAAE;AAbF,KAAZ;AAeA,UAAKC,KAAL,GAAaC,MAAM,CAACC,MAAP,CAAc,EAAd,EAAkB,MAAKd,IAAvB,CAAb;AAjBkB;AAkBnB;;;;wCAEoB;AACnB,WAAKe,aAAL;AACD;;;oCAEgB;AACf,UAAIJ,UAAU,GAAG,EAAjB;;AACA,WAAK,IAAIK,CAAC,GAAG7B,sBAAb,EAAqC6B,CAAC,GAAG9B,cAAc,CAAC+B,MAAxD,EAAgED,CAAC,EAAjE,EAAqE;AAAA;;AACnEL,QAAAA,UAAU,CAACO,IAAX,2DACGzB,iBADH,EACuBP,cAAc,CAAC8B,CAAD,CAAd,CAAkB5B,oBAAlB,CADvB,qCAEGM,oBAFH,EAE0BR,cAAc,CAAC8B,CAAD,CAAd,CAAkB3B,uBAAlB,CAF1B,qCAGGM,4BAHH,EAIIT,cAAc,CAAC8B,CAAD,CAAd,CAAkB1B,+BAAlB,CAJJ,qCAKGM,mBALH,EAKyBV,cAAc,CAAC8B,CAAD,CAAd,CAAkBzB,sBAAlB,CALzB,qCAMGM,uBANH,EAOIX,cAAc,CAAC8B,CAAD,CAAd,CAAkBxB,0BAAlB,KAAiD,EAPrD;AASD;;AACD,WAAK2B,QAAL,CAAc;AAAER,QAAAA,UAAU,EAAEA;AAAd,OAAd;AACD;;;6BAESS,C,EAAG;AACXA,MAAAA,CAAC,CAACC,cAAF;;AACA,UACE,KAAKC,eAAL,MACA,KAAKC,eAAL,EADA,IAEA,CAAC,KAAKX,KAAL,CAAWP,iBAHd,EAIE;AACA,aAAKc,QAAL,CACE;AACEd,UAAAA,iBAAiB,EAAE;AADrB,SADF,EAIE,YAAY;AACV,eAAKc,QAAL,CAAc;AAAEd,YAAAA,iBAAiB,EAAE;AAArB,WAAd;AACD,SANH;AAQD;AACF;;;qCAEiBe,C,EAAG;AACnB,WAAKD,QAAL,CAAc;AACZb,QAAAA,IAAI,EAAEtB,MAAM,CAAC,KAAK4B,KAAL,CAAWN,IAAZ,EAAkB;AAAEC,UAAAA,IAAI,EAAE;AAAEiB,YAAAA,IAAI,EAAEJ,CAAC,CAACK,MAAF,CAASC;AAAjB;AAAR,SAAlB;AADA,OAAd;AAGA,UAAI,CAAC,KAAKd,KAAL,CAAWF,OAAX,CAAmBH,IAAxB,EAA8B,KAAKe,eAAL;AAC/B;;;oCAEgBF,C,EAAG;AAClB,UAAIO,aAAa,GAAG,CAApB;;AACA,WACE,IAAIX,CAAC,GAAG7B,sBADV,EAEE6B,CAAC,GAAG,KAAKJ,KAAL,CAAWD,UAAX,CAAsBM,MAF5B,EAGED,CAAC,EAHH,EAIE;AACA,YACE,KAAKJ,KAAL,CAAWD,UAAX,CAAsBK,CAAtB,EAAyBvB,iBAAzB,MAAgDmC,MAAM,CAACR,CAAC,CAACK,MAAF,CAASC,KAAV,CADxD,EAEE;AACAC,UAAAA,aAAa,GAAGC,MAAM,CAACR,CAAC,CAACK,MAAF,CAASC,KAAV,CAAtB;AACD;AACF;;AACD,UAAIC,aAAa,KAAK,CAAtB,EAAyB;AACvB,aAAKR,QAAL,CAAc;AACZb,UAAAA,IAAI,EAAEtB,MAAM,CAAC,KAAK4B,KAAL,CAAWN,IAAZ,EAAkB;AAAEG,YAAAA,QAAQ,EAAE;AAAEe,cAAAA,IAAI,EAAEG;AAAR;AAAZ,WAAlB;AADA,SAAd;AAGD;AACF;;;gCAEYP,C,EAAG;AACdA,MAAAA,CAAC,CAACC,cAAF;AACA,WAAKF,QAAL,CAAc;AACZb,QAAAA,IAAI,EAAEtB,MAAM,CAAC,KAAK4B,KAAL,CAAWN,IAAZ,EAAkB;AAAEE,UAAAA,IAAI,EAAE;AAAEgB,YAAAA,IAAI,EAAEJ,CAAC,CAACK,MAAF,CAASC;AAAjB;AAAR,SAAlB;AADA,OAAd;AAGD;;;sCAEkB;AACjB,UAAIhB,OAAO,GAAG3B,SAAS,CAAC8C,QAAV,CAAmB,KAAKjB,KAAL,CAAWN,IAAX,CAAgBC,IAAnC,EAAyC,CAAzC,CAAd;AACA,WAAKY,QAAL,CAAc;AACZT,QAAAA,OAAO,EAAE1B,MAAM,CAAC,KAAK4B,KAAL,CAAWF,OAAZ,EAAqB;AAAEH,UAAAA,IAAI,EAAE;AAAEiB,YAAAA,IAAI,EAAEd;AAAR;AAAR,SAArB;AADH,OAAd;AAGA,aAAOA,OAAP;AACD;;;sCAEkB;AACjB,UAAIA,OAAO,GAAG,CAAC3B,SAAS,CAAC+C,MAAV,CAAiBC,MAAM,CAAC,KAAKnB,KAAL,CAAWN,IAAX,CAAgBG,QAAjB,CAAvB,EAAmD,IAAnD,CAAf;AACA,WAAKU,QAAL,CAAc;AACZT,QAAAA,OAAO,EAAE1B,MAAM,CAAC,KAAK4B,KAAL,CAAWF,OAAZ,EAAqB;AAAED,UAAAA,QAAQ,EAAE;AAAEe,YAAAA,IAAI,EAAEd;AAAR;AAAZ,SAArB;AADH,OAAd;AAGA,aAAOA,OAAP;AACD;;;uCAEmB;AAClB,UAAIC,UAAU,GAAG,IAAjB;AACA,UAAIqB,SAAS,GAAG,mBAAhB;;AACA,UAAI,KAAKpB,KAAL,CAAWD,UAAX,CAAsBM,MAAtB,GAA+B,CAAnC,EAAsC;AACpCe,QAAAA,SAAS,GAAG,kCAAZ;AACArB,QAAAA,UAAU,GAAG,KAAKC,KAAL,CAAWD,UAAX,CAAsBsB,GAAtB,CAA0B,UAAUxB,QAAV,EAAoByB,KAApB,EAA2B;AAChE,iBACE;AACE,YAAA,GAAG,EAAEzB,QAAQ,CAAC0B,EADhB;AAEE,YAAA,KAAK,EAAE1B,QAAQ,CAAC0B,EAFlB;AAGE,YAAA,QAAQ,EAAE1B,QAAQ,CAAC2B,QAAT,KAAsB,EAHlC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,aAKG3B,QAAQ,CAAC4B,aAAT,GAAyB,KAAzB,GAAiC5B,QAAQ,CAACF,IAL7C,CADF;AASD,SAVY,CAAb;AAWD;;AACD,UAAI+B,gBAAgB,GAClB;AAAO,QAAA,SAAS,EAAC,SAAjB;AAA2B,QAAA,OAAO,EAAC,UAAnC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kCAEE;AACE,QAAA,EAAE,EAAC,UADL;AAEE,QAAA,KAAK,EAAE,KAAK1B,KAAL,CAAWN,IAAX,CAAgBG,QAFzB;AAGE,QAAA,SAAS,EAAE3B,UAAU,CAAC,OAAD,EAAU;AAC7B,uBAAa,CAAC,KAAK8B,KAAL,CAAWF,OAAX,CAAmBD;AADJ,SAAV,CAHvB;AAME,QAAA,QAAQ,EAAE,KAAK8B,eAAL,CAAqBC,IAArB,CAA0B,IAA1B,CANZ;AAOE,QAAA,MAAM,EAAE,KAAKjB,eAAL,CAAqBiB,IAArB,CAA0B,IAA1B,CAPV;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SASE;AAAQ,QAAA,KAAK,EAAC,EAAd;AAAiB,QAAA,QAAQ,MAAzB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACGR,SADH,CATF,EAYGrB,UAZH,CAFF,CADF;AAmBA,aAAO2B,gBAAP;AACD;;;iCAEa;AACZ,aACE;AAAO,QAAA,SAAS,EAAC,SAAjB;AAA2B,QAAA,OAAO,EAAC,MAAnC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,4BAEE;AACE,QAAA,EAAE,EAAC,MADL;AAEE,QAAA,KAAK,EAAE,KAAK1B,KAAL,CAAWN,IAAX,CAAgBE,IAFzB;AAGE,QAAA,MAAM,EAAE,KAAKiC,WAAL,CAAiBD,IAAjB,CAAsB,IAAtB,CAHV;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAKE;AAAQ,QAAA,KAAK,EAAC,QAAd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBALF,EAME;AAAQ,QAAA,KAAK,EAAC,SAAd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBANF,CAFF,CADF;AAaD;;;6BAES;AACR,UAAIvC,KAAK,GAAG,KAAKW,KAAL,CAAWV,QAAX,GACR,YAAY,KAAKU,KAAL,CAAWX,KADf,GAER,KAAKW,KAAL,CAAWX,KAFf;AAIA,aACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE;AAAK,QAAA,SAAS,EAAC,SAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE;AAAK,QAAA,SAAS,EAAC,QAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE;AAAI,QAAA,SAAS,EAAC,YAAd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAA4BA,KAA5B,CADF,EAEE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAFF,EAGE;AAAM,QAAA,SAAS,EAAC,eAAhB;AAAgC,QAAA,QAAQ,EAAE,KAAKyC,QAAL,CAAcF,IAAd,CAAmB,IAAnB,CAA1C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE;AAAG,QAAA,SAAS,EAAC,SAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE;AAAO,QAAA,SAAS,EAAC,SAAjB;AAA2B,QAAA,OAAO,EAAC,MAAnC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBAEE;AACE,QAAA,EAAE,EAAC,MADL;AAEE,QAAA,SAAS,EAAE1D,UAAU,CAAC,OAAD,EAAU;AAC7B,uBAAa,CAAC,KAAK8B,KAAL,CAAWF,OAAX,CAAmBH;AADJ,SAAV,CAFvB;AAKE,QAAA,IAAI,EAAC,MALP;AAME,QAAA,WAAW,EAAC,QANd;AAOE,QAAA,KAAK,EAAE,KAAKK,KAAL,CAAWN,IAAX,CAAgBC,IAPzB;AAQE,QAAA,QAAQ,EAAE,KAAKoC,gBAAL,CAAsBH,IAAtB,CAA2B,IAA3B,CARZ;AASE,QAAA,MAAM,EAAE,KAAKlB,eAAL,CAAqBkB,IAArB,CAA0B,IAA1B,CATV;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAFF,CADF,EAeE;AACE,QAAA,SAAS,EAAE1D,UAAU,CAAC,MAAD,EAAS,WAAT,EAAsB;AACzC,uBAAa,KAAK8B,KAAL,CAAWF,OAAX,CAAmBH;AADS,SAAtB,CADvB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kCAfF,CADF,EAwBE;AAAK,QAAA,SAAS,EAAC,SAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE;AAAM,QAAA,SAAS,EAAC,qBAAhB;AAAsC,QAAA,KAAK,EAAE;AAAEqC,UAAAA,MAAM,EAAE;AAAV,SAA7C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACG,KAAKC,UAAL,EADH,CADF,CAxBF,EA6BE;AAAK,QAAA,SAAS,EAAC,SAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE;AAAM,QAAA,SAAS,EAAC,qBAAhB;AAAsC,QAAA,KAAK,EAAE;AAAED,UAAAA,MAAM,EAAE;AAAV,SAA7C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACG,KAAKN,gBAAL,EADH,CADF,EAIE;AACE,QAAA,SAAS,EAAExD,UAAU,CAAC,MAAD,EAAS,WAAT,EAAsB;AACzC,uBAAa,KAAK8B,KAAL,CAAWF,OAAX,CAAmBD;AADS,SAAtB,CADvB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,uCAJF,CA7BF,EAyCE;AAAK,QAAA,SAAS,EAAC,oBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE;AAAG,QAAA,SAAS,EAAC,SAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE,oBAAC,IAAD;AAAM,QAAA,EAAE,EAAC,eAAT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE,oBAAC,MAAD;AAAQ,QAAA,WAAW,EAAC,WAApB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBADF,CADF,CADF,EAME;AAAG,QAAA,SAAS,EAAC,SAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE,oBAAC,MAAD;AACE,QAAA,WAAW,EAAC,SADd;AAEE,QAAA,IAAI,EAAC,cAFP;AAGE,QAAA,OAAO,EAAE,KAAKG,KAAL,CAAWP,iBAHtB;AAIE,QAAA,QAAQ,EACN,CAAC,KAAKO,KAAL,CAAWF,OAAX,CAAmBH,IAApB,IAA4B,CAAC,KAAKK,KAAL,CAAWF,OAAX,CAAmBD,QALpD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBADF,CANF,CAzCF,CAHF,CADF,CADF,CADF;AAuED;;;;EAhP6B9B,S;;AAmPhCmB,iBAAiB,CAACgD,SAAlB,GAA8B;AAC5B3C,EAAAA,QAAQ,EAAEvB,SAAS,CAACmE,KAAV,CAAgB;AACxB3C,IAAAA,QAAQ,EAAExB,SAAS,CAACoE;AADI,GAAhB;AADkB,CAA9B;AAMA,eAAelD,iBAAf","sourcesContent":["// Libraries\nimport React, { Component } from 'react'\nimport PropTypes from 'prop-types'\nimport { Link } from 'react-router'\nimport classNames from 'classnames'\nimport validator from 'validator'\nimport update from 'immutability-helper'\n\nimport Button from 'shared/button'\n// Catalogs\nimport { SAT_CATEGORIES } from 'shared/catalogs'\n\n// Constants\nconst CATEGORY_CATALOG_START = 1\nconst CATEGORY_ID_POSITION = 0\nconst CATEGORY_LEVEL_POSITION = 1\nconst CATEGORY_GROUPING_CODE_POSITION = 2\nconst CATEGORY_NAME_POSITION = 3\nconst CATEGORY_ANCESTRY_POSITION = 4\n\nconst CATEGORY_LABEL_ID = 'id'\nconst CATEGORY_LABEL_LEVEL = 'level'\nconst CATEGORY_LABEL_GROUPING_CODE = 'grouping_code'\nconst CATEGORY_LABEL_NAME = 'name'\nconst CATEGORY_LABEL_ANCESTRY = 'ancestry'\n\nclass NewInvoiceConcept extends Component {\n  constructor (props) {\n    super(props)\n    this.data = {\n      title: 'New Invoice Concept',\n      isUpdate: props.location.pathname !== '/admin/rubros/nuevo',\n      requestInProgress: false,\n      form: {\n        name: '',\n        kind: 'expense',\n        category: -1\n      },\n      isValid: {\n        name: true,\n        category: true\n      },\n      categories: []\n    }\n    this.state = Object.assign({}, this.data)\n  }\n\n  componentDidMount () {\n    this.getCategories()\n  }\n\n  getCategories () {\n    let categories = []\n    for (let i = CATEGORY_CATALOG_START; i < SAT_CATEGORIES.length; i++) {\n      categories.push({\n        [CATEGORY_LABEL_ID]: SAT_CATEGORIES[i][CATEGORY_ID_POSITION],\n        [CATEGORY_LABEL_LEVEL]: SAT_CATEGORIES[i][CATEGORY_LEVEL_POSITION],\n        [CATEGORY_LABEL_GROUPING_CODE]:\n          SAT_CATEGORIES[i][CATEGORY_GROUPING_CODE_POSITION],\n        [CATEGORY_LABEL_NAME]: SAT_CATEGORIES[i][CATEGORY_NAME_POSITION],\n        [CATEGORY_LABEL_ANCESTRY]:\n          SAT_CATEGORIES[i][CATEGORY_ANCESTRY_POSITION] || ''\n      })\n    }\n    this.setState({ categories: categories })\n  }\n\n  sendData (e) {\n    e.preventDefault()\n    if (\n      this.isValidFormName() &&\n      this.isValidCategory() &&\n      !this.state.requestInProgress\n    ) {\n      this.setState(\n        {\n          requestInProgress: true\n        },\n        function () {\n          this.setState({ requestInProgress: false })\n        }\n      )\n    }\n  }\n\n  onChangeFormName (e) {\n    this.setState({\n      form: update(this.state.form, { name: { $set: e.target.value } })\n    })\n    if (!this.state.isValid.name) this.isValidFormName()\n  }\n\n  setFormCategory (e) {\n    let categoryValue = 0\n    for (\n      let i = CATEGORY_CATALOG_START;\n      i < this.state.categories.length;\n      i++\n    ) {\n      if (\n        this.state.categories[i][CATEGORY_LABEL_ID] === Number(e.target.value)\n      ) {\n        categoryValue = Number(e.target.value)\n      }\n    }\n    if (categoryValue !== 0) {\n      this.setState({\n        form: update(this.state.form, { category: { $set: categoryValue } })\n      })\n    }\n  }\n\n  setFormKind (e) {\n    e.preventDefault()\n    this.setState({\n      form: update(this.state.form, { kind: { $set: e.target.value } })\n    })\n  }\n\n  isValidFormName () {\n    let isValid = validator.isLength(this.state.form.name, 2)\n    this.setState({\n      isValid: update(this.state.isValid, { name: { $set: isValid } })\n    })\n    return isValid\n  }\n\n  isValidCategory () {\n    let isValid = !validator.equals(String(this.state.form.category), '-1')\n    this.setState({\n      isValid: update(this.state.isValid, { category: { $set: isValid } })\n    })\n    return isValid\n  }\n\n  renderCategories () {\n    let categories = null\n    let mainLabel = 'No hay categorías'\n    if (this.state.categories.length > 0) {\n      mainLabel = 'Selecciona una categoría del SAT'\n      categories = this.state.categories.map(function (category, index) {\n        return (\n          <option\n            key={category.id}\n            value={category.id}\n            disabled={category.ancestry === ''}\n          >\n            {category.grouping_code + ' - ' + category.name}\n          </option>\n        )\n      })\n    }\n    let renderCategories = (\n      <label className='caption' htmlFor='category'>\n        Categorías del SAT\n        <select\n          id='category'\n          value={this.state.form.category}\n          className={classNames('input', {\n            'is-danger': !this.state.isValid.category\n          })}\n          onChange={this.setFormCategory.bind(this)}\n          onBlur={this.isValidCategory.bind(this)}\n        >\n          <option value='' disabled>\n            {mainLabel}\n          </option>\n          {categories}\n        </select>\n      </label>\n    )\n    return renderCategories\n  }\n\n  renderKind () {\n    return (\n      <label className='caption' htmlFor='kind'>\n        Tipo de factura\n        <select\n          id='kind'\n          value={this.state.form.kind}\n          onBlur={this.setFormKind.bind(this)}\n        >\n          <option value='income'>Ingreso</option>\n          <option value='expense'>Egreso</option>\n        </select>\n      </label>\n    )\n  }\n\n  render () {\n    let title = this.state.isUpdate\n      ? 'Update ' + this.state.title\n      : this.state.title\n\n    return (\n      <div>\n        <div className='columns'>\n          <div className='column'>\n            <h2 className='title is-5'>{title}</h2>\n            <hr />\n            <form className='login-content' onSubmit={this.sendData.bind(this)}>\n              <p className='control'>\n                <label className='caption' htmlFor='name'>\n                  Nombre\n                  <input\n                    id='name'\n                    className={classNames('input', {\n                      'is-danger': !this.state.isValid.name\n                    })}\n                    type='text'\n                    placeholder='Nombre'\n                    value={this.state.form.name}\n                    onChange={this.onChangeFormName.bind(this)}\n                    onBlur={this.isValidFormName.bind(this)}\n                  />\n                </label>\n                <span\n                  className={classNames('help', 'is-danger', {\n                    'is-hidden': this.state.isValid.name\n                  })}\n                >\n                  Mínimo 2 caracteres\n                </span>\n              </p>\n              <div className='control'>\n                <span className='select is-fullwidth' style={{ height: '4em' }}>\n                  {this.renderKind()}\n                </span>\n              </div>\n              <div className='control'>\n                <span className='select is-fullwidth' style={{ height: '4em' }}>\n                  {this.renderCategories()}\n                </span>\n                <span\n                  className={classNames('help', 'is-danger', {\n                    'is-hidden': this.state.isValid.category\n                  })}\n                >\n                  Selecciona una categoría\n                </span>\n              </div>\n              <div className='control is-grouped'>\n                <p className='control'>\n                  <Link to='/admin/rubros'>\n                    <Button buttonStyle='dangerInv'>Cancelar</Button>\n                  </Link>\n                </p>\n                <p className='control'>\n                  <Button\n                    buttonStyle='primary'\n                    icon='content-save'\n                    loading={this.state.requestInProgress}\n                    disabled={\n                      !this.state.isValid.name || !this.state.isValid.category\n                    }\n                  >\n                    Guardar\n                  </Button>\n                </p>\n              </div>\n            </form>\n          </div>\n        </div>\n      </div>\n    )\n  }\n}\n\nNewInvoiceConcept.propTypes = {\n  location: PropTypes.shape({\n    pathname: PropTypes.string\n  })\n}\n\nexport default NewInvoiceConcept\n"]},"metadata":{},"sourceType":"module"}